!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();"undefined"!=typeof window&&((window.__svelte??={}).v??=new Set).add("5");let e=!1;e=!0;const t=Symbol(),n=!1;var r=Array.isArray,o=Array.prototype.indexOf,i=Array.from,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyDescriptors,c=Object.prototype,u=Array.prototype,d=Object.getPrototypeOf;function h(e){return"function"==typeof e}const p=()=>{};function f(e){return e()}function m(e){for(var t=0;t<e.length;t++)e[t]()}function g(){var e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}function y(e,t,n=!1){return void 0===e?n?t():t:e}function v(e,t){if(Array.isArray(e))return e;if(void 0===t||!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const k=16,b=32,w=64,x=1024,C=2048,_=4096,S=8192,E=16384,M=32768,A=65536,D=1<<17,T=1<<19,O=256,N=512,P=32768,z=1<<21,I=1<<23,L=Symbol("$state"),$=Symbol("legacy props"),R=Symbol(""),F=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function B(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function V(e){return e===this.v}function H(e,t){return e!=e?t==t:e!==t||null!==e&&"object"==typeof e||"function"==typeof e}function j(e){return!H(e,this.v)}const q=[];function K(e,t=!1,n=!1){return W(e,new Map,"",q,null,n)}function W(e,t,n,o,i=null,s=!1){if("object"==typeof e&&null!==e){var a=t.get(e);if(void 0!==a)return a;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(r(e)){var l=Array(e.length);t.set(e,l),null!==i&&t.set(i,l);for(var u=0;u<e.length;u+=1){var h=e[u];u in e&&(l[u]=W(h,t,n,o,null,s))}return l}if(d(e)===c){for(var p in l={},t.set(e,l),null!==i&&t.set(i,l),e)l[p]=W(e[p],t,n,o,null,s);return l}if(e instanceof Date)return structuredClone(e);if("function"==typeof e.toJSON&&!s)return W(e.toJSON(),t,n,o,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch(f){return e}}let Z=null;function U(e){Z=e}function J(e){return ee().get(e)}function G(e,t){return ee().set(e,t),t}function X(t,n=!1,r){Z={p:Z,i:!1,c:null,e:null,s:t,x:null,l:e&&!n?{s:null,u:null,$:[]}:null}}function Y(e){var t=Z,n=t.e;if(null!==n)for(var r of(t.e=null,n))et(r);return t.i=!0,Z=t.p,{}}function Q(){return!e||null!==Z&&null===Z.l}function ee(e){return null===Z&&B(),Z.c??=new Map(function(e){let t=e.p;for(;null!==t;){const e=t.c;if(null!==e)return e;t=t.p}return null}(Z)||void 0)}let te=[];function ne(e){if(0===te.length){var t=te;queueMicrotask(()=>{t===te&&function(){var e=te;te=[],m(e)}()})}te.push(e)}function re(e,t){for(;null!==t;){if(128&t.f)try{return void t.b.error(e)}catch(n){e=n}t=t.parent}throw e}const oe=new Set;let ie=null,se=null,ae=[],le=null,ce=!1;class ue{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#o=null;#i=[];#s=[];skipped_effects=new Set;is_fork=!1;process(e){ae=[],this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const n of e)this.#a(n,t);this.is_fork||this.#l(),this.#r>0||this.is_fork?(this.#c(t.effects),this.#c(t.render_effects),this.#c(t.block_effects)):(ie=null,pe(t.render_effects),pe(t.effects),this.#o?.resolve()),se=null}#a(e,t){e.f^=x;for(var n=e.first;null!==n;){var r=n.f,o=!!(96&r),i=o&&0!==(r&x)||0!==(r&S)||this.skipped_effects.has(n);if(128&n.f&&n.b?.is_pending()&&(t={parent:t,effect:n,effects:[],render_effects:[],block_effects:[]}),!i&&null!==n.fn){o?n.f^=x:4&r?t.effects.push(n):Ft(n)&&(0!==(n.f&k)&&t.block_effects.push(n),qt(n));var s=n.first;if(null!==s){n=s;continue}}var a=n.parent;for(n=n.next;null===n&&null!==a;)a===t.effect&&(this.#c(t.effects),this.#c(t.render_effects),this.#c(t.block_effects),t=t.parent),n=a.next,a=a.parent}}#c(e){for(const t of e){(0!==(t.f&C)?this.#i:this.#s).push(t),Jt(t,x)}}capture(e,t){this.previous.has(e)||this.previous.set(e,t),this.current.set(e,e.v),se?.set(e,e.v)}activate(){ie=this}deactivate(){ie=null,se=null}flush(){if(this.activate(),ae.length>0){if(function(){var e=kt;ce=!0;try{var t=0;for(bt(!0);ae.length>0;){var r=ue.ensure();if(t++>1e3)n,de();r.process(ae),Ae.clear()}}finally{ce=!1,bt(e),le=null}}(),null!==ie&&ie!==this)return}else 0===this.#n&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#l(){if(0===this.#r){for(const e of this.#e)e();this.#e.clear()}0===this.#n&&this.#u()}#u(){if(oe.size>1){this.previous.clear();var e=se,t=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const e of oe){if(e===this){t=!1;continue}const r=[];for(const[n,i]of this.current){if(e.current.has(n)){if(!t||i===e.current.get(n))continue;e.current.set(n,i)}r.push(n)}if(0===r.length)continue;const o=[...e.current.keys()].filter(e=>!this.current.has(e));if(o.length>0){const t=new Set,i=new Map;for(const e of r)fe(e,o,t,i);if(ae.length>0){ie=e,e.apply();for(const t of ae)e.#a(t,n);ae=[],e.deactivate()}}}ie=null,se=e}this.committed=!0,oe.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#i)Jt(e,C),ge(e);for(const e of this.#s)Jt(e,_),ge(e);this.#i=[],this.#s=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#o??=g()).promise}static ensure(){if(null===ie){const e=ie=new ue;oe.add(ie),ue.enqueue(()=>{ie===e&&e.flush()})}return ie}static enqueue(e){ne(e)}apply(){}}function de(){try{!function(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(e){re(e,le)}}let he=null;function pe(e){var t=e.length;if(0!==t){for(var n=0;n<t;){var r=e[n++];if(!(24576&r.f)&&Ft(r)&&(he=new Set,qt(r),null===r.deps&&null===r.first&&null===r.nodes_start&&(null===r.teardown&&null===r.ac?ht(r):r.fn=null),he?.size>0)){Ae.clear();for(const e of he){if(24576&e.f)continue;const t=[e];let n=e.parent;for(;null!==n;)he.has(n)&&(he.delete(n),t.push(n)),n=n.parent;for(let e=t.length-1;e>=0;e--){const n=t[e];24576&n.f||qt(n)}}he.clear()}}he=null}}function fe(e,t,n,r){if(!n.has(e)&&(n.add(e),null!==e.reactions))for(const o of e.reactions){const e=o.f;2&e?fe(o,t,n,r):4194320&e&&0===(e&C)&&me(o,t,r)&&(Jt(o,C),ge(o))}}function me(e,t,n){const r=n.get(e);if(void 0!==r)return r;if(null!==e.deps)for(const o of e.deps){if(t.includes(o))return!0;if(2&o.f&&me(o,t,n))return n.set(o,!0),!0}return n.set(e,!1),!1}function ge(e){for(var t=le=e;null!==t.parent;){var n=(t=t.parent).f;if(ce&&t===Et&&0!==(n&k))return;if(96&n){if(0===(n&x))return;t.f^=x}}ae.push(t)}function ye(e){let t,n=0,r=Te(0);return()=>{null===Ct||_t||(Kt(r),ot(()=>(0===n&&(t=Zt(()=>e(()=>Ie(r)))),n+=1,()=>{ne(()=>{n-=1,0===n&&(t?.(),t=void 0,Ie(r))})})))}}function ve(e,t,n,r){const o=Q()?be:Ce;if(0!==n.length||0!==e.length){var i,s,a,l,c=ie,u=Et,d=(i=Et,s=Ct,a=Z,l=ie,function(e=!0){Mt(i),St(s),U(a),e&&l?.activate()});e.length>0?Promise.all(e).then(()=>{d();try{return h()}finally{c?.deactivate(),ke()}}):h()}else r(t.map(o));function h(){Promise.all(n.map(e=>we(e))).then(e=>{d();try{r([...t.map(o),...e])}catch(n){0===(u.f&E)&&re(n,u)}c?.deactivate(),ke()}).catch(e=>{re(e,u)})}}function ke(){Mt(null),St(null),U(null)}function be(e){var n=2050,r=null!==Ct&&2&Ct.f?Ct:null;null===Et||null!==r&&0!==(r.f&O)?n|=O:Et.f|=T;return{ctx:Z,deps:null,effects:null,equals:V,f:n,fn:e,reactions:null,rv:0,v:t,wv:0,parent:r??Et,ac:null}}function we(e,n){let r=Et;null===r&&function(){throw new Error("https://svelte.dev/e/async_derived_orphan")}();var o=r.b,i=void 0,s=Te(t),a=!Ct,l=new Map;return function(e){Xe(4718592,e,!0)}(()=>{var t=g();i=t.promise;try{Promise.resolve(e()).then(t.resolve,t.reject).then(()=>{n===ie&&n.committed&&n.deactivate(),ke()})}catch(u){t.reject(u),ke()}var n=ie;if(a){var r=!o.is_pending();o.update_pending_count(1),n.increment(r),l.get(n)?.reject(F),l.delete(n),l.set(n,t)}const c=(e,t=void 0)=>{if(n.activate(),t)t!==F&&(s.f|=I,ze(s,t));else{0!==(s.f&I)&&(s.f^=I),ze(s,e);for(const[e,t]of l){if(l.delete(e),e===n)break;t.reject(F)}}a&&(o.update_pending_count(-1),n.decrement(r))};t.promise.then(c,e=>c(null,e||"unknown"))}),Ye(()=>{for(const e of l.values())e.reject(F)}),new Promise(e=>{!function t(n){function r(){n===i?e(s):t(i)}n.then(r,r)}(i)})}function xe(e){const t=be(e);return Dt(t),t}function Ce(e){const t=be(e);return t.equals=j,t}function _e(e){var t=e.effects;if(null!==t){e.effects=null;for(var n=0;n<t.length;n+=1)ut(t[n])}}function Se(e){var t,n=Et;Mt(function(e){for(var t=e.parent;null!==t;){if(!(2&t.f))return t;t=t.parent}return null}(e));try{e.f&=-32769,_e(e),t=Vt(e)}finally{Mt(n)}return t}function Ee(e){var t=Se(e);(e.equals(t)||(e.v=t,e.wv=Rt()),wt)||(null!==se?se.set(e,e.v):Jt(e,!$t&&0===(e.f&O)||null===e.deps?x:_))}let Me=new Set;const Ae=new Map;let De=!1;function Te(e,t){return{f:0,v:e,reactions:null,equals:V,rv:0,wv:0}}function Oe(e,t){const n=Te(e);return Dt(n),n}function Ne(t,n=!1,r=!0){const o=Te(t);return n||(o.equals=j),e&&r&&null!==Z&&null!==Z.l&&(Z.l.s??=[]).push(o),o}function Pe(e,t,n=!1){return null!==Ct&&(!_t||0!==(Ct.f&D))&&Q()&&4325394&Ct.f&&!At?.includes(e)&&function(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}(),ze(e,n?$e(t):t)}function ze(e,t){if(!e.equals(t)){var n=e.v;wt?Ae.set(e,t):Ae.set(e,n),e.v=t;var r=ue.ensure();r.capture(e,n),2&e.f&&(0!==(e.f&C)&&Se(e),Jt(e,0===(e.f&O)?x:_)),e.wv=Rt(),Le(e,C),!Q()||null===Et||0===(Et.f&x)||96&Et.f||(null===Nt?function(e){Nt=e}([e]):Nt.push(e)),!r.is_fork&&Me.size>0&&!De&&function(){De=!1;const e=Array.from(Me);for(const t of e)0!==(t.f&x)&&Jt(t,_),Ft(t)&&qt(t);Me.clear()}()}return t}function Ie(e){Pe(e,e.v+1)}function Le(e,t){var n=e.reactions;if(null!==n)for(var r=Q(),o=n.length,i=0;i<o;i++){var s=n[i],a=s.f;if(r||s!==Et){var l=0===(a&C);l&&Jt(s,t),2&a?0===(a&P)&&(s.f|=P,Le(s,_)):l&&(0!==(a&k)&&null!==he&&he.add(s),ge(s))}}}function $e(e){if("object"!=typeof e||null===e||L in e)return e;const n=d(e);if(n!==c&&n!==u)return e;var o=new Map,i=r(e),s=Oe(0),l=It,h=e=>{if(It===l)return e();var t=Ct,n=It;St(null),Lt(l);var r=e();return St(t),Lt(n),r};return i&&o.set("length",Oe(e.length)),new Proxy(e,{defineProperty(e,t,n){"value"in n&&!1!==n.configurable&&!1!==n.enumerable&&!1!==n.writable||function(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var r=o.get(t);return void 0===r?r=h(()=>{var e=Oe(n.value);return o.set(t,e),e}):Pe(r,n.value,!0),!0},deleteProperty(e,n){var r=o.get(n);if(void 0===r){if(n in e){const e=h(()=>Oe(t));o.set(n,e),Ie(s)}}else Pe(r,t),Ie(s);return!0},get(n,r,i){if(r===L)return e;var s=o.get(r),l=r in n;if(void 0!==s||l&&!a(n,r)?.writable||(s=h(()=>Oe($e(l?n[r]:t))),o.set(r,s)),void 0!==s){var c=Kt(s);return c===t?void 0:c}return Reflect.get(n,r,i)},getOwnPropertyDescriptor(e,n){var r=Reflect.getOwnPropertyDescriptor(e,n);if(r&&"value"in r){var i=o.get(n);i&&(r.value=Kt(i))}else if(void 0===r){var s=o.get(n),a=s?.v;if(void 0!==s&&a!==t)return{enumerable:!0,configurable:!0,value:a,writable:!0}}return r},has(e,n){if(n===L)return!0;var r=o.get(n),i=void 0!==r&&r.v!==t||Reflect.has(e,n);if((void 0!==r||null!==Et&&(!i||a(e,n)?.writable))&&(void 0===r&&(r=h(()=>Oe(i?$e(e[n]):t)),o.set(n,r)),Kt(r)===t))return!1;return i},set(e,n,r,l){var c=o.get(n),u=n in e;if(i&&"length"===n)for(var d=r;d<c.v;d+=1){var p=o.get(d+"");void 0!==p?Pe(p,t):d in e&&(p=h(()=>Oe(t)),o.set(d+"",p))}void 0===c?u&&!a(e,n)?.writable||(Pe(c=h(()=>Oe(void 0)),$e(r)),o.set(n,c)):(u=c.v!==t,Pe(c,h(()=>$e(r))));var f=Reflect.getOwnPropertyDescriptor(e,n);if(f?.set&&f.set.call(l,r),!u){if(i&&"string"==typeof n){var m=o.get("length"),g=Number(n);Number.isInteger(g)&&g>=m.v&&Pe(m,g+1)}Ie(s)}return!0},ownKeys(e){Kt(s);var n=Reflect.ownKeys(e).filter(e=>{var n=o.get(e);return void 0===n||n.v!==t});for(var[r,i]of o)i.v===t||r in e||n.push(r);return n},setPrototypeOf(){!function(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}})}function Re(e){try{if(null!==e&&"object"==typeof e&&L in e)return e[L]}catch{}return e}function Fe(e,t){return Object.is(Re(e),Re(t))}var Be,Ve;function He(e=""){return document.createTextNode(e)}function je(e){return undefined.call(e)}function qe(e){return Ve.call(e)}function Ke(e,t){return je(e)}function We(e,t=!1){var n=je(e);return n instanceof Comment&&""===n.data?qe(n):n}function Ze(e,t=1,n=!1){let r=e;for(;t--;)r=qe(r);return r}function Ue(e,t){if(t){const t=document.body;e.autofocus=!0,ne(()=>{document.activeElement===t&&e.focus()})}}function Je(e){var t=Ct,n=Et;St(null),Mt(null);try{return e()}finally{St(t),Mt(n)}}function Ge(e){null===Et&&null===Ct&&function(){throw new Error("https://svelte.dev/e/effect_orphan")}(),null!==Ct&&0!==(Ct.f&O)&&null===Et&&function(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}(),wt&&function(){throw new Error("https://svelte.dev/e/effect_in_teardown")}()}function Xe(e,t,n,r=!0){var o=Et;null!==o&&0!==(o.f&S)&&(e|=S);var i={ctx:Z,deps:null,nodes_start:null,nodes_end:null,f:e|C,first:null,fn:t,last:null,next:null,parent:o,b:o&&o.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{qt(i),i.f|=M}catch(l){throw ut(i),l}else null!==t&&ge(i);if(r){var s=i;if(n&&null===s.deps&&null===s.teardown&&null===s.nodes_start&&s.first===s.last&&0===(s.f&T)&&(s=s.first,0!==(e&k)&&0!==(e&A)&&null!==s&&(s.f|=A)),null!==s&&(s.parent=o,null!==o&&function(e,t){var n=t.last;null===n?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}(s,o),null!==Ct&&2&Ct.f&&0===(e&w))){var a=Ct;(a.effects??=[]).push(s)}}return i}function Ye(e){const t=Xe(8,null,!1);return Jt(t,x),t.teardown=e,t}function Qe(e){Ge();var t=Et.f;if(!(!Ct&&0!==(t&b)&&0===(t&M)))return et(e);var n=Z;(n.e??=[]).push(e)}function et(e){return Xe(1048580,e,!1)}function tt(e){return Ge(),Xe(1048584,e,!0)}function nt(e){ue.ensure();const t=Xe(524352,e,!0);return()=>{ut(t)}}function rt(e){return Xe(4,e,!1)}function ot(e,t=0){return Xe(8|t,e,!0)}function it(e,t=[],n=[],r=[]){ve(r,t,n,t=>{Xe(8,()=>e(...t.map(Kt)),!0)})}function st(e,t=0){return Xe(k|t,e,!0)}function at(e,t=!0){return Xe(524320,e,!0,t)}function lt(e){var t=e.teardown;if(null!==t){const e=wt,n=Ct;xt(!0),St(null);try{t.call(null)}finally{xt(e),St(n)}}}function ct(e,t=!1){var n=e.first;for(e.first=e.last=null;null!==n;){const e=n.ac;null!==e&&Je(()=>{e.abort(F)});var r=n.next;0!==(n.f&w)?n.parent=null:ut(n,t),n=r}}function ut(e,t=!0){var n=!1;(t||262144&e.f)&&null!==e.nodes_start&&null!==e.nodes_end&&(dt(e.nodes_start,e.nodes_end),n=!0),ct(e,t&&!n),jt(e,0),Jt(e,E);var r=e.transitions;if(null!==r)for(const i of r)i.stop();lt(e);var o=e.parent;null!==o&&null!==o.first&&ht(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function dt(e,t){for(;null!==e;){var n=e===t?null:qe(e);e.remove(),e=n}}function ht(e){var t=e.parent,n=e.prev,r=e.next;null!==n&&(n.next=r),null!==r&&(r.prev=n),null!==t&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function pt(e,t,n=!0){var r=[];mt(e,r,!0),ft(r,()=>{n&&ut(e),t&&t()})}function ft(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var o of e)o.out(r)}else t()}function mt(e,t,n){if(0===(e.f&S)){if(e.f^=S,null!==e.transitions)for(const r of e.transitions)(r.is_global||n)&&t.push(r);for(var r=e.first;null!==r;){var o=r.next;mt(r,t,!!(0!==(r.f&A)||0!==(r.f&b)&&0!==(e.f&k))&&n),r=o}}}function gt(e){yt(e,!0)}function yt(e,t){if(0!==(e.f&S)){e.f^=S,0===(e.f&x)&&(Jt(e,C),ge(e));for(var n=e.first;null!==n;){var r=n.next;yt(n,!!(0!==(n.f&A)||0!==(n.f&b))&&t),n=r}if(null!==e.transitions)for(const n of e.transitions)(n.is_global||t)&&n.in()}}function vt(e,t){for(var n=e.nodes_start,r=e.nodes_end;null!==n;){var o=n===r?null:qe(n);t.append(n),n=o}}let kt=!1;function bt(e){kt=e}let wt=!1;function xt(e){wt=e}let Ct=null,_t=!1;function St(e){Ct=e}let Et=null;function Mt(e){Et=e}let At=null;function Dt(e){null!==Ct&&(null===At?At=[e]:At.push(e))}let Tt=null,Ot=0,Nt=null;let Pt=1,zt=0,It=zt;function Lt(e){It=e}let $t=!1;function Rt(){return++Pt}function Ft(e){var t=e.f;if(0!==(t&C))return!0;if(0!==(t&_)){var n=e.deps,r=0!==(t&O);if(2&t&&(e.f&=-32769),null!==n){var o,i,s=0!==(t&N),a=r&&null!==Et&&!$t,l=n.length;if((s||a)&&(null===Et||0===(Et.f&E))){var c=e,u=c.parent;for(o=0;o<l;o++)i=n[o],!s&&i?.reactions?.includes(c)||(i.reactions??=[]).push(c);s&&(c.f^=N),a&&null!==u&&0===(u.f&O)&&(c.f^=O)}for(o=0;o<l;o++)if(Ft(i=n[o])&&Ee(i),i.wv>e.wv)return!0}r&&(null===Et||$t)||Jt(e,x)}return!1}function Bt(e,t,n=!0){var r=e.reactions;if(null!==r&&!At?.includes(e))for(var o=0;o<r.length;o++){var i=r[o];2&i.f?Bt(i,t,!1):t===i&&(n?Jt(i,C):0!==(i.f&x)&&Jt(i,_),ge(i))}}function Vt(e){var t=Tt,n=Ot,r=Nt,o=Ct,i=$t,s=At,a=Z,l=_t,c=It,u=e.f;Tt=null,Ot=0,Nt=null,$t=0!==(u&O)&&(_t||!kt||null===Ct),Ct=96&u?null:e,At=null,U(e.ctx),_t=!1,It=++zt,null!==e.ac&&(Je(()=>{e.ac.abort(F)}),e.ac=null);try{e.f|=z;var d=(0,e.fn)(),h=e.deps;if(null!==Tt){var p;if(jt(e,Ot),null!==h&&Ot>0)for(h.length=Ot+Tt.length,p=0;p<Tt.length;p++)h[Ot+p]=Tt[p];else e.deps=h=Tt;if(!$t||2&u&&null!==e.reactions)for(p=Ot;p<h.length;p++)(h[p].reactions??=[]).push(e)}else null!==h&&Ot<h.length&&(jt(e,Ot),h.length=Ot);if(Q()&&null!==Nt&&!_t&&null!==h&&!(6146&e.f))for(p=0;p<Nt.length;p++)Bt(Nt[p],e);return null!==o&&o!==e&&(zt++,null!==Nt&&(null===r?r=Nt:r.push(...Nt))),0!==(e.f&I)&&(e.f^=I),d}catch(f){return function(e){var t=Et;if(null===t)return Ct.f|=I,e;if(0===(t.f&M)){if(!(128&t.f))throw e;t.b.error(e)}else re(e,t)}(f)}finally{e.f^=z,Tt=t,Ot=n,Nt=r,Ct=o,$t=i,At=s,U(a),_t=l,It=c}}function Ht(e,t){let n=t.reactions;if(null!==n){var r=o.call(n,e);if(-1!==r){var i=n.length-1;0===i?n=t.reactions=null:(n[r]=n[i],n.pop())}}null===n&&2&t.f&&(null===Tt||!Tt.includes(t))&&(Jt(t,_),768&t.f||(t.f^=N),_e(t),jt(t,0))}function jt(e,t){var n=e.deps;if(null!==n)for(var r=t;r<n.length;r++)Ht(e,n[r])}function qt(e){var t=e.f;if(0===(t&E)){Jt(e,x);var n=Et,r=kt;Et=e,kt=!0;try{0!==(t&k)?function(e){for(var t=e.first;null!==t;){var n=t.next;0===(t.f&b)&&ut(t),t=n}}(e):ct(e),lt(e);var o=Vt(e);e.teardown="function"==typeof o?o:null,e.wv=Pt}finally{kt=r,Et=n}}}function Kt(e){var t=!!(2&e.f);if(null===Ct||_t){if(t&&null===e.deps&&null===e.effects){var n=e,r=n.parent;null!==r&&0===(r.f&O)&&(n.f^=O)}}else if(!(null!==Et&&0!==(Et.f&E))&&!At?.includes(e)){var o=Ct.deps;if(0!==(Ct.f&z))e.rv<zt&&(e.rv=zt,null===Tt&&null!==o&&o[Ot]===e?Ot++:null===Tt?Tt=[e]:$t&&Tt.includes(e)||Tt.push(e));else{(Ct.deps??=[]).push(e);var i=e.reactions;null===i?e.reactions=[Ct]:i.includes(Ct)||i.push(Ct)}}if(wt){if(Ae.has(e))return Ae.get(e);if(t){var s=(n=e).v;return(0===(n.f&x)&&null!==n.reactions||Wt(n))&&(s=Se(n)),Ae.set(n,s),s}}else if(t){if(n=e,se?.has(n))return se.get(n);Ft(n)&&Ee(n)}if(se?.has(e))return se.get(e);if(0!==(e.f&I))throw e.v;return e.v}function Wt(e){if(e.v===t)return!0;if(null===e.deps)return!1;for(const t of e.deps){if(Ae.has(t))return!0;if(2&t.f&&Wt(t))return!0}return!1}function Zt(e){var t=_t;try{return _t=!0,e()}finally{_t=t}}const Ut=-7169;function Jt(e,t){e.f=e.f&Ut|t}function Gt(e){if("object"==typeof e&&e&&!(e instanceof EventTarget))if(L in e)Xt(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];"object"==typeof n&&n&&L in n&&Xt(n)}}function Xt(e,t=new Set){if(!("object"!=typeof e||null===e||e instanceof EventTarget||t.has(e))){t.add(e),e instanceof Date&&e.getTime();for(let o in e)try{Xt(e[o],t)}catch(n){}const r=d(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const t=l(r);for(let r in t){const o=t[r].get;if(o)try{o.call(e)}catch(n){}}}}}const Yt=new Set,Qt=new Set;function en(e,t,n,r={}){function o(e){if(r.capture||sn.call(t,e),!e.cancelBubble)return Je(()=>n?.call(this,e))}return e.startsWith("pointer")||e.startsWith("touch")||"wheel"===e?ne(()=>{t.addEventListener(e,o,r)}):t.addEventListener(e,o,r),o}function tn(e,t,n,r={}){var o=en(t,e,n,r);return()=>{e.removeEventListener(t,o,r)}}function nn(e,t,n,r,o){var i={capture:r,passive:o},s=en(e,t,n,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Ye(()=>{t.removeEventListener(e,s,i)})}function rn(e){for(var t=0;t<e.length;t++)Yt.add(e[t]);for(var n of Qt)n(e)}let on=null;function sn(e){var t=this,n=t.ownerDocument,r=e.type,o=e.composedPath?.()||[],i=o[0]||e.target;on=e;var a=0,l=on===e&&e.__root;if(l){var c=o.indexOf(l);if(-1!==c&&(t===document||t===window))return void(e.__root=t);var u=o.indexOf(t);if(-1===u)return;c<=u&&(a=c)}if((i=o[a]||e.target)!==t){s(e,"currentTarget",{configurable:!0,get:()=>i||n});var d=Ct,h=Et;St(null),Mt(null);try{for(var p,f=[];null!==i;){var m=i.assignedSlot||i.parentNode||i.host||null;try{var g=i["__"+r];null==g||i.disabled&&e.target!==i||g.call(i,e)}catch(y){p?f.push(y):p=y}if(e.cancelBubble||m===t||null===m)break;i=m}if(p){for(let e of f)queueMicrotask(()=>{throw e});throw p}}finally{e.__root=t,delete e.currentTarget,St(d),Mt(h)}}}function an(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","\x3c!----\x3e"),t.content}function ln(e,t){var n=Et;null===n.nodes_start&&(n.nodes_start=e,n.nodes_end=t)}function cn(e,t){var n,r=!!(1&t),o=!!(2&t),i=!e.startsWith("<!>");return()=>{void 0===n&&(n=an(i?e:"<!>"+e),r||(n=je(n)));var t=o?document.importNode(n,!0):n.cloneNode(!0);r?ln(je(t),t.lastChild):ln(t,t);return t}}function un(e,t,n="svg"){var r,o=!e.startsWith("<!>"),i=!!(1&t),s=`<${n}>${o?e:"<!>"+e}</${n}>`;return()=>{if(!r){var e=je(an(s));if(i)for(r=document.createDocumentFragment();je(e);)r.appendChild(je(e));else r=je(e)}var t=r.cloneNode(!0);i?ln(je(t),t.lastChild):ln(t,t);return t}}function dn(e,t){return un(e,t,"svg")}function hn(){var e=document.createDocumentFragment(),t=document.createComment(""),n=He();return e.append(t,n),ln(t,n),e}function pn(e,t){null!==e&&e.before(t)}function fn(e){return e.endsWith("capture")&&"gotpointercapture"!==e&&"lostpointercapture"!==e}const mn=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function gn(e){return mn.includes(e)}const yn={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function vn(e){return e=e.toLowerCase(),yn[e]??e}function kn(e,t){var n=null==t?"":"object"==typeof t?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}class bn{anchor;#d=new Map;#h=new Map;#p=new Map;#f=!0;constructor(e,t=!0){this.anchor=e,this.#f=t}#u=()=>{var e=ie;if(this.#d.has(e)){var t=this.#d.get(e),n=this.#h.get(t);if(n)gt(n);else{var r=this.#p.get(t);r&&(this.#h.set(t,r.effect),this.#p.delete(t),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),n=r.effect)}for(const[t,n]of this.#d){if(this.#d.delete(t),t===e)break;const r=this.#p.get(n);r&&(ut(r.effect),this.#p.delete(n))}for(const[e,r]of this.#h){if(e===t)continue;const o=()=>{if(Array.from(this.#d.values()).includes(e)){var t=document.createDocumentFragment();vt(r,t),t.append(He()),this.#p.set(e,{effect:r,fragment:t})}else ut(r);this.#h.delete(e)};this.#f||!n?pt(r,o,!1):o()}}};#m=e=>{this.#d.delete(e);const t=Array.from(this.#d.values());for(const[n,r]of this.#p)t.includes(n)||(ut(r.effect),this.#p.delete(n))};ensure(e,t){var n=ie;!t||this.#h.has(e)||this.#p.has(e)||this.#h.set(e,at(()=>t(this.anchor)));this.#d.set(n,e),this.#u()}}function wn(e,t,...n){var r=new bn(e);st(()=>{const e=t()??null;r.ensure(e,e&&(t=>e(t,...n)))},A)}function xn(t){var n,r;null===Z&&B(),e&&null!==Z.l?(n=Z,r=n.l,r.u??={a:[],b:[],m:[]}).m.push(t):Qe(()=>{const e=Zt(t);if("function"==typeof e)return e})}function Cn(e){null===Z&&B(),xn(()=>()=>Zt(e))}function _n(e,t,n=!1){var r=new bn(e);function o(e,t){r.ensure(e,t)}st(()=>{var e=!1;t((t,n=!0)=>{e=!0,o(n,t)}),e||o(!1,null)},n?A:0)}function Sn(e,t,n,o,s,a=null){var l=e,c={flags:t,items:new Map,first:null};!(4&t)||(l=e.appendChild(He()));var u,d,h=null,p=!1,f=new Map,m=Ce(()=>{var e=n();return r(e)?e:null==e?[]:i(e)});function g(){!function(e,t,n,r,o,s,a,l,c){var u,d,h,p,f,m,g=!!(8&a),y=!!(3&a),v=t.length,k=n.items,b=n.first,w=b,x=null,C=[],_=[];if(g)for(m=0;m<v;m+=1)p=l(h=t[m],m),void 0!==(f=k.get(p))&&(f.a?.measure(),(d??=new Set).add(f));for(m=0;m<v;m+=1)if(p=l(h=t[m],m),void 0!==(f=k.get(p))){if(y&&En(f,h,m,a),0!==(f.e.f&S)&&(gt(f.e),g&&(f.a?.unfix(),(d??=new Set).delete(f))),f!==w){if(void 0!==u&&u.has(f)){if(C.length<_.length){var E,M=_[0];x=M.prev;var A=C[0],D=C[C.length-1];for(E=0;E<C.length;E+=1)An(C[E],M,o);for(E=0;E<_.length;E+=1)u.delete(_[E]);Dn(n,A.prev,D.next),Dn(n,x,A),Dn(n,D,M),w=M,x=D,m-=1,C=[],_=[]}else u.delete(f),An(f,w,o),Dn(n,f.prev,f.next),Dn(n,f,null===x?n.first:x.next),Dn(n,x,f),x=f;continue}for(C=[],_=[];null!==w&&w.k!==p;)0===(w.e.f&S)&&(u??=new Set).add(w),_.push(w),w=w.next;if(null===w)continue;f=w}C.push(f),x=f,w=f.next}else{var T=r.get(p);if(void 0!==T){r.delete(p),k.set(p,T);var O=x?x.next:w;Dn(n,x,T),Dn(n,T,O),An(T,O,o),x=T}else{x=Mn(w?w.e.nodes_start:o,n,x,null===x?n.first:x.next,h,p,m,s,a,c)}k.set(p,x),C=[],_=[],w=x.next}if(null!==w||void 0!==u){for(var N=void 0===u?[]:i(u);null!==w;)0===(w.e.f&S)&&N.push(w),w=w.next;var P=N.length;if(P>0){var z=4&a&&0===v?o:null;if(g){for(m=0;m<P;m+=1)N[m].a?.measure();for(m=0;m<P;m+=1)N[m].a?.fix()}!function(e,t,n){for(var r=e.items,o=[],i=t.length,s=0;s<i;s++)mt(t[s].e,o,!0);var a=i>0&&0===o.length&&null!==n;if(a){var l=n.parentNode;l.textContent="",l.append(n),r.clear(),Dn(e,t[0].prev,t[i-1].next)}ft(o,()=>{for(var n=0;n<i;n++){var o=t[n];a||(r.delete(o.k),Dn(e,o.prev,o.next)),ut(o.e,!a)}})}(n,N,z)}}g&&ne(()=>{if(void 0!==d)for(f of d)f.a?.apply()});for(var I of(e.first=n.first&&n.first.e,e.last=x&&x.e,r.values()))ut(I.e);r.clear()}(d,u,c,f,l,s,t,o,n),null!==a&&(0===u.length?h?gt(h):h=at(()=>a(l)):null!==h&&pt(h,()=>{h=null}))}st(()=>{d??=Et;var e=(u=Kt(m)).length;p&&0===e||(p=0===e,g(),Kt(m))})}function En(e,t,n,r){1&r&&ze(e.v,t),2&r?ze(e.i,n):e.i=n}function Mn(e,t,n,r,o,i,s,a,l,c,u){var d=!!(1&l)?!(16&l)?Ne(o,!1,!1):Te(o):o,h=2&l?Te(s):s,p={i:h,v:d,k:i,a:null,e:null,prev:n,next:r};try{if(null===e)document.createDocumentFragment().append(e=He());return p.e=at(()=>a(e,d,h,c),false),p.e.prev=n&&n.e,p.e.next=r&&r.e,null===n?u||(t.first=p):(n.next=p,n.e.next=p.e),null!==r&&(r.prev=p,r.e.prev=p.e),p}finally{}}function An(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,o=t?t.e.nodes_start:n,i=e.e.nodes_start;null!==i&&i!==r;){var s=qe(i);o.before(i),i=s}}function Dn(e,t,n){null===t?e.first=n:(t.next=n,t.e.next=n&&n.e),null!==n&&(n.prev=t,n.e.prev=t&&t.e)}function Tn(e,t,n=!1,r=!1,o=!1){var i=e,s="";it(()=>{var e=Et;if(s!==(s=t()??"")&&(null!==e.nodes_start&&(dt(e.nodes_start,e.nodes_end),e.nodes_start=e.nodes_end=null),""!==s)){var o=s+"";n?o=`<svg>${o}</svg>`:r&&(o=`<math>${o}</math>`);var a=an(o);if((n||r)&&(a=je(a)),ln(je(a),a.lastChild),n||r)for(;je(a);)i.before(je(a));else i.before(a)}})}function On(e,t,n){var r=new bn(e);st(()=>{var e=t()??null;r.ensure(e,e&&(t=>n(t,e)))},A)}function Nn(e,t,n){rt(()=>{var r=Zt(()=>t(e,n?.())||{});if(n&&r?.update){var o=!1,i={};ot(()=>{var e=n();Gt(e),o&&H(i,e)&&(i=e,r.update(e))}),o=!0}if(r?.destroy)return()=>r.destroy()})}function Pn(e,t){var n,r=void 0;st(()=>{r!==(r=t())&&(n&&(ut(n),n=null),r&&(n=at(()=>{rt(()=>r(e))})))})}function zn(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=zn(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function In(e){return"object"==typeof e?function(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=zn(e))&&(r&&(r+=" "),r+=t);return r}(e):e??""}const Ln=[..." \t\n\r\fÂ \v\ufeff"];function $n(e,t=!1){var n=t?" !important;":";",r="";for(var o in e){var i=e[o];null!=i&&""!==i&&(r+=" "+o+": "+i+n)}return r}function Rn(e){return"-"!==e[0]||"-"!==e[1]?e.toLowerCase():e}function Fn(e,t,n,r,o,i){var s=e.__className;if(s!==n||void 0===s){var a=function(e,t,n){var r=null==e?"":""+e;if(t&&(r=r?r+" "+t:t),n)for(var o in n)if(n[o])r=r?r+" "+o:o;else if(r.length)for(var i=o.length,s=0;(s=r.indexOf(o,s))>=0;){var a=s+i;0!==s&&!Ln.includes(r[s-1])||a!==r.length&&!Ln.includes(r[a])?s=a:r=(0===s?"":r.substring(0,s))+r.substring(a+1)}return""===r?null:r}(n,r,i);null==a?e.removeAttribute("class"):t?e.className=a:e.setAttribute("class",a),e.__className=n}else if(i&&o!==i)for(var l in i){var c=!!i[l];null!=o&&c===!!o[l]||e.classList.toggle(l,c)}return i}function Bn(e,t={},n,r){for(var o in n){var i=n[o];t[o]!==i&&(null==n[o]?e.style.removeProperty(o):e.style.setProperty(o,i,r))}}function Vn(e,t,n,r){if(e.__style!==t){var o=function(e,t){if(t){var n,r,o="";if(Array.isArray(t)?(n=t[0],r=t[1]):n=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var i=!1,s=0,a=!1,l=[];n&&l.push(...Object.keys(n).map(Rn)),r&&l.push(...Object.keys(r).map(Rn));var c=0,u=-1;const t=e.length;for(var d=0;d<t;d++){var h=e[d];if(a?"/"===h&&"*"===e[d-1]&&(a=!1):i?i===h&&(i=!1):"/"===h&&"*"===e[d+1]?a=!0:'"'===h||"'"===h?i=h:"("===h?s++:")"===h&&s--,!a&&!1===i&&0===s)if(":"===h&&-1===u)u=d;else if(";"===h||d===t-1){if(-1!==u){var p=Rn(e.substring(c,u).trim());l.includes(p)||(";"!==h&&d++,o+=" "+e.substring(c,d).trim()+";")}c=d+1,u=-1}}}return n&&(o+=$n(n)),r&&(o+=$n(r,!0)),""===(o=o.trim())?null:o}return null==e?null:String(e)}(t,r);null==o?e.removeAttribute("style"):e.style.cssText=o,e.__style=t}else r&&(Array.isArray(r)?(Bn(e,n?.[0],r[0]),Bn(e,n?.[1],r[1],"important")):Bn(e,n,r));return r}function Hn(e,t,n=!1){if(e.multiple){if(null==t)return;if(!r(t))return void console.warn("https://svelte.dev/e/select_multiple_invalid_value");for(var o of e.options)o.selected=t.includes(jn(o))}else{for(o of e.options){if(Fe(jn(o),t))return void(o.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}}function jn(e){return"__value"in e?e.__value:e.value}const qn=Symbol("class"),Kn=Symbol("style"),Wn=Symbol("is custom element"),Zn=Symbol("is html");function Un(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function Jn(e,t,n,r){var o=Xn(e);o[t]!==(o[t]=n)&&("loading"===t&&(e[R]=n),null==n?e.removeAttribute(t):"string"!=typeof n&&Qn(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Gn(e,n,r=[],o=[],i=[],s,a=!1,l=!1){ve(i,r,o,r=>{var o=void 0,i={},c="SELECT"===e.nodeName,u=!1;if(st(()=>{var d=n(...r.map(Kt)),h=function(e,n,r,o){var i=Xn(e),s=i[Wn],a=!i[Zn],l=n||{},c="OPTION"===e.tagName;for(var u in n)u in r||(r[u]=null);r.class?r.class=In(r.class):(o||r[qn])&&(r.class=null),r[Kn]&&(r.style??=null);var d=Qn(e);for(const y in r){let u=r[y];if(c&&"value"===y&&null==u)e.value=e.__value="",l[y]=u;else if("class"!==y)if("style"!==y){var h=l[y];if(u!==h||void 0===u&&e.hasAttribute(y)){l[y]=u;var p=y[0]+y[1];if("$$"!==p)if("on"===p){const t={},n="$$"+y;let r=y.slice(2);var f=gn(r);if(fn(r)&&(r=r.slice(0,-7),t.capture=!0),!f&&h){if(null!=u)continue;e.removeEventListener(r,l[n],t),l[n]=null}if(null!=u)if(f)e[`__${r}`]=u,rn([r]);else{let o=function(e){l[y].call(this,e)};l[n]=en(r,e,o,t)}else f&&(e[`__${r}`]=void 0)}else if("style"===y)Jn(e,y,u);else if("autofocus"===y)Ue(e,Boolean(u));else if(s||"__value"!==y&&("value"!==y||null==u))if("selected"===y&&c)Un(e,u);else{var m=y;a||(m=vn(m));var g="defaultValue"===m||"defaultChecked"===m;if(null!=u||s||g)g||d.includes(m)&&(s||"string"!=typeof u)?(e[m]=u,m in i&&(i[m]=t)):"function"!=typeof u&&Jn(e,m,u);else if(i[y]=null,"value"===m||"checked"===m){let t=e;const r=void 0===n;if("value"===m){let e=t.defaultValue;t.removeAttribute(m),t.defaultValue=e,t.value=t.__value=r?e:null}else{let e=t.defaultChecked;t.removeAttribute(m),t.defaultChecked=e,t.checked=!!r&&e}}else e.removeAttribute(y)}else e.value=e.__value=u}}else Vn(e,u,n?.[Kn],r[Kn]),l[y]=u,l[Kn]=r[Kn];else Fn(e,"http://www.w3.org/1999/xhtml"===e.namespaceURI,u,o,n?.[qn],r[qn]),l[y]=u,l[qn]=r[qn]}return l}(e,o,d,s,a,l);u&&c&&"value"in d&&Hn(e,d.value);for(let e of Object.getOwnPropertySymbols(i))d[e]||ut(i[e]);for(let t of Object.getOwnPropertySymbols(d)){var p=d[t];"@attach"!==t.description||o&&p===o[t]||(i[t]&&ut(i[t]),i[t]=at(()=>Pn(e,()=>p))),h[t]=p}o=h}),c){var d=e;rt(()=>{Hn(d,o.value,!0),function(e){var t=new MutationObserver(()=>{Hn(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ye(()=>{t.disconnect()})}(d)})}u=!0})}function Xn(e){return e.__attributes??={[Wn]:e.nodeName.includes("-"),[Zn]:"http://www.w3.org/1999/xhtml"===e.namespaceURI}}var Yn=new Map;function Qn(e){var t,n=e.getAttribute("is")||e.nodeName,r=Yn.get(n);if(r)return r;Yn.set(n,r=[]);for(var o=e,i=Element.prototype;i!==o;){for(var s in t=l(o))t[s].set&&r.push(s);o=d(o)}return r}class er{#g=new WeakMap;#y;#v;static entries=new WeakMap;constructor(e){this.#v=e}observe(e,t){var n=this.#g.get(e)||new Set;return n.add(t),this.#g.set(e,n),this.#k().observe(e,this.#v),()=>{var n=this.#g.get(e);n.delete(t),0===n.size&&(this.#g.delete(e),this.#y.unobserve(e))}}#k(){return this.#y??(this.#y=new ResizeObserver(e=>{for(var t of e)for(var n of(er.entries.set(t.target,t),this.#g.get(t.target)||[]))n(t)}))}}var tr=new er({box:"border-box"});function nr(e,t,n){var r=tr.observe(e,()=>n(e[t]));rt(()=>(Zt(()=>n(e[t])),r))}function rr(e,t){return e===t||e?.[L]===t}function or(e={},t,n,r){return rt(()=>{var r,o;return ot(()=>{r=o,o=[],Zt(()=>{e!==n(...o)&&(t(e,...o),r&&rr(n(...r),e)&&t(null,...r))})}),()=>{ne(()=>{o&&rr(n(...o),e)&&t(null,...o)})}}),e}function ir(e=!1){const t=Z,n=t.l.u;if(!n)return;let r=()=>Gt(t.s);if(e){let e=0,n={};const o=be(()=>{let r=!1;const o=t.s;for(const e in o)o[e]!==n[e]&&(n[e]=o[e],r=!0);return r&&e++,e});r=()=>Kt(o)}n.b.length&&tt(()=>{sr(t,r),m(n.b)}),Qe(()=>{const e=Zt(()=>n.m.map(f));return()=>{for(const t of e)"function"==typeof t&&t()}}),n.a.length&&Qe(()=>{sr(t,r),m(n.a)})}function sr(e,t){if(e.l.s)for(const n of e.l.s)Kt(n);t()}function ar(e,t,n){if(null==e)return t(void 0),p;const r=Zt(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const lr=[];function cr(e,t=p){let n=null;const r=new Set;function o(t){if(H(e,t)&&(e=t,n)){const t=!lr.length;for(const n of r)n[1](),lr.push(n,e);if(t){for(let e=0;e<lr.length;e+=2)lr[e][0](lr[e+1]);lr.length=0}}}function i(t){o(t(e))}return{set:o,update:i,subscribe:function(s,a=p){const l=[s,a];return r.add(l),1===r.size&&(n=t(o,i)||p),s(e),()=>{r.delete(l),0===r.size&&n&&(n(),n=null)}}}}let ur=!1,dr=Symbol();function hr(e,t,n){const r=n[t]??={store:null,source:Ne(void 0),unsubscribe:p};if(r.store!==e&&!(dr in n))if(r.unsubscribe(),r.store=e??null,null==e)r.source.v=void 0,r.unsubscribe=p;else{var o=!0;r.unsubscribe=ar(e,e=>{o?r.source.v=e:Pe(r.source,e)}),o=!1}return e&&dr in n?function(e){let t;return ar(e,e=>t=e)(),t}(e):Kt(r.source)}const pr={get(e,t){if(!e.exclude.includes(t))return e.props[t]},set:(e,t)=>!1,getOwnPropertyDescriptor(e,t){if(!e.exclude.includes(t))return t in e.props?{enumerable:!0,configurable:!0,value:e.props[t]}:void 0},has:(e,t)=>!e.exclude.includes(t)&&t in e.props,ownKeys:e=>Reflect.ownKeys(e.props).filter(t=>!e.exclude.includes(t))};function fr(e,t,n){return new Proxy({props:e,exclude:t},pr)}const mr={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(h(r)&&(r=r()),"object"==typeof r&&null!==r&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let o=e.props[r];h(o)&&(o=o());const i=a(o,t);if(i&&i.set)return i.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(h(r)&&(r=r()),"object"==typeof r&&null!==r&&t in r){const e=a(r,t);return e&&!e.configurable&&(e.configurable=!0),e}}},has(e,t){if(t===L||t===$)return!1;for(let n of e.props)if(h(n)&&(n=n()),null!=n&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props)if(h(n)&&(n=n()),n){for(const e in n)t.includes(e)||t.push(e);for(const e of Object.getOwnPropertySymbols(n))t.includes(e)||t.push(e)}return t}};function gr(...e){return new Proxy({props:e},mr)}function yr(t,n,r,o){var i,s,l=!e||!!(2&r),c=!!(8&r),u=!!(16&r),d=o,h=!0,p=()=>(h&&(h=!1,d=u?Zt(o):o),d);if(c){var f=L in t||$ in t;i=a(t,n)?.set??(f&&n in t?e=>t[n]=e:void 0)}var m,g=!1;if(c?[s,g]=function(e){var t=ur;try{return ur=!1,[e(),ur]}finally{ur=t}}(()=>t[n]):s=t[n],void 0===s&&void 0!==o&&(s=p(),i&&(l&&function(){throw new Error("https://svelte.dev/e/props_invalid_value")}(),i(s))),m=l?()=>{var e=t[n];return void 0===e?p():(h=!0,e)}:()=>{var e=t[n];return void 0!==e&&(d=void 0),void 0===e?d:e},l&&!(4&r))return m;if(i){var y=t.$$legacy;return function(e,t){return arguments.length>0?(l&&t&&!y&&!g||i(t?m():e),e):m()}}var v=!1,k=(1&r?be:Ce)(()=>(v=!1,m()));c&&Kt(k);var b=Et;return function(e,t){if(arguments.length>0){const n=t?Kt(k):l&&c?$e(e):e;return Pe(k,n),v=!0,void 0!==d&&(d=n),e}return wt&&v||0!==(b.f&E)?k.v:Kt(k)}}var vr={value:()=>{}};function kr(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new br(r)}function br(e){this._=e}function wr(e,t){for(var n,r=0,o=e.length;r<o;++r)if((n=e[r]).name===t)return n.value}function xr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=vr,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}br.prototype=kr.prototype={constructor:br,on:function(e,t){var n,r,o=this._,i=(r=o,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),s=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<a;)if(n=(e=i[s]).type)o[n]=xr(o[n],e.name,t);else if(null==t)for(n in o)o[n]=xr(o[n],e.name,null);return this}for(;++s<a;)if((n=(e=i[s]).type)&&(n=wr(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new br(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};var Cr="http://www.w3.org/1999/xhtml";const _r={svg:"http://www.w3.org/2000/svg",xhtml:Cr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Sr(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),_r.hasOwnProperty(t)?{space:_r[t],local:e}:e}function Er(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cr&&t.documentElement.namespaceURI===Cr?t.createElement(e):t.createElementNS(n,e)}}function Mr(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ar(e){var t=Sr(e);return(t.local?Mr:Er)(t)}function Dr(){}function Tr(e){return null==e?Dr:function(){return this.querySelector(e)}}function Or(){return[]}function Nr(e){return null==e?Or:function(){return this.querySelectorAll(e)}}function Pr(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}function zr(e){return function(){return this.matches(e)}}function Ir(e){return function(t){return t.matches(e)}}var Lr=Array.prototype.find;function $r(){return this.firstElementChild}var Rr=Array.prototype.filter;function Fr(){return Array.from(this.children)}function Br(e){return new Array(e.length)}function Vr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Hr(e,t,n,r,o,i){for(var s,a=0,l=t.length,c=i.length;a<c;++a)(s=t[a])?(s.__data__=i[a],r[a]=s):n[a]=new Vr(e,i[a]);for(;a<l;++a)(s=t[a])&&(o[a]=s)}function jr(e,t,n,r,o,i,s){var a,l,c,u=new Map,d=t.length,h=i.length,p=new Array(d);for(a=0;a<d;++a)(l=t[a])&&(p[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?o[a]=l:u.set(c,l));for(a=0;a<h;++a)c=s.call(e,i[a],a,i)+"",(l=u.get(c))?(r[a]=l,l.__data__=i[a],u.delete(c)):n[a]=new Vr(e,i[a]);for(a=0;a<d;++a)(l=t[a])&&u.get(p[a])===l&&(o[a]=l)}function qr(e){return e.__data__}function Kr(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Wr(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Zr(e){return function(){this.removeAttribute(e)}}function Ur(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Jr(e,t){return function(){this.setAttribute(e,t)}}function Gr(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Xr(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Yr(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Qr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function eo(e){return function(){this.style.removeProperty(e)}}function to(e,t,n){return function(){this.style.setProperty(e,t,n)}}function no(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ro(e,t){return e.style.getPropertyValue(t)||Qr(e).getComputedStyle(e,null).getPropertyValue(t)}function oo(e){return function(){delete this[e]}}function io(e,t){return function(){this[e]=t}}function so(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function ao(e){return e.trim().split(/^|\s+/)}function lo(e){return e.classList||new co(e)}function co(e){this._node=e,this._names=ao(e.getAttribute("class")||"")}function uo(e,t){for(var n=lo(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function ho(e,t){for(var n=lo(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function po(e){return function(){uo(this,e)}}function fo(e){return function(){ho(this,e)}}function mo(e,t){return function(){(t.apply(this,arguments)?uo:ho)(this,e)}}function go(){this.textContent=""}function yo(e){return function(){this.textContent=e}}function vo(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ko(){this.innerHTML=""}function bo(e){return function(){this.innerHTML=e}}function wo(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function xo(){this.nextSibling&&this.parentNode.appendChild(this)}function Co(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _o(){return null}function So(){var e=this.parentNode;e&&e.removeChild(this)}function Eo(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mo(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ao(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function Do(e,t,n){return function(){var r,o=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function To(e,t,n){var r=Qr(e),o=r.CustomEvent;"function"==typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Oo(e,t){return function(){return To(this,e,t)}}function No(e,t){return function(){return To(this,e,t.apply(this,arguments))}}Vr.prototype={constructor:Vr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},co.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Po=[null];function zo(e,t){this._groups=e,this._parents=t}function Io(){return new zo([[document.documentElement]],Po)}function Lo(e){return"string"==typeof e?new zo([[document.querySelector(e)]],[document.documentElement]):new zo([[e]],Po)}function $o(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}zo.prototype=Io.prototype={constructor:zo,select:function(e){"function"!=typeof e&&(e=Tr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,s,a=t[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(i=a[u])&&(s=e.call(i,i.__data__,u,a))&&("__data__"in i&&(s.__data__=i.__data__),c[u]=s);return new zo(r,this._parents)},selectAll:function(e){e="function"==typeof e?Pr(e):Nr(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s,a=t[i],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(e.call(s,s.__data__,c,a)),o.push(s));return new zo(r,o)},selectChild:function(e){return this.select(null==e?$r:function(e){return function(){return Lr.call(this.children,e)}}("function"==typeof e?e:Ir(e)))},selectChildren:function(e){return this.selectAll(null==e?Fr:function(e){return function(){return Rr.call(this.children,e)}}("function"==typeof e?e:Ir(e)))},filter:function(e){"function"!=typeof e&&(e=zr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,s=t[o],a=s.length,l=r[o]=[],c=0;c<a;++c)(i=s[c])&&e.call(i,i.__data__,c,s)&&l.push(i);return new zo(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,qr);var n,r=t?jr:Hr,o=this._parents,i=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var s=i.length,a=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var d=o[u],h=i[u],p=h.length,f=Kr(e.call(d,d&&d.__data__,u,o)),m=f.length,g=l[u]=new Array(m),y=a[u]=new Array(m);r(d,h,g,y,c[u]=new Array(p),f,t);for(var v,k,b=0,w=0;b<m;++b)if(v=g[b]){for(b>=w&&(w=b+1);!(k=y[w])&&++w<m;);v._next=k||null}}return(a=new zo(a,o))._enter=l,a._exit=c,a},enter:function(){return new zo(this._enter||this._groups.map(Br),this._parents)},exit:function(){return new zo(this._exit||this._groups.map(Br),this._parents)},join:function(e,t,n){var r=this.enter(),o=this,i=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var c,u=n[l],d=r[l],h=u.length,p=a[l]=new Array(h),f=0;f<h;++f)(c=u[f]||d[f])&&(p[f]=c);for(;l<o;++l)a[l]=n[l];return new zo(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],i=o.length-1,s=o[i];--i>=0;)(r=o[i])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Wr);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s,a=n[i],l=a.length,c=o[i]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new zo(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,i=t[n],s=0,a=i.length;s<a;++s)(o=i[s])&&e.call(o,o.__data__,s,i);return this},attr:function(e,t){var n=Sr(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Ur:Zr:"function"==typeof t?n.local?Yr:Xr:n.local?Gr:Jr)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?eo:"function"==typeof t?no:to)(e,t,null==n?"":n)):ro(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?oo:"function"==typeof t?so:io)(e,t)):this.node()[e]},classed:function(e,t){var n=ao(e+"");if(arguments.length<2){for(var r=lo(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof t?mo:t?po:fo)(n,t))},text:function(e){return arguments.length?this.each(null==e?go:("function"==typeof e?vo:yo)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ko:("function"==typeof e?wo:bo)(e)):this.node().innerHTML},raise:function(){return this.each(xo)},lower:function(){return this.each(Co)},append:function(e){var t="function"==typeof e?e:Ar(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:Ar(e),r=null==t?_o:"function"==typeof t?t:Tr(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(So)},clone:function(e){return this.select(e?Mo:Eo)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),s=i.length;if(!(arguments.length<2)){for(a=t?Do:Ao,r=0;r<s;++r)this.each(a(i[r],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?No:Oo)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,o=e[t],i=0,s=o.length;i<s;++i)(r=o[i])&&(yield r)}};const Ro={passive:!1},Fo={capture:!0,passive:!1};function Bo(e){e.stopImmediatePropagation()}function Vo(e){e.preventDefault(),e.stopImmediatePropagation()}function Ho(e){var t=e.document.documentElement,n=Lo(e).on("dragstart.drag",Vo,Fo);"onselectstart"in t?n.on("selectstart.drag",Vo,Fo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function jo(e,t){var n=e.document.documentElement,r=Lo(e).on("dragstart.drag",null);t&&(r.on("click.drag",Vo,Fo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const qo=e=>()=>e;function Ko(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}function Wo(e){return!e.ctrlKey&&!e.button}function Zo(){return this.parentNode}function Uo(e,t){return null==t?{x:e.x,y:e.y}:t}function Jo(){return navigator.maxTouchPoints||"ontouchstart"in this}function Go(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Xo(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Yo(){}Ko.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Qo=.7,ei=1/Qo,ti="\\s*([+-]?\\d+)\\s*",ni="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ri="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oi=/^#([0-9a-f]{3,8})$/,ii=new RegExp(`^rgb\\(${ti},${ti},${ti}\\)$`),si=new RegExp(`^rgb\\(${ri},${ri},${ri}\\)$`),ai=new RegExp(`^rgba\\(${ti},${ti},${ti},${ni}\\)$`),li=new RegExp(`^rgba\\(${ri},${ri},${ri},${ni}\\)$`),ci=new RegExp(`^hsl\\(${ni},${ri},${ri}\\)$`),ui=new RegExp(`^hsla\\(${ni},${ri},${ri},${ni}\\)$`),di={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function hi(){return this.rgb().formatHex()}function pi(){return this.rgb().formatRgb()}function fi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=oi.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?mi(t):3===n?new vi(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?gi(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?gi(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=ii.exec(e))?new vi(t[1],t[2],t[3],1):(t=si.exec(e))?new vi(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ai.exec(e))?gi(t[1],t[2],t[3],t[4]):(t=li.exec(e))?gi(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ci.exec(e))?_i(t[1],t[2]/100,t[3]/100,1):(t=ui.exec(e))?_i(t[1],t[2]/100,t[3]/100,t[4]):di.hasOwnProperty(e)?mi(di[e]):"transparent"===e?new vi(NaN,NaN,NaN,0):null}function mi(e){return new vi(e>>16&255,e>>8&255,255&e,1)}function gi(e,t,n,r){return r<=0&&(e=t=n=NaN),new vi(e,t,n,r)}function yi(e,t,n,r){return 1===arguments.length?((o=e)instanceof Yo||(o=fi(o)),o?new vi((o=o.rgb()).r,o.g,o.b,o.opacity):new vi):new vi(e,t,n,null==r?1:r);var o}function vi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function ki(){return`#${Ci(this.r)}${Ci(this.g)}${Ci(this.b)}`}function bi(){const e=wi(this.opacity);return`${1===e?"rgb(":"rgba("}${xi(this.r)}, ${xi(this.g)}, ${xi(this.b)}${1===e?")":`, ${e})`}`}function wi(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ci(e){return((e=xi(e))<16?"0":"")+e.toString(16)}function _i(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ei(e,t,n,r)}function Si(e){if(e instanceof Ei)return new Ei(e.h,e.s,e.l,e.opacity);if(e instanceof Yo||(e=fi(e)),!e)return new Ei;if(e instanceof Ei)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(s=t===i?(n-r)/a+6*(n<r):n===i?(r-t)/a+2:(t-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new Ei(s,a,l,e.opacity)}function Ei(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Mi(e){return(e=(e||0)%360)<0?e+360:e}function Ai(e){return Math.max(0,Math.min(1,e||0))}function Di(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Go(Yo,fi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:hi,formatHex:hi,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Si(this).formatHsl()},formatRgb:pi,toString:pi}),Go(vi,yi,Xo(Yo,{brighter(e){return e=null==e?ei:Math.pow(ei,e),new vi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Qo:Math.pow(Qo,e),new vi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new vi(xi(this.r),xi(this.g),xi(this.b),wi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ki,formatHex:ki,formatHex8:function(){return`#${Ci(this.r)}${Ci(this.g)}${Ci(this.b)}${Ci(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:bi,toString:bi})),Go(Ei,function(e,t,n,r){return 1===arguments.length?Si(e):new Ei(e,t,n,null==r?1:r)},Xo(Yo,{brighter(e){return e=null==e?ei:Math.pow(ei,e),new Ei(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Qo:Math.pow(Qo,e),new Ei(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new vi(Di(e>=240?e-240:e+120,o,r),Di(e,o,r),Di(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new Ei(Mi(this.h),Ai(this.s),Ai(this.l),wi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=wi(this.opacity);return`${1===e?"hsl(":"hsla("}${Mi(this.h)}, ${100*Ai(this.s)}%, ${100*Ai(this.l)}%${1===e?")":`, ${e})`}`}}));const Ti=e=>()=>e;function Oi(e){return 1===(e=+e)?Ni:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Ti(isNaN(t)?n:t)}}function Ni(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Ti(isNaN(e)?t:e)}const Pi=function e(t){var n=Oi(t);function r(e,t){var r=n((e=yi(e)).r,(t=yi(t)).r),o=n(e.g,t.g),i=n(e.b,t.b),s=Ni(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=i(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function zi(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,o=t.slice();return function(i){for(n=0;n<r;++n)o[n]=e[n]*(1-i)+t[n]*i;return o}}function Ii(e,t){var n,r=t?t.length:0,o=e?Math.min(r,e.length):0,i=new Array(o),s=new Array(r);for(n=0;n<o;++n)i[n]=Hi(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<o;++n)s[n]=i[n](e);return s}}function Li(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function $i(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Ri(e,t){var n,r={},o={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Hi(e[n],t[n]):o[n]=t[n];return function(e){for(n in r)o[n]=r[n](e);return o}}var Fi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bi=new RegExp(Fi.source,"g");function Vi(e,t){var n,r,o,i=Fi.lastIndex=Bi.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=Fi.exec(e))&&(r=Bi.exec(t));)(o=r.index)>i&&(o=t.slice(i,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:$i(n,r)})),i=Bi.lastIndex;return i<t.length&&(o=t.slice(i),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)a[(n=l[r]).i]=n.x(e);return a.join("")})}function Hi(e,t){var n,r,o=typeof t;return null==t||"boolean"===o?Ti(t):("number"===o?$i:"string"===o?(n=fi(t))?(t=n,Pi):Vi:t instanceof fi?Pi:t instanceof Date?Li:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?Ii:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Ri:$i:zi))(e,t)}var ji,qi=180/Math.PI,Ki={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Wi(e,t,n,r,o,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*qi,skewX:Math.atan(l)*qi,scaleX:s,scaleY:a}}function Zi(e,t,n,r){function o(e){return e.length?e.pop()+" ":""}return function(i,s){var a=[],l=[];return i=e(i),s=e(s),function(e,r,o,i,s,a){if(e!==o||r!==i){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:$i(e,o)},{i:l-2,x:$i(r,i)})}else(o||i)&&s.push("translate("+o+t+i+n)}(i.translateX,i.translateY,s.translateX,s.translateY,a,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(o(n)+"rotate(",null,r)-2,x:$i(e,t)})):t&&n.push(o(n)+"rotate("+t+r)}(i.rotate,s.rotate,a,l),function(e,t,n,i){e!==t?i.push({i:n.push(o(n)+"skewX(",null,r)-2,x:$i(e,t)}):t&&n.push(o(n)+"skewX("+t+r)}(i.skewX,s.skewX,a,l),function(e,t,n,r,i,s){if(e!==n||t!==r){var a=i.push(o(i)+"scale(",null,",",null,")");s.push({i:a-4,x:$i(e,n)},{i:a-2,x:$i(t,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,s.scaleX,s.scaleY,a,l),i=s=null,function(e){for(var t,n=-1,r=l.length;++n<r;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var Ui=Zi(function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ki:Wi(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),Ji=Zi(function(e){return null==e?Ki:(ji||(ji=document.createElementNS("http://www.w3.org/2000/svg","g")),ji.setAttribute("transform",e),(e=ji.transform.baseVal.consolidate())?Wi((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Ki)},", ",")",")");function Gi(e){return((e=Math.exp(e))+1/e)/2}const Xi=function e(t,n,r){function o(e,o){var i,s,a=e[0],l=e[1],c=e[2],u=o[0],d=o[1],h=o[2],p=u-a,f=d-l,m=p*p+f*f;if(m<1e-12)s=Math.log(h/c)/t,i=function(e){return[a+e*p,l+e*f,c*Math.exp(t*e*s)]};else{var g=Math.sqrt(m),y=(h*h-c*c+r*m)/(2*c*n*g),v=(h*h-c*c-r*m)/(2*h*n*g),k=Math.log(Math.sqrt(y*y+1)-y),b=Math.log(Math.sqrt(v*v+1)-v);s=(b-k)/t,i=function(e){var r,o=e*s,i=Gi(k),u=c/(n*g)*(i*(r=t*o+k,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(k));return[a+u*p,l+u*f,c*i/Gi(t*o+k)]}}return i.duration=1e3*s*t/Math.SQRT2,i}return o.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},o}(Math.SQRT2,2,4);var Yi,Qi,es=0,ts=0,ns=0,rs=0,is=0,ss=0,as="object"==typeof performance&&performance.now?performance:Date,ls="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function cs(){return is||(ls(us),is=as.now()+ss)}function us(){is=0}function ds(){this._call=this._time=this._next=null}function hs(e,t,n){var r=new ds;return r.restart(e,t,n),r}function ps(){is=(rs=as.now())+ss,es=ts=0;try{!function(){cs(),++es;for(var e,t=Yi;t;)(e=is-t._time)>=0&&t._call.call(void 0,e),t=t._next;--es}()}finally{es=0,function(){var e,t,n=Yi,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Yi=t);Qi=e,ms(r)}(),is=0}}function fs(){var e=as.now(),t=e-rs;t>1e3&&(ss-=t,rs=e)}function ms(e){es||(ts&&(ts=clearTimeout(ts)),e-is>24?(e<1/0&&(ts=setTimeout(ps,e-as.now()-ss)),ns&&(ns=clearInterval(ns))):(ns||(rs=as.now(),ns=setInterval(fs,1e3)),es=1,ls(ps)))}function gs(e,t,n){var r=new ds;return t=null==t?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}ds.prototype=hs.prototype={constructor:ds,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?cs():+n)+(null==t?0:+t),this._next||Qi===this||(Qi?Qi._next=this:Yi=this,Qi=this),this._call=e,this._time=n,ms()},stop:function(){this._call&&(this._call=null,this._time=1/0,ms())}};var ys=kr("start","end","cancel","interrupt"),vs=[];function ks(e,t,n,r,o,i){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var r,o=e.__transition;function i(e){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=e&&s(e-n.delay)}function s(i){var c,u,d,h;if(1!==n.state)return l();for(c in o)if((h=o[c]).name===n.name){if(3===h.state)return gs(s);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[c])}if(gs(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(i))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function a(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),i=-1,s=r.length;++i<s;)r[i].call(e,o);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=hs(i,0,n.time)}(e,n,{name:t,index:r,group:o,on:ys,tween:vs,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function bs(e,t){var n=xs(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function ws(e,t){var n=xs(e,t);if(n.state>3)throw new Error("too late; already running");return n}function xs(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Cs(e,t){var n,r,o,i=e.__transition,s=!0;if(i){for(o in t=null==t?null:t+"",i)(n=i[o]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[o]):s=!1;s&&delete e.__transition}}function _s(e,t){var n,r;return function(){var o=ws(this,e),i=o.tween;if(i!==n)for(var s=0,a=(r=n=i).length;s<a;++s)if(r[s].name===t){(r=r.slice()).splice(s,1);break}o.tween=r}}function Ss(e,t,n){var r,o;if("function"!=typeof n)throw new Error;return function(){var i=ws(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=a;break}l===c&&o.push(a)}i.tween=o}}function Es(e,t,n){var r=e._id;return e.each(function(){var e=ws(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return xs(e,r).value[t]}}function Ms(e,t){var n;return("number"==typeof t?$i:t instanceof fi?Pi:(n=fi(t))?(t=n,Pi):Vi)(e,t)}function As(e){return function(){this.removeAttribute(e)}}function Ds(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ts(e,t,n){var r,o,i=n+"";return function(){var s=this.getAttribute(e);return s===i?null:s===r?o:o=t(r=s,n)}}function Os(e,t,n){var r,o,i=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===r?o:o=t(r=s,n)}}function Ns(e,t,n){var r,o,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(a=l+"")?null:s===r&&a===o?i:(o=a,i=t(r=s,l));this.removeAttribute(e)}}function Ps(e,t,n){var r,o,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===r&&a===o?i:(o=a,i=t(r=s,l));this.removeAttributeNS(e.space,e.local)}}function zs(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,o)),n}return o._value=t,o}function Is(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,o)),n}return o._value=t,o}function Ls(e,t){return function(){bs(this,e).delay=+t.apply(this,arguments)}}function $s(e,t){return t=+t,function(){bs(this,e).delay=t}}function Rs(e,t){return function(){ws(this,e).duration=+t.apply(this,arguments)}}function Fs(e,t){return t=+t,function(){ws(this,e).duration=t}}var Bs=Io.prototype.constructor;function Vs(e){return function(){this.style.removeProperty(e)}}var Hs=0;function js(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function qs(){return++Hs}var Ks=Io.prototype;js.prototype={constructor:js,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Tr(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a,l,c=r[s],u=c.length,d=i[s]=new Array(u),h=0;h<u;++h)(a=c[h])&&(l=e.call(a,a.__data__,h,c))&&("__data__"in a&&(l.__data__=a.__data__),d[h]=l,ks(d[h],t,n,h,d,xs(a,n)));return new js(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Nr(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l,c=r[a],u=c.length,d=0;d<u;++d)if(l=c[d]){for(var h,p=e.call(l,l.__data__,d,c),f=xs(l,n),m=0,g=p.length;m<g;++m)(h=p[m])&&ks(h,t,n,m,p,f);i.push(p),s.push(l)}return new js(i,s,t,n)},selectChild:Ks.selectChild,selectChildren:Ks.selectChildren,filter:function(e){"function"!=typeof e&&(e=zr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,s=t[o],a=s.length,l=r[o]=[],c=0;c<a;++c)(i=s[c])&&e.call(i,i.__data__,c,s)&&l.push(i);return new js(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l,c=t[a],u=n[a],d=c.length,h=s[a]=new Array(d),p=0;p<d;++p)(l=c[p]||u[p])&&(h[p]=l);for(;a<r;++a)s[a]=t[a];return new js(s,this._parents,this._name,this._id)},selection:function(){return new Bs(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=qs(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s,a=r[i],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=xs(s,t);ks(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new js(r,this._parents,e,n)},call:Ks.call,nodes:Ks.nodes,node:Ks.node,size:Ks.size,empty:Ks.empty,each:Ks.each,on:function(e,t){var n=this._id;return arguments.length<2?xs(this.node(),n).on.on(e):this.each(function(e,t,n){var r,o,i=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?bs:ws;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}(n,e,t))},attr:function(e,t){var n=Sr(e),r="transform"===n?Ji:Ms;return this.attrTween(e,"function"==typeof t?(n.local?Ps:Ns)(n,r,Es(this,"attr."+e,t)):null==t?(n.local?Ds:As)(n):(n.local?Os:Ts)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=Sr(e);return this.tween(n,(r.local?zs:Is)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?Ui:Ms;return null==t?this.styleTween(e,function(e,t){var n,r,o;return function(){var i=ro(this,e),s=(this.style.removeProperty(e),ro(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}(e,r)).on("end.style."+e,Vs(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,o,i;return function(){var s=ro(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=ro(this,e)),s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a))}}(e,r,Es(this,"style."+e,t))).each(function(e,t){var n,r,o,i,s="style."+t,a="end."+s;return function(){var l=ws(this,e),c=l.on,u=null==l.value[s]?i||(i=Vs(t)):void 0;c===n&&o===u||(r=(n=c).copy()).on(a,o=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,o,i=n+"";return function(){var s=ro(this,e);return s===i?null:s===r?o:o=t(r=s,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,o;function i(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,i,n)),r}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Es(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,o=xs(this.node(),n).tween,i=0,s=o.length;i<s;++i)if((r=o[i]).name===e)return r.value;return null}return this.each((null==t?_s:Ss)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Ls:$s)(t,e)):xs(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Rs:Fs)(t,e)):xs(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){ws(this,e).ease=t}}(t,e)):xs(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;ws(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){0===--o&&i()}};n.each(function(){var n=ws(this,r),o=n.on;o!==e&&((t=(e=o).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t}),0===o&&i()})},[Symbol.iterator]:Ks[Symbol.iterator]};var Ws={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Zs(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}Io.prototype.interrupt=function(e){return this.each(function(){Cs(this,e)})},Io.prototype.transition=function(e){var t,n;e instanceof js?(t=e._id,e=e._name):(t=qs(),(n=Ws).time=cs(),e=null==e?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s,a=r[i],l=a.length,c=0;c<l;++c)(s=a[c])&&ks(s,e,t,c,a,n||Zs(s,t));return new js(r,this._parents,e,t)};const Us=e=>()=>e;function Js(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Gs(e,t,n){this.k=e,this.x=t,this.y=n}Gs.prototype={constructor:Gs,scale:function(e){return 1===e?this:new Gs(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Gs(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Xs=new Gs(1,0,0);function Ys(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Xs;return e.__zoom}function Qs(e){e.stopImmediatePropagation()}function ea(e){e.preventDefault(),e.stopImmediatePropagation()}function ta(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function na(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function ra(){return this.__zoom||Xs}function oa(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ia(){return navigator.maxTouchPoints||"ontouchstart"in this}function sa(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function aa(){var e,t,n,r=ta,o=na,i=sa,s=oa,a=ia,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=Xi,h=kr("start","zoom","end"),p=0,f=10;function m(e){e.property("__zoom",ra).on("wheel.zoom",x,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",_).filter(a).on("touchstart.zoom",S).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new Gs(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return r===e.x&&o===e.y?e:new Gs(e.k,r,o)}function v(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function k(e,t,n,r){e.on("start.zoom",function(){b(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(r).end()}).tween("zoom",function(){var e=this,i=arguments,s=b(e,i).event(r),a=o.apply(e,i),l=null==n?v(a):"function"==typeof n?n.apply(e,i):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=e.__zoom,h="function"==typeof t?t.apply(e,i):t,p=d(u.invert(l).concat(c/u.k),h.invert(l).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=p(e),n=c/t[2];e=new Gs(n,l[0]-t[0]*n,l[1]-t[1]*n)}s.zoom(null,e)}})}function b(e,t,n){return!n&&e.__zooming||new w(e,t)}function w(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function x(e,...t){if(r.apply(this,arguments)){var n=b(this,t).event(e),o=this.__zoom,a=Math.max(l[0],Math.min(l[1],o.k*Math.pow(2,s.apply(this,arguments)))),u=$o(e);if(n.wheel)n.mouse[0][0]===u[0]&&n.mouse[0][1]===u[1]||(n.mouse[1]=o.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(o.k===a)return;n.mouse=[u,o.invert(u)],Cs(this),n.start()}ea(e),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",i(y(g(o,a),n.mouse[0],n.mouse[1]),n.extent,c))}}function C(e,...t){if(!n&&r.apply(this,arguments)){var o=e.currentTarget,s=b(this,t,!0).event(e),a=Lo(e.view).on("mousemove.zoom",function(e){if(ea(e),!s.moved){var t=e.clientX-u,n=e.clientY-d;s.moved=t*t+n*n>p}s.event(e).zoom("mouse",i(y(s.that.__zoom,s.mouse[0]=$o(e,o),s.mouse[1]),s.extent,c))},!0).on("mouseup.zoom",function(e){a.on("mousemove.zoom mouseup.zoom",null),jo(e.view,s.moved),ea(e),s.event(e).end()},!0),l=$o(e,o),u=e.clientX,d=e.clientY;Ho(e.view),Qs(e),s.mouse=[l,this.__zoom.invert(l)],Cs(this),s.start()}}function _(e,...t){if(r.apply(this,arguments)){var n=this.__zoom,s=$o(e.changedTouches?e.changedTouches[0]:e,this),a=n.invert(s),l=n.k*(e.shiftKey?.5:2),d=i(y(g(n,l),s,a),o.apply(this,t),c);ea(e),u>0?Lo(this).transition().duration(u).call(k,d,s,e):Lo(this).call(m.transform,d,s,e)}}function S(n,...o){if(r.apply(this,arguments)){var i,s,a,l,c=n.touches,u=c.length,d=b(this,o,n.changedTouches.length===u).event(n);for(Qs(n),s=0;s<u;++s)l=[l=$o(a=c[s],this),this.__zoom.invert(l),a.identifier],d.touch0?d.touch1||d.touch0[2]===l[2]||(d.touch1=l,d.taps=0):(d.touch0=l,i=!0,d.taps=1+!!e);e&&(e=clearTimeout(e)),i&&(d.taps<2&&(t=l[0],e=setTimeout(function(){e=null},500)),Cs(this),d.start())}}function E(e,...t){if(this.__zooming){var n,r,o,s,a=b(this,t).event(e),l=e.changedTouches,u=l.length;for(ea(e),n=0;n<u;++n)o=$o(r=l[n],this),a.touch0&&a.touch0[2]===r.identifier?a.touch0[0]=o:a.touch1&&a.touch1[2]===r.identifier&&(a.touch1[0]=o);if(r=a.that.__zoom,a.touch1){var d=a.touch0[0],h=a.touch0[1],p=a.touch1[0],f=a.touch1[1],m=(m=p[0]-d[0])*m+(m=p[1]-d[1])*m,v=(v=f[0]-h[0])*v+(v=f[1]-h[1])*v;r=g(r,Math.sqrt(m/v)),o=[(d[0]+p[0])/2,(d[1]+p[1])/2],s=[(h[0]+f[0])/2,(h[1]+f[1])/2]}else{if(!a.touch0)return;o=a.touch0[0],s=a.touch0[1]}a.zoom("touch",i(y(r,o,s),a.extent,c))}}function M(e,...r){if(this.__zooming){var o,i,s=b(this,r).event(e),a=e.changedTouches,l=a.length;for(Qs(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),o=0;o<l;++o)i=a[o],s.touch0&&s.touch0[2]===i.identifier?delete s.touch0:s.touch1&&s.touch1[2]===i.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(i=$o(i,this),Math.hypot(t[0]-i[0],t[1]-i[1])<f)){var c=Lo(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return m.transform=function(e,t,n,r){var o=e.selection?e.selection():e;o.property("__zoom",ra),e!==o?k(e,t,n,r):o.interrupt().each(function(){b(this,arguments).event(r).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},m.scaleBy=function(e,t,n,r){m.scaleTo(e,function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)},n,r)},m.scaleTo=function(e,t,n,r){m.transform(e,function(){var e=o.apply(this,arguments),r=this.__zoom,s=null==n?v(e):"function"==typeof n?n.apply(this,arguments):n,a=r.invert(s),l="function"==typeof t?t.apply(this,arguments):t;return i(y(g(r,l),s,a),e,c)},n,r)},m.translateBy=function(e,t,n,r){m.transform(e,function(){return i(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)},null,r)},m.translateTo=function(e,t,n,r,s){m.transform(e,function(){var e=o.apply(this,arguments),s=this.__zoom,a=null==r?v(e):"function"==typeof r?r.apply(this,arguments):r;return i(Xs.translate(a[0],a[1]).scale(s.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)},r,s)},w.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Lo(this.that).datum();h.call(e,this.that,new Js(e,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:h}),t)}},m.wheelDelta=function(e){return arguments.length?(s="function"==typeof e?e:Us(+e),m):s},m.filter=function(e){return arguments.length?(r="function"==typeof e?e:Us(!!e),m):r},m.touchable=function(e){return arguments.length?(a="function"==typeof e?e:Us(!!e),m):a},m.extent=function(e){return arguments.length?(o="function"==typeof e?e:Us([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):o},m.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],m):[l[0],l[1]]},m.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(e){return arguments.length?(i=e,m):i},m.duration=function(e){return arguments.length?(u=+e,m):u},m.interpolate=function(e){return arguments.length?(d=e,m):d},m.on=function(){var e=h.on.apply(h,arguments);return e===h?m:e},m.clickDistance=function(e){return arguments.length?(p=(e=+e)*e,m):Math.sqrt(p)},m.tapDistance=function(e){return arguments.length?(f=+e,m):f},m}Ys.prototype=Gs.prototype;const la=()=>"Only child nodes can use a parent extent.",ca=(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${"source"===e?n:r}", edge id: ${t}.`,ua=e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,da=()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs.",ha=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],pa=["Enter"," ","Escape"],fa={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var ma,ga,ya,va,ka,ba;(ga=ma||(ma={})).Strict="strict",ga.Loose="loose",(va=ya||(ya={})).Free="free",va.Vertical="vertical",va.Horizontal="horizontal",(ba=ka||(ka={})).Partial="partial",ba.Full="full";const wa={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var xa,Ca,_a,Sa,Ea,Ma;(Ca=xa||(xa={})).Bezier="default",Ca.Straight="straight",Ca.Step="step",Ca.SmoothStep="smoothstep",Ca.SimpleBezier="simplebezier",(Sa=_a||(_a={})).Arrow="arrow",Sa.ArrowClosed="arrowclosed",(Ma=Ea||(Ea={})).Left="left",Ma.Top="top",Ma.Right="right",Ma.Bottom="bottom";const Aa={[Ea.Left]:Ea.Right,[Ea.Right]:Ea.Left,[Ea.Top]:Ea.Bottom,[Ea.Bottom]:Ea.Top};function Da(e,t,n){if(!n)return;const r=[];e.forEach((e,n)=>{t?.has(n)||r.push(e)}),r.length&&n(r)}const Ta=e=>"id"in e&&"source"in e&&"target"in e,Oa=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Na=(e,t=[0,0])=>{const{width:n,height:r}=sl(e),o=e.origin??t,i=n*o[0],s=r*o[1];return{x:e.position.x-i,y:e.position.y-s}},Pa=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},r=!1;return e.forEach(e=>{(void 0===t.filter||t.filter(e))&&(n=ja(n,Za(e)),r=!0)}),r?Ka(n):{x:0,y:0,width:0,height:0}},za=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1)=>{const a={...el(t,[n,r,o]),width:t.width/o,height:t.height/o},l=[];for(const c of e.values()){const{measured:e,selectable:t=!0,hidden:n=!1}=c;if(s&&!t||n)continue;const r=e.width??c.width??c.initialWidth??null,o=e.height??c.height??c.initialHeight??null,u=Ja(a,Wa(c)),d=(r??0)*(o??0),h=i&&u>0;(!c.internals.handleBounds||h||u>=d||c.dragging)&&l.push(c)}return l};async function Ia({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i},s){if(0===e.size)return Promise.resolve(!0);const a=function(e,t){const n=new Map,r=t?.nodes?new Set(t.nodes.map(e=>e.id)):null;return e.forEach(e=>{!e.measured.width||!e.measured.height||!t?.includeHiddenNodes&&e.hidden||r&&!r.has(e.id)||n.set(e.id,e)}),n}(e,s),l=Pa(a),c=rl(l,t,n,s?.minZoom??o,s?.maxZoom??i,s?.padding??.1);return await r.setViewport(c,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function La({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},u=s.origin??r;let d=s.extent||o;if("parent"!==s.extent||s.expandParent)a&&il(s.extent)&&(d=[[s.extent[0][0]+l,s.extent[0][1]+c],[s.extent[1][0]+l,s.extent[1][1]+c]]);else if(a){const e=a.measured.width,t=a.measured.height;e&&t&&(d=[[l,c],[l+e,c+t]])}else i?.("005",la());const h=il(d)?Fa(t,d,s.measured):t;return void 0!==s.measured.width&&void 0!==s.measured.height||i?.("015",da()),{position:{x:h.x-l+(s.measured.width??0)*u[0],y:h.y-c+(s.measured.height??0)*u[1]},positionAbsolute:h}}async function $a({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const i=new Set(e.map(e=>e.id)),s=[];for(const h of n){if(!1===h.deletable)continue;const e=i.has(h.id),t=!e&&h.parentId&&s.find(e=>e.id===h.parentId);(e||t)&&s.push(h)}const a=new Set(t.map(e=>e.id)),l=r.filter(e=>!1!==e.deletable),c=((e,t)=>{const n=new Set;return e.forEach(e=>{n.add(e.id)}),t.filter(e=>n.has(e.source)||n.has(e.target))})(s,l),u=c;for(const h of l){a.has(h.id)&&!u.find(e=>e.id===h.id)&&u.push(h)}if(!o)return{edges:u,nodes:s};const d=await o({nodes:s,edges:u});return"boolean"==typeof d?d?{edges:u,nodes:s}:{edges:[],nodes:[]}:d}const Ra=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Fa=(e={x:0,y:0},t,n)=>({x:Ra(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Ra(e.y,t[0][1],t[1][1]-(n?.height??0))});function Ba(e,t,n){const{width:r,height:o}=sl(n),{x:i,y:s}=n.internals.positionAbsolute;return Fa(e,[[i,s],[i+r,s+o]],t)}const Va=(e,t,n)=>e<t?Ra(Math.abs(e-t),1,t)/t:e>n?-Ra(Math.abs(e-n),1,t)/t:0,Ha=(e,t,n=15,r=40)=>[Va(e.x,r,t.width-r)*n,Va(e.y,r,t.height-r)*n],ja=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),qa=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Ka=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Wa=(e,t=[0,0])=>{const{x:n,y:r}=Oa(e)?e.internals.positionAbsolute:Na(e,t);return{x:n,y:r,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Za=(e,t=[0,0])=>{const{x:n,y:r}=Oa(e)?e.internals.positionAbsolute:Na(e,t);return{x:n,y:r,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:r+(e.measured?.height??e.height??e.initialHeight??0)}},Ua=(e,t)=>Ka(ja(qa(e),qa(t))),Ja=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Ga=e=>Xa(e.width)&&Xa(e.height)&&Xa(e.x)&&Xa(e.y),Xa=e=>!isNaN(e)&&isFinite(e),Ya=(e,t)=>{},Qa=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),el=({x:e,y:t},[n,r,o],i=!1,s=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return i?Qa(a,s):a},tl=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function nl(e,t){if("number"==typeof e)return Math.floor(.5*(t-t/(1+e)));if("string"==typeof e&&e.endsWith("px")){const t=parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if("string"==typeof e&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}const rl=(e,t,n,r,o,i)=>{const s=function(e,t,n){if("string"==typeof e||"number"==typeof e){const r=nl(e,n),o=nl(e,t);return{top:r,right:o,bottom:r,left:o,x:2*o,y:2*r}}if("object"==typeof e){const r=nl(e.top??e.y??0,n),o=nl(e.bottom??e.y??0,n),i=nl(e.left??e.x??0,t),s=nl(e.right??e.x??0,t);return{top:r,right:s,bottom:o,left:i,x:i+s,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(i,t,n),a=(t-s.x)/e.width,l=(n-s.y)/e.height,c=Math.min(a,l),u=Ra(c,r,o),d=t/2-(e.x+e.width/2)*u,h=n/2-(e.y+e.height/2)*u,p=function(e,t,n,r,o,i){const{x:s,y:a}=tl(e,[t,n,r]),{x:l,y:c}=tl({x:e.x+e.width,y:e.y+e.height},[t,n,r]),u=o-l,d=i-c;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(d)}}(e,d,h,u,t,n),f=Math.min(p.left-s.left,0),m=Math.min(p.top-s.top,0);return{x:d-f+Math.min(p.right-s.right,0),y:h-m+Math.min(p.bottom-s.bottom,0),zoom:u}},ol=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0;function il(e){return null!=e&&"parent"!==e}function sl(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function al(e){return void 0!==(e.measured?.width??e.width??e.initialWidth)&&void 0!==(e.measured?.height??e.height??e.initialHeight)}function ll(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:i,y:s}=fl(e),a=el({x:i-(o?.left??0),y:s-(o?.top??0)},r),{x:l,y:c}=n?Qa(a,t):a;return{xSnapped:l,ySnapped:c,...a}}const cl=e=>({width:e.offsetWidth,height:e.offsetHeight}),ul=e=>e?.getRootNode?.()||window?.document,dl=["INPUT","SELECT","TEXTAREA"];function hl(e){const t=e.composedPath?.()?.[0]||e.target;if(1!==t?.nodeType)return!1;return dl.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const pl=e=>"clientX"in e,fl=(e,t)=>{const n=pl(e),r=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:o-(t?.top??0)}},ml=(e,t,n,r,o)=>{const i=t.querySelectorAll(`.${e}`);return i&&i.length?Array.from(i).map(t=>{const i=t.getBoundingClientRect();return{id:t.getAttribute("data-handleid"),type:e,nodeId:o,position:t.getAttribute("data-handlepos"),x:(i.left-n.left)/r,y:(i.top-n.top)/r,...cl(t)}}):null};function gl(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function yl({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case Ea.Left:return[t-gl(t-r,i),n];case Ea.Right:return[t+gl(r-t,i),n];case Ea.Top:return[t,n-gl(n-o,i)];case Ea.Bottom:return[t,n+gl(o-n,i)]}}function vl({sourceX:e,sourceY:t,sourcePosition:n=Ea.Bottom,targetX:r,targetY:o,targetPosition:i=Ea.Top,curvature:s=.25}){const[a,l]=yl({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[c,u]=yl({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[d,h,p,f]=function({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=.125*e+.375*o+.375*s+.125*n,c=.125*t+.375*i+.375*a+.125*r;return[l,c,Math.abs(l-e),Math.abs(c-t)]}({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${a},${l} ${c},${u} ${r},${o}`,d,h,p,f]}function kl({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2;return[i,r<t?r+s:r-s,o,s]}function bl({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r,elevateOnSelect:o=!1}){if(void 0!==r)return r;return(o&&n?1e3:0)+Math.max(e.parentId||o&&e.selected?e.internals.z:0,t.parentId||o&&t.selected?t.internals.z:0)}function wl({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const i=ja(Za(e),Za(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return Ja(s,Ka(i))>0}const xl=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`;function Cl({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=kl({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const _l={[Ea.Left]:{x:-1,y:0},[Ea.Right]:{x:1,y:0},[Ea.Top]:{x:0,y:-1},[Ea.Bottom]:{x:0,y:1}},Sl=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function El({source:e,sourcePosition:t=Ea.Bottom,target:n,targetPosition:r=Ea.Top,center:o,offset:i,stepPosition:s}){const a=_l[t],l=_l[r],c={x:e.x+a.x*i,y:e.y+a.y*i},u={x:n.x+l.x*i,y:n.y+l.y*i},d=(({source:e,sourcePosition:t=Ea.Bottom,target:n})=>t===Ea.Left||t===Ea.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1})({source:c,sourcePosition:t,target:u}),h=0!==d.x?"x":"y",p=d[h];let f,m,g=[];const y={x:0,y:0},v={x:0,y:0},[,,k,b]=kl({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[h]*l[h]===-1){"x"===h?(f=o.x??c.x+(u.x-c.x)*s,m=o.y??(c.y+u.y)/2):(f=o.x??(c.x+u.x)/2,m=o.y??c.y+(u.y-c.y)*s);const e=[{x:f,y:c.y},{x:f,y:u.y}],t=[{x:c.x,y:m},{x:u.x,y:m}];g=a[h]===p?"x"===h?e:t:"x"===h?t:e}else{const o=[{x:c.x,y:u.y}],s=[{x:u.x,y:c.y}];if(g="x"===h?a.x===p?s:o:a.y===p?o:s,t===r){const t=Math.abs(e[h]-n[h]);if(t<=i){const r=Math.min(i-1,i-t);a[h]===p?y[h]=(c[h]>e[h]?-1:1)*r:v[h]=(u[h]>n[h]?-1:1)*r}}if(t!==r){const e="x"===h?"y":"x",t=a[h]===l[e],n=c[e]>u[e],r=c[e]<u[e];(1===a[h]&&(!t&&n||t&&r)||1!==a[h]&&(!t&&r||t&&n))&&(g="x"===h?o:s)}const d={x:c.x+y.x,y:c.y+y.y},k={x:u.x+v.x,y:u.y+v.y};Math.max(Math.abs(d.x-g[0].x),Math.abs(k.x-g[0].x))>=Math.max(Math.abs(d.y-g[0].y),Math.abs(k.y-g[0].y))?(f=(d.x+k.x)/2,m=g[0].y):(f=g[0].x,m=(d.y+k.y)/2)}return[[e,{x:c.x+y.x,y:c.y+y.y},...g,{x:u.x+v.x,y:u.y+v.y},n],f,m,k,b]}function Ml({sourceX:e,sourceY:t,sourcePosition:n=Ea.Bottom,targetX:r,targetY:o,targetPosition:i=Ea.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20,stepPosition:u=.5}){const[d,h,p,f,m]=El({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:l},offset:c,stepPosition:u}),g=d.reduce((e,t,n)=>{let r="";return r=n>0&&n<d.length-1?function(e,t,n,r){const o=Math.min(Sl(e,t)/2,Sl(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s)return`L ${i+o*(e.x<n.x?-1:1)},${s}Q ${i},${s} ${i},${s+o*(e.y<n.y?1:-1)}`;const a=e.x<n.x?1:-1;return`L ${i},${s+o*(e.y<n.y?-1:1)}Q ${i},${s} ${i+o*a},${s}`}(d[n-1],t,d[n+1],s):`${0===n?"M":"L"}${t.x} ${t.y}`,e+=r},"");return[g,h,p,f,m]}function Al(e){return e&&!(!e.internals.handleBounds&&!e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Dl(e){const{sourceNode:t,targetNode:n}=e;if(!Al(t)||!Al(n))return null;const r=t.internals.handleBounds||Tl(t.handles),o=n.internals.handleBounds||Tl(n.handles),i=Nl(r?.source??[],e.sourceHandle),s=Nl(e.connectionMode===ma.Strict?o?.target??[]:(o?.target??[]).concat(o?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",ca(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=i?.position||Ea.Bottom,l=s?.position||Ea.Top,c=Ol(t,i,a),u=Ol(n,s,l);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:l}}function Tl(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,"source"===r.type?t.push(r):"target"===r.type&&n.push(r);return{source:t,target:n}}function Ol(e,t,n=Ea.Left,r=!1){const o=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??sl(e);if(r)return{x:o+s/2,y:i+a/2};switch(t?.position??n){case Ea.Top:return{x:o+s/2,y:i};case Ea.Right:return{x:o+s,y:i+a/2};case Ea.Bottom:return{x:o+s/2,y:i+a};case Ea.Left:return{x:o,y:i+a/2}}}function Nl(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function Pl(e,t){if(!e)return"";if("string"==typeof e)return e;return`${t?`${t}__`:""}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join("&")}`}const zl={nodeOrigin:[0,0],nodeExtent:ha,elevateNodesOnSelect:!0,defaults:{}},Il={...zl,checkEquality:!0};function Ll(e,t){const n={...e};for(const r in t)void 0!==t[r]&&(n[r]=t[r]);return n}function $l(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],r=[];for(const o of e.handles){const t={id:o.id,width:o.width??1,height:o.height??1,nodeId:e.id,x:o.x,y:o.y,position:o.position,type:o.type};"source"===o.type?n.push(t):"target"===o.type&&r.push(t)}return{source:n,target:r}}function Rl(e,t,n,r,o){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:a}=Ll(zl,r),l=e.parentId,c=t.get(l);if(!c)return void console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);!function(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}(e,n),o&&!c.parentId&&void 0===c.internals.rootParentIndex&&(c.internals.rootParentIndex=++o.i,c.internals.z=c.internals.z+10*o.i),o&&void 0!==c.internals.rootParentIndex&&(o.i=c.internals.rootParentIndex);const u=i?1e3:0,{x:d,y:h,z:p}=function(e,t,n,r,o){const{x:i,y:s}=t.internals.positionAbsolute,a=sl(e),l=Na(e,n),c=il(e.extent)?Fa(l,e.extent,a):l;let u=Fa({x:i+c.x,y:s+c.y},r,a);"parent"===e.extent&&(u=Ba(u,a,t));const d=Fl(e,o),h=t.internals.z??0;return{x:u.x,y:u.y,z:h>=d?h+1:d}}(e,c,s,a,u),{positionAbsolute:f}=e.internals,m=d!==f.x||h!==f.y;(m||p!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:m?{x:d,y:h}:f,z:p}})}function Fl(e,t){return(Xa(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Bl(e,t,n,r,o,i){const s=r?.querySelector(".xyflow__viewport");let a=!1;if(!s)return{changes:[],updatedInternals:a};const l=[],c=window.getComputedStyle(s),{m22:u}=new window.DOMMatrixReadOnly(c.transform),d=[];for(const h of e.values()){const e=t.get(h.id);if(!e)continue;if(e.hidden){t.set(e.id,{...e,internals:{...e.internals,handleBounds:void 0}}),a=!0;continue}const r=cl(h.nodeElement),s=e.measured.width!==r.width||e.measured.height!==r.height;if(!(!r.width||!r.height||!s&&e.internals.handleBounds&&!h.force)){const c=h.nodeElement.getBoundingClientRect(),p=il(e.extent)?e.extent:i;let{positionAbsolute:f}=e.internals;e.parentId&&"parent"===e.extent?f=Ba(f,r,t.get(e.parentId)):p&&(f=Fa(f,p,r));const m={...e,measured:r,internals:{...e.internals,positionAbsolute:f,handleBounds:{source:ml("source",h.nodeElement,c,u,e.id),target:ml("target",h.nodeElement,c,u,e.id)}}};t.set(e.id,m),e.parentId&&Rl(m,t,n,{nodeOrigin:o}),a=!0,s&&(l.push({id:e.id,type:"dimensions",dimensions:r}),e.expandParent&&e.parentId&&d.push({id:e.id,parentId:e.parentId,rect:Wa(m,o)}))}}if(d.length>0){const e=function(e,t,n,r=[0,0]){const o=[],i=new Map;for(const s of e){const e=t.get(s.parentId);if(!e)continue;const n=i.get(s.parentId)?.expandedRect??Wa(e),r=Ua(n,s.rect);i.set(s.parentId,{expandedRect:r,parent:e})}return i.size>0&&i.forEach(({expandedRect:t,parent:i},s)=>{const a=i.internals.positionAbsolute,l=sl(i),c=i.origin??r,u=t.x<a.x?Math.round(Math.abs(a.x-t.x)):0,d=t.y<a.y?Math.round(Math.abs(a.y-t.y)):0,h=Math.max(l.width,Math.round(t.width)),p=Math.max(l.height,Math.round(t.height)),f=(h-l.width)*c[0],m=(p-l.height)*c[1];(u>0||d>0||f||m)&&(o.push({id:s,type:"position",position:{x:i.position.x-u+f,y:i.position.y-d+m}}),n.get(s)?.forEach(t=>{e.some(e=>e.id===t.id)||o.push({id:t.id,type:"position",position:{x:t.position.x+u,y:t.position.y+d}})})),(l.width<t.width||l.height<t.height||u||d)&&o.push({id:s,type:"dimensions",setAttributes:!0,dimensions:{width:h+(u?c[0]*u-f:0),height:p+(d?c[1]*d-m:0)}})}),o}(d,t,n,o);l.push(...e)}return{changes:l,updatedInternals:a}}function Vl(e,t,n,r,o,i){let s=o;const a=r.get(s)||new Map;r.set(s,a.set(n,t)),s=`${o}-${e}`;const l=r.get(s)||new Map;if(r.set(s,l.set(n,t)),i){s=`${o}-${e}-${i}`;const a=r.get(s)||new Map;r.set(s,a.set(n,t))}}function Hl(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return!!n&&(!!n.selected||Hl(n,t))}function jl(e,t,n){let r=e;do{if(r?.matches?.(t))return!0;if(r===n)return!1;r=r?.parentElement}while(r);return!1}function ql({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){const o=[];for(const[s,a]of t){const e=n.get(s)?.internals.userNode;e&&o.push({...e,position:a.position,dragging:r})}if(!e)return[o[0],o];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:r}:o[0],o]}function Kl({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},s=0,a=new Map,l=!1,c={x:0,y:0},u=null,d=!1,h=null,p=!1,f=!1,m=null;return{update:function({noDragClassName:g,handleSelector:y,domNode:v,isSelectable:k,nodeId:b,nodeClickDistance:w=0}){function x({x:e,y:n}){const{nodeLookup:o,nodeExtent:s,snapGrid:l,snapToGrid:c,nodeOrigin:u,onNodeDrag:d,onSelectionDrag:h,onError:p,updateNodePositions:g}=t();i={x:e,y:n};let y=!1;const v=a.size>1,k=v&&s?qa(Pa(a)):null,w=v&&c?function({dragItems:e,snapGrid:t,x:n,y:r}){const o=e.values().next().value;if(!o)return null;const i={x:n-o.distance.x,y:r-o.distance.y},s=Qa(i,t);return{x:s.x-i.x,y:s.y-i.y}}({dragItems:a,snapGrid:l,x:e,y:n}):null;for(const[t,r]of a){if(!o.has(t))continue;let i={x:e-r.distance.x,y:n-r.distance.y};c&&(i=w?{x:Math.round(i.x+w.x),y:Math.round(i.y+w.y)}:Qa(i,l));let a=null;if(v&&s&&!r.extent&&k){const{positionAbsolute:e}=r.internals,t=e.x-k.x+s[0][0],n=e.x+r.measured.width-k.x2+s[1][0];a=[[t,e.y-k.y+s[0][1]],[n,e.y+r.measured.height-k.y2+s[1][1]]]}const{position:d,positionAbsolute:h}=La({nodeId:t,nextPosition:i,nodeLookup:o,nodeExtent:a||s,nodeOrigin:u,onError:p});y=y||r.position.x!==d.x||r.position.y!==d.y,r.position=d,r.internals.positionAbsolute=h}if(f=f||y,y&&(g(a,!0),m&&(r||d||!b&&h))){const[e,t]=ql({nodeId:b,dragItems:a,nodeLookup:o});r?.(m,a,e,t),d?.(m,e,t),b||h?.(m,t)}}async function C(){if(!u)return;const{transform:e,panBy:n,autoPanSpeed:r,autoPanOnNodeDrag:o}=t();if(!o)return l=!1,void cancelAnimationFrame(s);const[a,d]=Ha(c,u,r);0===a&&0===d||(i.x=(i.x??0)-a/e[2],i.y=(i.y??0)-d/e[2],await n({x:a,y:d})&&x(i)),s=requestAnimationFrame(C)}function _(r){const{nodeLookup:o,multiSelectionActive:s,nodesDraggable:l,transform:c,snapGrid:h,snapToGrid:p,selectNodesOnDrag:f,onNodeDragStart:m,onSelectionDragStart:g,unselectNodesAndEdges:y}=t();d=!0,f&&k||s||!b||o.get(b)?.selected||y(),k&&f&&b&&e?.(b);const v=ll(r.sourceEvent,{transform:c,snapGrid:h,snapToGrid:p,containerBounds:u});if(i=v,a=function(e,t,n,r){const o=new Map;for(const[i,s]of e)if((s.selected||s.id===r)&&(!s.parentId||!Hl(s,e))&&(s.draggable||t&&void 0===s.draggable)){const t=e.get(i);t&&o.set(i,{id:i,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:t.measured.width??0,height:t.measured.height??0}})}return o}(o,l,v,b),a.size>0&&(n||m||!b&&g)){const[e,t]=ql({nodeId:b,dragItems:a,nodeLookup:o});n?.(r.sourceEvent,a,e,t),m?.(r.sourceEvent,e,t),b||g?.(r.sourceEvent,t)}}h=Lo(v);const S=function(){var e,t,n,r,o=Wo,i=Zo,s=Uo,a=Jo,l={},c=kr("start","drag","end"),u=0,d=0;function h(e){e.on("mousedown.drag",p).filter(a).on("touchstart.drag",g).on("touchmove.drag",y,Ro).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(s,a){if(!r&&o.call(this,s,a)){var l=k(this,i.call(this,s,a),s,a,"mouse");l&&(Lo(s.view).on("mousemove.drag",f,Fo).on("mouseup.drag",m,Fo),Ho(s.view),Bo(s),n=!1,e=s.clientX,t=s.clientY,l("start",s))}}function f(r){if(Vo(r),!n){var o=r.clientX-e,i=r.clientY-t;n=o*o+i*i>d}l.mouse("drag",r)}function m(e){Lo(e.view).on("mousemove.drag mouseup.drag",null),jo(e.view,n),Vo(e),l.mouse("end",e)}function g(e,t){if(o.call(this,e,t)){var n,r,s=e.changedTouches,a=i.call(this,e,t),l=s.length;for(n=0;n<l;++n)(r=k(this,a,e,t,s[n].identifier,s[n]))&&(Bo(e),r("start",e,s[n]))}}function y(e){var t,n,r=e.changedTouches,o=r.length;for(t=0;t<o;++t)(n=l[r[t].identifier])&&(Vo(e),n("drag",e,r[t]))}function v(e){var t,n,o=e.changedTouches,i=o.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),t=0;t<i;++t)(n=l[o[t].identifier])&&(Bo(e),n("end",e,o[t]))}function k(e,t,n,r,o,i){var a,d,p,f=c.copy(),m=$o(i||n,t);if(null!=(p=s.call(e,new Ko("beforestart",{sourceEvent:n,target:h,identifier:o,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:f}),r)))return a=p.x-m[0]||0,d=p.y-m[1]||0,function n(i,s,c){var g,y=m;switch(i){case"start":l[o]=n,g=u++;break;case"end":delete l[o],--u;case"drag":m=$o(c||s,t),g=u}f.call(i,e,new Ko(i,{sourceEvent:s,subject:p,target:h,identifier:o,active:g,x:m[0]+a,y:m[1]+d,dx:m[0]-y[0],dy:m[1]-y[1],dispatch:f}),r)}}return h.filter=function(e){return arguments.length?(o="function"==typeof e?e:qo(!!e),h):o},h.container=function(e){return arguments.length?(i="function"==typeof e?e:qo(e),h):i},h.subject=function(e){return arguments.length?(s="function"==typeof e?e:qo(e),h):s},h.touchable=function(e){return arguments.length?(a="function"==typeof e?e:qo(!!e),h):a},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,h):Math.sqrt(d)},h}().clickDistance(w).on("start",e=>{const{domNode:n,nodeDragThreshold:r,transform:o,snapGrid:s,snapToGrid:a}=t();u=n?.getBoundingClientRect()||null,p=!1,f=!1,m=e.sourceEvent,0===r&&_(e);const l=ll(e.sourceEvent,{transform:o,snapGrid:s,snapToGrid:a,containerBounds:u});i=l,c=fl(e.sourceEvent,u)}).on("drag",e=>{const{autoPanOnNodeDrag:n,transform:r,snapGrid:o,snapToGrid:s,nodeDragThreshold:h,nodeLookup:f}=t(),g=ll(e.sourceEvent,{transform:r,snapGrid:o,snapToGrid:s,containerBounds:u});if(m=e.sourceEvent,("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1||b&&!f.has(b))&&(p=!0),!p){if(!l&&n&&d&&(l=!0,C()),!d){const t=fl(e.sourceEvent,u),n=t.x-c.x,r=t.y-c.y;Math.sqrt(n*n+r*r)>h&&_(e)}(i.x!==g.xSnapped||i.y!==g.ySnapped)&&a&&d&&(c=fl(e.sourceEvent,u),x(g))}}).on("end",e=>{if(d&&!p&&(l=!1,d=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:n,updateNodePositions:r,onNodeDragStop:i,onSelectionDragStop:s}=t();if(f&&(r(a,!1),f=!1),o||i||!b&&s){const[t,r]=ql({nodeId:b,dragItems:a,nodeLookup:n,dragging:!1});o?.(e.sourceEvent,a,t,r),i?.(e.sourceEvent,t,r),b||s?.(e.sourceEvent,r)}}}).filter(e=>{const t=e.target;return!e.button&&(!g||!jl(t,`.${g}`,v))&&(!y||jl(t,y,v))});h.call(S)},destroy:function(){h?.on(".drag",null)}}}function Wl(e,t,n,r){let o=[],i=1/0;const s=function(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:2*n,height:2*n};for(const i of t.values())Ja(o,Wa(i))>0&&r.push(i);return r}(e,n,t+250);for(const a of s){const n=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const s of n){if(r.nodeId===s.nodeId&&r.type===s.type&&r.id===s.id)continue;const{x:n,y:l}=Ol(a,s,s.position,!0),c=Math.sqrt(Math.pow(n-e.x,2)+Math.pow(l-e.y,2));c>t||(c<i?(o=[{...s,x:n,y:l}],i=c):c===i&&o.push({...s,x:n,y:l}))}}if(!o.length)return null;if(o.length>1){const e="source"===r.type?"target":"source";return o.find(t=>t.type===e)??o[0]}return o[0]}function Zl(e,t,n,r,o,i=!1){const s=r.get(e);if(!s)return null;const a="strict"===o?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],l=(n?a?.find(e=>e.id===n):a?.[0])??null;return l&&i?{...l,...Ol(s,l,l.position,!0)}:l}function Ul(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}const Jl=()=>!0;function Gl(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:c=Jl,nodeLookup:u}){const d="target"===i,h=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:f}=fl(e),m=s.elementFromPoint(p,f),g=m?.classList.contains(`${a}-flow__handle`)?m:h,y={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){const e=Ul(void 0,g),t=g.getAttribute("data-nodeid"),i=g.getAttribute("data-handleid"),s=g.classList.contains("connectable"),a=g.classList.contains("connectableend");if(!t||!e)return y;const l={source:d?t:r,sourceHandle:d?i:o,target:d?r:t,targetHandle:d?o:i};y.connection=l;const h=s&&a&&(n===ma.Strict?d&&"source"===e||!d&&"target"===e:t!==r||i!==o);y.isValid=h&&c(l),y.toHandle=Zl(t,e,i,u,n,!0)}return y}const Xl={onPointerDown:function(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:d,panBy:h,cancelConnection:p,onConnectStart:f,onConnect:m,onConnectEnd:g,isValidConnection:y=Jl,onReconnectEnd:v,updateConnection:k,getTransform:b,getFromHandle:w,autoPanSpeed:x,dragThreshold:C=1,handleDomNode:_}){const S=ul(e.target);let E,M=0;const{x:A,y:D}=fl(e),T=Ul(i,_),O=a?.getBoundingClientRect();let N=!1;if(!O||!T)return;const P=Zl(o,T,r,l,t);if(!P)return;let z=fl(e,O),I=!1,L=null,$=!1,R=null;function F(){if(!u||!O)return;const[e,t]=Ha(z,O,x);h({x:e,y:t}),M=requestAnimationFrame(F)}const B={...P,nodeId:o,type:T,position:P.position},V=l.get(o);let H={inProgress:!0,isValid:null,from:Ol(V,B,Ea.Left,!0),fromHandle:B,fromPosition:B.position,fromNode:V,to:z,toHandle:null,toPosition:Aa[B.position],toNode:null};function j(){N=!0,k(H),f?.(e,{nodeId:o,handleId:r,handleType:T})}function q(e){if(!N){const{x:t,y:n}=fl(e),r=t-A,o=n-D;if(!(r*r+o*o>C*C))return;j()}if(!w()||!B)return void K(e);const i=b();z=fl(e,O),E=Wl(el(z,i,!1,[1,1]),n,l,B),I||(F(),I=!0);const a=Gl(e,{handle:E,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:s?"target":"source",isValidConnection:y,doc:S,lib:c,flowId:d,nodeLookup:l});R=a.handleDomNode,L=a.connection,$=function(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}(!!E,a.isValid);const u={...H,isValid:$,to:a.toHandle&&$?tl({x:a.toHandle.x,y:a.toHandle.y},i):z,toHandle:a.toHandle,toPosition:$&&a.toHandle?a.toHandle.position:Aa[B.position],toNode:a.toHandle?l.get(a.toHandle.nodeId):null};$&&E&&H.toHandle&&u.toHandle&&H.toHandle.type===u.toHandle.type&&H.toHandle.nodeId===u.toHandle.nodeId&&H.toHandle.id===u.toHandle.id&&H.to.x===u.to.x&&H.to.y===u.to.y||(k(u),H=u)}function K(e){if(!("touches"in e&&e.touches.length>0)){if(N){(E||R)&&L&&$&&m?.(L);const{inProgress:t,...n}=H,r={...n,toPosition:H.toHandle?H.toPosition:null};g?.(e,r),i&&v?.(e,r)}p(),cancelAnimationFrame(M),I=!1,$=!1,L=null,R=null,S.removeEventListener("mousemove",q),S.removeEventListener("mouseup",K),S.removeEventListener("touchmove",q),S.removeEventListener("touchend",K)}}0===C&&j(),S.addEventListener("mousemove",q),S.addEventListener("mouseup",K),S.addEventListener("touchmove",q),S.addEventListener("touchend",K)},isValid:Gl};const Yl=e=>({x:e.x,y:e.y,zoom:e.k}),Ql=({x:e,y:t,zoom:n})=>Xs.translate(e,t).scale(n),ec=(e,t)=>e.target.closest(`.${t}`),tc=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),nc=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,rc=(e,t=0,n=nc,r=()=>{})=>{const o="number"==typeof t&&t>0;return o||r(),o?e.transition().duration(t).ease(n).on("end",r):e},oc=e=>{const t=e.ctrlKey&&ol()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t};function ic({domNode:e,minZoom:t,maxZoom:n,translateExtent:r,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:a,onDraggingChange:l}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),d=aa().scaleExtent([t,n]).translateExtent(r),h=Lo(e).call(d);y({x:o.x,y:o.y,zoom:Ra(o.zoom,t,n)},[[0,0],[u.width,u.height]],r);const p=h.on("wheel.zoom"),f=h.on("dblclick.zoom");function m(e,t){return h?new Promise(n=>{d?.interpolate("linear"===t?.interpolate?Hi:Xi).transform(rc(h,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function g(){d.on("zoom",null)}async function y(e,t,n){const r=Ql(e),o=d?.constrain()(r,t,n);return o&&await m(o),new Promise(e=>e(o))}return d.wheelDelta(oc),{update:function({noWheelClassName:e,noPanClassName:t,onPaneContextMenu:n,userSelectionActive:r,panOnScroll:o,panOnDrag:u,panOnScrollMode:m,panOnScrollSpeed:y,preventScrolling:v,zoomOnPinch:k,zoomOnScroll:b,zoomOnDoubleClick:w,zoomActivationKeyPressed:x,lib:C,onTransformChange:_,connectionInProgress:S,paneClickDistance:E,selectionOnDrag:M}){r&&!c.isZoomingOrPanning&&g();const A=o&&!x&&!r;d.clickDistance(M?1/0:!Xa(E)||E<0?0:E);const D=A?function({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(ec(u,t))return u.ctrlKey&&u.preventDefault(),!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&s){const e=$o(u),t=oc(u),o=d*Math.pow(2,t);return void r.scaleTo(n,o,e,u)}const h=1===u.deltaMode?20:1;let p=o===ya.Vertical?0:u.deltaX*h,f=o===ya.Horizontal?0:u.deltaY*h;!ol()&&u.shiftKey&&o!==ya.Vertical&&(p=u.deltaY*h,f=0),r.translateBy(n,-p/d*i,-f/d*i,{internal:!0});const m=Yl(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(l?.(u,m),e.panScrollTimeout=setTimeout(()=>{c?.(u,m),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,a?.(u,m))}}({zoomPanValues:c,noWheelClassName:e,d3Selection:h,d3Zoom:d,panOnScrollMode:m,panOnScrollSpeed:y,zoomOnPinch:k,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:a}):function({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const i="wheel"===r.type,s=!t&&i&&!r.ctrlKey,a=ec(r,e);if(r.ctrlKey&&i&&a&&r.preventDefault(),s||a)return null;r.preventDefault(),n.call(this,r,o)}}({noWheelClassName:e,preventScrolling:v,d3ZoomHandler:p});if(h.on("wheel.zoom",D,{passive:!1}),!r){const e=function({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{if(r.sourceEvent?.internal)return;const o=Yl(r.transform);e.mouseButton=r.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=o,"mousedown"===r.sourceEvent?.type&&t(!0),n&&n?.(r.sourceEvent,o)}}({zoomPanValues:c,onDraggingChange:l,onPanZoomStart:s});d.on("start",e);const t=function({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{e.usedRightMouseButton=!(!n||!tc(t,e.mouseButton??0)),i.sourceEvent?.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!i.sourceEvent?.internal&&o?.(i.sourceEvent,Yl(i.transform))}}({zoomPanValues:c,panOnDrag:u,onPaneContextMenu:!!n,onPanZoom:i,onTransformChange:_});d.on("zoom",t);const r=function({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&tc(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,r(!1),o)){const t=Yl(s.transform);e.prevViewport=t,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o?.(s.sourceEvent,t)},n?150:0)}}}({zoomPanValues:c,panOnDrag:u,panOnScroll:o,onPaneContextMenu:n,onPanZoomEnd:a,onDraggingChange:l});d.on("end",r)}const T=function({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:c,connectionInProgress:u}){return d=>{const h=e||t,p=n&&d.ctrlKey,f="wheel"===d.type;if(1===d.button&&"mousedown"===d.type&&(ec(d,`${c}-flow__node`)||ec(d,`${c}-flow__edge`)))return!0;if(!(r||h||o||i||n))return!1;if(s)return!1;if(u&&!f)return!1;if(ec(d,a)&&f)return!1;if(ec(d,l)&&(!f||o&&f&&!e))return!1;if(!n&&d.ctrlKey&&f)return!1;if(!n&&"touchstart"===d.type&&d.touches?.length>1)return d.preventDefault(),!1;if(!h&&!o&&!p&&f)return!1;if(!r&&("mousedown"===d.type||"touchstart"===d.type))return!1;if(Array.isArray(r)&&!r.includes(d.button)&&"mousedown"===d.type)return!1;const m=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||f)&&m}}({zoomActivationKeyPressed:x,panOnDrag:u,zoomOnScroll:b,panOnScroll:o,zoomOnDoubleClick:w,zoomOnPinch:k,userSelectionActive:r,noPanClassName:t,noWheelClassName:e,lib:C,connectionInProgress:S});d.filter(T),w?h.on("dblclick.zoom",f):h.on("dblclick.zoom",null)},destroy:g,setViewport:async function(e,t){const n=Ql(e);return await m(n,t),new Promise(e=>e(n))},setViewportConstrained:y,getViewport:function(){const e=h?Ys(h.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,t){return h?new Promise(n=>{d?.interpolate("linear"===t?.interpolate?Hi:Xi).scaleTo(rc(h,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)},scaleBy:function(e,t){return h?new Promise(n=>{d?.interpolate("linear"===t?.interpolate?Hi:Xi).scaleBy(rc(h,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)},setScaleExtent:function(e){d?.scaleExtent(e)},setTranslateExtent:function(e){d?.translateExtent(e)},syncViewport:function(e){if(h){const t=Ql(e),n=h.property("__zoom");n.k===e.zoom&&n.x===e.x&&n.y===e.y||d?.transform(h,t,null,{sync:!0})}},setClickDistance:function(e){const t=!Xa(e)||e<0?0:e;d?.clickDistance(t)}}}var sc,ac;(ac=sc||(sc={})).Line="line",ac.Handle="handle";var lc=cn("<div><!></div>");function cc(e,t){X(t,!0);let n=yr(t,"id",3,null),r=yr(t,"type",3,"source"),o=yr(t,"position",19,()=>Ea.Top),i=yr(t,"isConnectableStart",3,!0),s=yr(t,"isConnectableEnd",3,!0),a=fr(t,["$$slots","$$events","$$legacy","id","type","position","style","class","isConnectable","isConnectableStart","isConnectableEnd","isValidConnection","onconnect","ondisconnect","children"]);const l=J("svelteflow__node_id"),c=J("svelteflow__node_connectable");let u=xe(()=>"target"===r()),d=xe(()=>void 0!==t.isConnectable?t.isConnectable:c.value),h=Pc(),f=xe(()=>h.ariaLabelConfig),m=null;tt(()=>{if(t.onconnect||t.ondisconnect){h.edges;let e=h.connectionLookup.get(`${l}-${r()}${n()?`-${n()}`:""}`);if(m&&!function(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}(e,m)){const n=e??new Map;Da(m,n,t.ondisconnect),Da(n,m,t.onconnect)}m=new Map(e)}});let g=xe(()=>{if(!h.connection.inProgress)return[!1,!1,!1,!1,null];const{fromHandle:e,toHandle:t,isValid:o}=h.connection,i=e&&e.nodeId===l&&e.type===r()&&e.id===n(),s=t&&t.nodeId===l&&t.type===r()&&t.id===n();return[!0,i,s,h.connectionMode===ma.Strict?e?.type!==r():l!==e?.nodeId||n()!==e?.id,s&&o]}),y=xe(()=>v(Kt(g),5)),k=xe(()=>Kt(y)[0]),b=xe(()=>Kt(y)[1]),w=xe(()=>Kt(y)[2]),x=xe(()=>Kt(y)[3]),C=xe(()=>Kt(y)[4]);function _(e){const t=h.onbeforeconnect?h.onbeforeconnect(e):e;t&&(h.addEdge(t),h.onconnect?.(e))}function S(e){const r=pl(e);e.currentTarget&&(r&&0===e.button||!r)&&Xl.onPointerDown(e,{handleId:n(),nodeId:l,isTarget:Kt(u),connectionRadius:h.connectionRadius,domNode:h.domNode,nodeLookup:h.nodeLookup,connectionMode:h.connectionMode,lib:"svelte",autoPanOnConnect:h.autoPanOnConnect,autoPanSpeed:h.autoPanSpeed,flowId:h.flowId,isValidConnection:t.isValidConnection??h.isValidConnection,updateConnection:h.updateConnection,cancelConnection:h.cancelConnection,panBy:h.panBy,onConnect:_,onConnectStart:(e,t)=>{h.onconnectstart?.(e,{nodeId:t.nodeId,handleId:t.handleId,handleType:t.handleType})},onConnectEnd:(e,t)=>{h.onconnectend?.(e,t)},getTransform:()=>[h.viewport.x,h.viewport.y,h.viewport.zoom],getFromHandle:()=>h.connection.fromHandle,dragThreshold:h.connectionDragThreshold,handleDomNode:e.currentTarget})}function E(e){if(!l||!h.clickConnectStartHandle&&!i())return;if(!h.clickConnectStartHandle)return h.onclickconnectstart?.(e,{nodeId:l,handleId:n(),handleType:r()}),void(h.clickConnectStartHandle={nodeId:l,type:r(),id:n()});const o=ul(e.target),s=t.isValidConnection??h.isValidConnection,{connectionMode:a,clickConnectStartHandle:c,flowId:u,nodeLookup:d}=h,{connection:p,isValid:f}=Xl.isValid(e,{handle:{nodeId:l,id:n(),type:r()},connectionMode:a,fromNodeId:c.nodeId,fromHandleId:c.id??null,fromType:c.type,isValidConnection:s,flowId:u,doc:o,lib:"svelte",nodeLookup:d});f&&p&&_(p);const m=structuredClone(K(h.connection));delete m.inProgress,m.toPosition=m.toHandle?m.toHandle.position:null,h.onclickconnectend?.(e,m),h.clickConnectStartHandle=null}var M=lc(),A=()=>{};Gn(M,()=>({"data-handleid":n(),"data-nodeid":l,"data-handlepos":o(),"data-id":`${h.flowId??""}-${l??""}-${n()??"null"??""}-${r()??""}`,class:["svelte-flow__handle",`svelte-flow__handle-${o()}`,h.noDragClass,h.noPanClass,o(),t.class],onmousedown:S,ontouchstart:S,onclick:h.clickConnect?E:void 0,onkeypress:A,style:t.style,role:"button","aria-label":Kt(f)["handle.ariaLabel"],tabindex:"-1",...a,[qn]:{valid:Kt(C),connectingto:Kt(w),connectingfrom:Kt(b),source:!Kt(u),target:Kt(u),connectablestart:i(),connectableend:s(),connectable:Kt(d),connectionindicator:Kt(d)&&(!Kt(k)||Kt(x))&&(Kt(k)||h.clickConnectStartHandle?s():i())}})),wn(Ke(M),()=>t.children??p),pn(e,M),Y()}var uc=cn("<!> <!>",1);function dc(e,t){X(t,!0);let n=yr(t,"targetPosition",19,()=>Ea.Top),r=yr(t,"sourcePosition",19,()=>Ea.Bottom);var o=uc(),i=We(o);cc(i,{type:"target",get position(){return n()}});var s=Ze(i);cc(Ze(s),{type:"source",get position(){return r()}}),it(()=>kn(s,` ${t.data?.label??""} `)),pn(e,o),Y()}var hc=cn(" <!>",1);var pc=cn(" <!>",1);function fc(e,t,n){if(!n||!t)return;const r="root"===n?t:t.querySelector(`.svelte-flow__${n}`);r&&r.appendChild(e)}function mc(){let e=Oe("undefined"==typeof window);if(Kt(e)){const t=nt(()=>{Qe(()=>{Pe(e,!1),t?.()})})}return{get value(){return Kt(e)}}}const gc=e=>(e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e))(e);function yc(e){return void 0===e?void 0:`${e}px`}const vc={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var kc=cn("<div><!></div>");function bc(e,t){X(t,!0);let n=yr(t,"x",3,0),r=yr(t,"y",3,0),o=yr(t,"selectEdgeOnClick",3,!1),i=yr(t,"transparent",3,!1),s=fr(t,["$$slots","$$events","$$legacy","x","y","width","height","selectEdgeOnClick","transparent","class","children"]);const a=Pc(),l=J("svelteflow__edge_id");if(!l)throw new Error("EdgeLabel must be used within an edge");let c=xe(()=>a.visible.edges.get(l)?.zIndex);var u=kc(),d=()=>{o()&&a.handleEdgeSelection(l)};Gn(u,e=>({class:["svelte-flow__edge-label",{transparent:i()},t.class],tabindex:"-1",onclick:d,...s,[Kn]:e}),[()=>({display:mc().value?"none":void 0,cursor:o()?"pointer":void 0,transform:`translate(-50%, -50%) translate(${n()??""}px,${r()??""}px)`,"pointer-events":"all",width:yc(t.width),height:yc(t.height),"z-index":Kt(c)})],void 0,void 0,"svelte-1wg91mu"),wn(Ke(u),()=>t.children??p),Nn(u,(e,t)=>function(e,t){const n=xe(Pc),r=xe(()=>Kt(n).domNode);let o;return Kt(r)?fc(e,Kt(r),t):o=nt(()=>{Qe(()=>{fc(e,Kt(r),t),o?.()})}),{async update(t){fc(e,Kt(r),t)},destroy(){e.parentNode&&e.parentNode.removeChild(e),o?.()}}}?.(e,t),()=>"edge-labels"),pn(e,u),Y()}var wc=dn("<path></path>"),xc=dn('<path fill="none"></path><!><!>',1);function Cc(e,t){let n=yr(t,"interactionWidth",3,20),r=fr(t,["$$slots","$$events","$$legacy","id","path","label","labelX","labelY","labelStyle","markerStart","markerEnd","style","interactionWidth","class"]);var o=xc(),i=We(o),s=Ze(i),a=e=>{var o=wc();Gn(o,()=>({d:t.path,"stroke-opacity":0,"stroke-width":n(),fill:"none",class:"svelte-flow__edge-interaction",...r})),pn(e,o)};_n(s,e=>{n()>0&&e(a)});var l=Ze(s),c=e=>{bc(e,{get x(){return t.labelX},get y(){return t.labelY},get style(){return t.labelStyle},selectEdgeOnClick:!0,children:(e,n)=>{var r=function(e=""){var t=He(e+"");return ln(t,t),t}();it(()=>kn(r,t.label)),pn(e,r)},$$slots:{default:!0}})};_n(l,e=>{t.label&&e(c)}),it(()=>{Jn(i,"id",t.id),Jn(i,"d",t.path),Fn(i,0,In(["svelte-flow__edge-path",t.class])),Jn(i,"marker-start",t.markerStart),Jn(i,"marker-end",t.markerEnd),Vn(i,t.style)}),pn(e,o)}function _c(e,t){X(t,!0);let n=xe(()=>vl({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY,sourcePosition:t.sourcePosition,targetPosition:t.targetPosition,curvature:t.pathOptions?.curvature})),r=xe(()=>v(Kt(n),3)),o=xe(()=>Kt(r)[0]),i=xe(()=>Kt(r)[1]),s=xe(()=>Kt(r)[2]);Cc(e,{get id(){return t.id},get path(){return Kt(o)},get labelX(){return Kt(i)},get labelY(){return Kt(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),Y()}class Sc{#b;#w;constructor(e,t){this.#b=e,this.#w=ye(t)}get current(){return this.#w(),this.#b()}}const Ec=/\(.+\)/,Mc=new Set(["all","print","screen","and","or","not","only"]);class Ac extends Sc{constructor(e,t){let n=Ec.test(e)||e.split(/[\s,]+/).some(e=>Mc.has(e.trim()))?e:`(${e})`;const r=window.matchMedia(n);super(()=>r.matches,e=>tn(r,"change",e))}}function Dc(e){const{edges:t,defaultEdgeOptions:n,nodeLookup:r,previousEdges:o,connectionMode:i,onerror:s,onlyRenderVisible:a,elevateEdgesOnSelect:l}=e,c=new Map;for(const u of t){const t=r.get(u.source),d=r.get(u.target);if(!t||!d)continue;if(a){const{visibleNodes:n,transform:r,width:o,height:i}=e;if(!wl({sourceNode:t,targetNode:d,width:o,height:i,transform:r}))continue;n.set(t.id,t),n.set(d.id,d)}const h=o.get(u.id);if(h&&u===h.edge&&t==h.sourceNode&&d==h.targetNode){c.set(u.id,h);continue}const p=Dl({id:u.id,sourceNode:t,targetNode:d,sourceHandle:u.sourceHandle||null,targetHandle:u.targetHandle||null,connectionMode:i,onError:s});p&&c.set(u.id,{...n,...u,...p,zIndex:bl({selected:u.selected,zIndex:u.zIndex??n.zIndex,sourceNode:t,targetNode:d,elevateOnSelect:l}),sourceNode:t,targetNode:d,edge:u})}return c}const Tc={input:function(e,t){X(t,!0);let n=yr(t,"data",19,()=>({label:"Node"})),r=yr(t,"sourcePosition",19,()=>Ea.Bottom);var o=hc(),i=We(o);cc(Ze(i),{type:"source",get position(){return r()}}),it(()=>kn(i,`${n()?.label??""} `)),pn(e,o),Y()},output:function(e,t){X(t,!0);let n=yr(t,"data",19,()=>({label:"Node"})),r=yr(t,"targetPosition",19,()=>Ea.Top);var o=pc(),i=We(o);cc(Ze(i),{type:"target",get position(){return r()}}),it(()=>kn(i,`${n()?.label??""} `)),pn(e,o),Y()},default:dc,group:function(e,t){}},Oc={straight:function(e,t){X(t,!0);let n=xe(()=>Cl({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY})),r=xe(()=>v(Kt(n),3)),o=xe(()=>Kt(r)[0]),i=xe(()=>Kt(r)[1]),s=xe(()=>Kt(r)[2]);Cc(e,{get path(){return Kt(o)},get labelX(){return Kt(i)},get labelY(){return Kt(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),Y()},smoothstep:function(e,t){X(t,!0);let n=xe(()=>Ml({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY,sourcePosition:t.sourcePosition,targetPosition:t.targetPosition})),r=xe(()=>v(Kt(n),3)),o=xe(()=>Kt(r)[0]),i=xe(()=>Kt(r)[1]),s=xe(()=>Kt(r)[2]);Cc(e,{get path(){return Kt(o)},get labelX(){return Kt(i)},get labelY(){return Kt(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),Y()},default:_c,step:function(e,t){X(t,!0);let n=xe(()=>Ml({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY,sourcePosition:t.sourcePosition,targetPosition:t.targetPosition,borderRadius:0})),r=xe(()=>v(Kt(n),3)),o=xe(()=>Kt(r)[0]),i=xe(()=>Kt(r)[1]),s=xe(()=>Kt(r)[2]);Cc(e,{get path(){return Kt(o)},get labelX(){return Kt(i)},get labelY(){return Kt(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),Y()}};function Nc(e){return new class{#x=xe(()=>e.props.id??"1");get flowId(){return Kt(this.#x)}set flowId(e){Pe(this.#x,e)}#C=Oe(null);get domNode(){return Kt(this.#C)}set domNode(e){Pe(this.#C,e)}#_=Oe(null);get panZoom(){return Kt(this.#_)}set panZoom(e){Pe(this.#_,e)}#S=Oe(e.width??0);get width(){return Kt(this.#S)}set width(e){Pe(this.#S,e)}#E=Oe(e.height??0);get height(){return Kt(this.#E)}set height(e){Pe(this.#E,e)}#M=xe(()=>{const t=function(e,t,n,r){const o=Ll(Il,r);let i={i:-1},s=e.length>0;const a=new Map(t),l=o?.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const c of e){let e=a.get(c.id);if(o.checkEquality&&c===e?.internals.userNode)t.set(c.id,e);else{const n=Na(c,o.nodeOrigin),r=il(c.extent)?c.extent:o.nodeExtent,i=Fa(n,r,sl(c));e={...o.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:i,handleBounds:$l(c,e),z:Fl(c,l),userNode:c}},t.set(c.id,e)}void 0!==e.measured&&void 0!==e.measured.width&&void 0!==e.measured.height||e.hidden||(s=!1),c.parentId&&Rl(e,t,n,r,i)}return s}(e.nodes,this.nodeLookup,this.parentLookup,{nodeExtent:this.nodeExtent,nodeOrigin:this.nodeOrigin,elevateNodesOnSelect:e.props.elevateNodesOnSelect??!0,checkEquality:!0});return this.fitViewQueued&&t&&(this.fitViewOptions?.duration?this.resolveFitView():queueMicrotask(()=>{this.resolveFitView()})),t});get nodesInitialized(){return Kt(this.#M)}set nodesInitialized(e){Pe(this.#M,e)}#A=xe(()=>null!==this.panZoom);get viewportInitialized(){return Kt(this.#A)}set viewportInitialized(e){Pe(this.#A,e)}#D=xe(()=>(function(e,t,n){e.clear(),t.clear();for(const r of n){const{source:n,target:o,sourceHandle:i=null,targetHandle:s=null}=r,a={edgeId:r.id,source:n,target:o,sourceHandle:i,targetHandle:s},l=`${n}-${i}--${o}-${s}`;Vl("source",a,`${o}-${s}--${n}-${i}`,e,n,i),Vl("target",a,l,e,o,s),t.set(r.id,r)}}(this.connectionLookup,this.edgeLookup,e.edges),e.edges));get _edges(){return Kt(this.#D)}set _edges(e){Pe(this.#D,e)}get nodes(){return this.nodesInitialized,e.nodes}set nodes(t){e.nodes=t}get edges(){return this._edges}set edges(t){e.edges=t}_prevSelectedNodes=[];_prevSelectedNodeIds=new Set;#T=xe(()=>{const e=this._prevSelectedNodeIds.size,t=new Set,n=this.nodes.filter(e=>(e.selected&&(t.add(e.id),this._prevSelectedNodeIds.delete(e.id)),e.selected));return(e!==t.size||this._prevSelectedNodeIds.size>0)&&(this._prevSelectedNodes=n),this._prevSelectedNodeIds=t,this._prevSelectedNodes});get selectedNodes(){return Kt(this.#T)}set selectedNodes(e){Pe(this.#T,e)}_prevSelectedEdges=[];_prevSelectedEdgeIds=new Set;#O=xe(()=>{const e=this._prevSelectedEdgeIds.size,t=new Set,n=this.edges.filter(e=>(e.selected&&(t.add(e.id),this._prevSelectedEdgeIds.delete(e.id)),e.selected));return(e!==t.size||this._prevSelectedEdgeIds.size>0)&&(this._prevSelectedEdges=n),this._prevSelectedEdgeIds=t,this._prevSelectedEdges});get selectedEdges(){return Kt(this.#O)}set selectedEdges(e){Pe(this.#O,e)}selectionChangeHandlers=new Map;nodeLookup=new Map;parentLookup=new Map;connectionLookup=new Map;edgeLookup=new Map;_prevVisibleEdges=new Map;#N=xe(()=>{const{nodes:t,_edges:n,_prevVisibleEdges:r,nodeLookup:o,connectionMode:i,onerror:s,onlyRenderVisibleElements:a,defaultEdgeOptions:l}=this;let c,u;const d={edges:n,defaultEdgeOptions:l,previousEdges:r,nodeLookup:o,connectionMode:i,elevateEdgesOnSelect:e.props.elevateEdgesOnSelect??!0,onerror:s};if(a){const{viewport:e,width:t,height:n}=this,r=[e.x,e.y,e.zoom];c=function(e,t,n,r){const o=new Map;return za(e,{x:0,y:0,width:n,height:r},t,!0).forEach(e=>{o.set(e.id,e)}),o}(o,r,t,n),u=Dc({...d,onlyRenderVisible:!0,visibleNodes:c,transform:r,width:t,height:n})}else c=this.nodeLookup,u=Dc(d);return{nodes:c,edges:u}});get visible(){return Kt(this.#N)}set visible(e){Pe(this.#N,e)}#P=xe(()=>e.props.nodesDraggable??!0);get nodesDraggable(){return Kt(this.#P)}set nodesDraggable(e){Pe(this.#P,e)}#z=xe(()=>e.props.nodesConnectable??!0);get nodesConnectable(){return Kt(this.#z)}set nodesConnectable(e){Pe(this.#z,e)}#I=xe(()=>e.props.elementsSelectable??!0);get elementsSelectable(){return Kt(this.#I)}set elementsSelectable(e){Pe(this.#I,e)}#L=xe(()=>e.props.nodesFocusable??!0);get nodesFocusable(){return Kt(this.#L)}set nodesFocusable(e){Pe(this.#L,e)}#$=xe(()=>e.props.edgesFocusable??!0);get edgesFocusable(){return Kt(this.#$)}set edgesFocusable(e){Pe(this.#$,e)}#R=xe(()=>e.props.disableKeyboardA11y??!1);get disableKeyboardA11y(){return Kt(this.#R)}set disableKeyboardA11y(e){Pe(this.#R,e)}#F=xe(()=>e.props.minZoom??.5);get minZoom(){return Kt(this.#F)}set minZoom(e){Pe(this.#F,e)}#B=xe(()=>e.props.maxZoom??2);get maxZoom(){return Kt(this.#B)}set maxZoom(e){Pe(this.#B,e)}#V=xe(()=>e.props.nodeOrigin??[0,0]);get nodeOrigin(){return Kt(this.#V)}set nodeOrigin(e){Pe(this.#V,e)}#H=xe(()=>e.props.nodeExtent??ha);get nodeExtent(){return Kt(this.#H)}set nodeExtent(e){Pe(this.#H,e)}#j=xe(()=>e.props.translateExtent??ha);get translateExtent(){return Kt(this.#j)}set translateExtent(e){Pe(this.#j,e)}#q=xe(()=>e.props.defaultEdgeOptions??{});get defaultEdgeOptions(){return Kt(this.#q)}set defaultEdgeOptions(e){Pe(this.#q,e)}#K=xe(()=>e.props.nodeDragThreshold??1);get nodeDragThreshold(){return Kt(this.#K)}set nodeDragThreshold(e){Pe(this.#K,e)}#W=xe(()=>e.props.autoPanOnNodeDrag??!0);get autoPanOnNodeDrag(){return Kt(this.#W)}set autoPanOnNodeDrag(e){Pe(this.#W,e)}#Z=xe(()=>e.props.autoPanOnConnect??!0);get autoPanOnConnect(){return Kt(this.#Z)}set autoPanOnConnect(e){Pe(this.#Z,e)}#U=xe(()=>e.props.autoPanOnNodeFocus??!0);get autoPanOnNodeFocus(){return Kt(this.#U)}set autoPanOnNodeFocus(e){Pe(this.#U,e)}#J=xe(()=>e.props.autoPanSpeed??15);get autoPanSpeed(){return Kt(this.#J)}set autoPanSpeed(e){Pe(this.#J,e)}#G=xe(()=>e.props.connectionDragThreshold??1);get connectionDragThreshold(){return Kt(this.#G)}set connectionDragThreshold(e){Pe(this.#G,e)}fitViewQueued=e.props.fitView??!1;fitViewOptions=e.props.fitViewOptions;fitViewResolver=null;#X=xe(()=>e.props.snapGrid??null);get snapGrid(){return Kt(this.#X)}set snapGrid(e){Pe(this.#X,e)}#Y=Oe(!1);get dragging(){return Kt(this.#Y)}set dragging(e){Pe(this.#Y,e)}#Q=Oe(null);get selectionRect(){return Kt(this.#Q)}set selectionRect(e){Pe(this.#Q,e)}#ee=Oe(!1);get selectionKeyPressed(){return Kt(this.#ee)}set selectionKeyPressed(e){Pe(this.#ee,e)}#te=Oe(!1);get multiselectionKeyPressed(){return Kt(this.#te)}set multiselectionKeyPressed(e){Pe(this.#te,e)}#ne=Oe(!1);get deleteKeyPressed(){return Kt(this.#ne)}set deleteKeyPressed(e){Pe(this.#ne,e)}#re=Oe(!1);get panActivationKeyPressed(){return Kt(this.#re)}set panActivationKeyPressed(e){Pe(this.#re,e)}#oe=Oe(!1);get zoomActivationKeyPressed(){return Kt(this.#oe)}set zoomActivationKeyPressed(e){Pe(this.#oe,e)}#ie=Oe(null);get selectionRectMode(){return Kt(this.#ie)}set selectionRectMode(e){Pe(this.#ie,e)}#se=Oe("");get ariaLiveMessage(){return Kt(this.#se)}set ariaLiveMessage(e){Pe(this.#se,e)}#ae=xe(()=>e.props.selectionMode??ka.Partial);get selectionMode(){return Kt(this.#ae)}set selectionMode(e){Pe(this.#ae,e)}#le=xe(()=>({...Tc,...e.props.nodeTypes}));get nodeTypes(){return Kt(this.#le)}set nodeTypes(e){Pe(this.#le,e)}#ce=xe(()=>({...Oc,...e.props.edgeTypes}));get edgeTypes(){return Kt(this.#ce)}set edgeTypes(e){Pe(this.#ce,e)}#ue=xe(()=>e.props.noPanClass??"nopan");get noPanClass(){return Kt(this.#ue)}set noPanClass(e){Pe(this.#ue,e)}#de=xe(()=>e.props.noDragClass??"nodrag");get noDragClass(){return Kt(this.#de)}set noDragClass(e){Pe(this.#de,e)}#he=xe(()=>e.props.noWheelClass??"nowheel");get noWheelClass(){return Kt(this.#he)}set noWheelClass(e){Pe(this.#he,e)}#pe=xe(()=>{return t=e.props.ariaLabelConfig,{...fa,...t||{}};var t});get ariaLabelConfig(){return Kt(this.#pe)}set ariaLabelConfig(e){Pe(this.#pe,e)}#fe=Oe(function(e,t,n,r,o,i){if(t&&!n&&r&&o){const e=Pa(i,{filter:e=>!(!e.width&&!e.initialWidth||!e.height&&!e.initialHeight)});return rl(e,r,o,.5,2,.1)}return n??{x:0,y:0,zoom:1}}(this.nodesInitialized,e.props.fitView,e.props.initialViewport,this.width,this.height,this.nodeLookup));get _viewport(){return Kt(this.#fe)}set _viewport(e){Pe(this.#fe,e)}get viewport(){return e.viewport??this._viewport}set viewport(t){e.viewport&&(e.viewport=t),this._viewport=t}#me=Oe(wa);get _connection(){return Kt(this.#me)}set _connection(e){Pe(this.#me,e)}#ge=xe(()=>this._connection.inProgress?{...this._connection,to:el(this._connection.to,[this.viewport.x,this.viewport.y,this.viewport.zoom])}:this._connection);get connection(){return Kt(this.#ge)}set connection(e){Pe(this.#ge,e)}#ye=xe(()=>e.props.connectionMode??ma.Strict);get connectionMode(){return Kt(this.#ye)}set connectionMode(e){Pe(this.#ye,e)}#ve=xe(()=>e.props.connectionRadius??20);get connectionRadius(){return Kt(this.#ve)}set connectionRadius(e){Pe(this.#ve,e)}#ke=xe(()=>e.props.isValidConnection??(()=>!0));get isValidConnection(){return Kt(this.#ke)}set isValidConnection(e){Pe(this.#ke,e)}#be=xe(()=>e.props.selectNodesOnDrag??!0);get selectNodesOnDrag(){return Kt(this.#be)}set selectNodesOnDrag(e){Pe(this.#be,e)}#we=xe(()=>void 0===e.props.defaultMarkerColor?"#b1b1b7":e.props.defaultMarkerColor);get defaultMarkerColor(){return Kt(this.#we)}set defaultMarkerColor(e){Pe(this.#we,e)}#xe=xe(()=>function(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const i=new Set;return e.reduce((e,s)=>([s.markerStart||r,s.markerEnd||o].forEach(r=>{if(r&&"object"==typeof r){const o=Pl(r,t);i.has(o)||(e.push({id:o,color:r.color||n,...r}),i.add(o))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}(e.edges,{defaultColor:this.defaultMarkerColor,id:this.flowId,defaultMarkerStart:this.defaultEdgeOptions.markerStart,defaultMarkerEnd:this.defaultEdgeOptions.markerEnd}));get markers(){return Kt(this.#xe)}set markers(e){Pe(this.#xe,e)}#Ce=xe(()=>e.props.onlyRenderVisibleElements??!1);get onlyRenderVisibleElements(){return Kt(this.#Ce)}set onlyRenderVisibleElements(e){Pe(this.#Ce,e)}#_e=xe(()=>e.props.onflowerror??Ya);get onerror(){return Kt(this.#_e)}set onerror(e){Pe(this.#_e,e)}#Se=xe(()=>e.props.ondelete);get ondelete(){return Kt(this.#Se)}set ondelete(e){Pe(this.#Se,e)}#Ee=xe(()=>e.props.onbeforedelete);get onbeforedelete(){return Kt(this.#Ee)}set onbeforedelete(e){Pe(this.#Ee,e)}#Me=xe(()=>e.props.onbeforeconnect);get onbeforeconnect(){return Kt(this.#Me)}set onbeforeconnect(e){Pe(this.#Me,e)}#Ae=xe(()=>e.props.onconnect);get onconnect(){return Kt(this.#Ae)}set onconnect(e){Pe(this.#Ae,e)}#De=xe(()=>e.props.onconnectstart);get onconnectstart(){return Kt(this.#De)}set onconnectstart(e){Pe(this.#De,e)}#Te=xe(()=>e.props.onconnectend);get onconnectend(){return Kt(this.#Te)}set onconnectend(e){Pe(this.#Te,e)}#Oe=xe(()=>e.props.onbeforereconnect);get onbeforereconnect(){return Kt(this.#Oe)}set onbeforereconnect(e){Pe(this.#Oe,e)}#Ne=xe(()=>e.props.onreconnect);get onreconnect(){return Kt(this.#Ne)}set onreconnect(e){Pe(this.#Ne,e)}#Pe=xe(()=>e.props.onreconnectstart);get onreconnectstart(){return Kt(this.#Pe)}set onreconnectstart(e){Pe(this.#Pe,e)}#ze=xe(()=>e.props.onreconnectend);get onreconnectend(){return Kt(this.#ze)}set onreconnectend(e){Pe(this.#ze,e)}#Ie=xe(()=>e.props.clickConnect??!0);get clickConnect(){return Kt(this.#Ie)}set clickConnect(e){Pe(this.#Ie,e)}#Le=xe(()=>e.props.onclickconnectstart);get onclickconnectstart(){return Kt(this.#Le)}set onclickconnectstart(e){Pe(this.#Le,e)}#$e=xe(()=>e.props.onclickconnectend);get onclickconnectend(){return Kt(this.#$e)}set onclickconnectend(e){Pe(this.#$e,e)}#Re=Oe(null);get clickConnectStartHandle(){return Kt(this.#Re)}set clickConnectStartHandle(e){Pe(this.#Re,e)}#Fe=xe(()=>e.props.onselectiondrag);get onselectiondrag(){return Kt(this.#Fe)}set onselectiondrag(e){Pe(this.#Fe,e)}#Be=xe(()=>e.props.onselectiondragstart);get onselectiondragstart(){return Kt(this.#Be)}set onselectiondragstart(e){Pe(this.#Be,e)}#Ve=xe(()=>e.props.onselectiondragstop);get onselectiondragstop(){return Kt(this.#Ve)}set onselectiondragstop(e){Pe(this.#Ve,e)}resolveFitView=async()=>{this.panZoom&&(await Ia({nodes:this.nodeLookup,width:this.width,height:this.height,panZoom:this.panZoom,minZoom:this.minZoom,maxZoom:this.maxZoom},this.fitViewOptions),this.fitViewResolver?.resolve(!0),this.fitViewQueued=!1,this.fitViewOptions=void 0,this.fitViewResolver=null)};_prefersDark=new Ac("(prefers-color-scheme: dark)","dark"===e.props.colorModeSSR);#He=xe(()=>"system"===e.props.colorMode?this._prefersDark.current?"dark":"light":e.props.colorMode??"light");get colorMode(){return Kt(this.#He)}set colorMode(e){Pe(this.#He,e)}constructor(){}resetStoreValues(){this.dragging=!1,this.selectionRect=null,this.selectionRectMode=null,this.selectionKeyPressed=!1,this.multiselectionKeyPressed=!1,this.deleteKeyPressed=!1,this.panActivationKeyPressed=!1,this.zoomActivationKeyPressed=!1,this._connection=wa,this.clickConnectStartHandle=null,this.viewport=e.props.initialViewport??{x:0,y:0,zoom:1},this.ariaLiveMessage=""}}}function Pc(){const e=J(zc);if(!e)throw new Error("To call useStore outside of <SvelteFlow /> you need to wrap your component in a <SvelteFlowProvider />");return e.getStore()}const zc=Symbol();function Ic(e){const t=Nc(e);const n=(e,n=!1)=>{t.nodes=t.nodes.map(t=>{const r=e.get(t.id);return r?{...t,position:r.position,dragging:n}:t})};function r(e,n){const r=t.panZoom;return r?r.scaleBy(e,n):Promise.resolve(!1)}function o(e,t=null){let n=!1;const r=e.map(e=>(!t||t.has(e.id))&&e.selected?(n=!0,{...e,selected:!1}):e);return[n,r]}function i(e){const n=e?.nodes?new Set(e.nodes.map(e=>e.id)):null,[r,i]=o(t.nodes,n);r&&(t.nodes=i);const s=e?.edges?new Set(e.edges.map(e=>e.id)):null,[a,l]=o(t.edges,s);a&&(t.edges=l)}function s(e){const n=t.multiselectionKeyPressed;t.nodes=t.nodes.map(t=>{const r=e.includes(t.id),o=n&&t.selected||r;return!!t.selected!==o?{...t,selected:o}:t}),n||i({nodes:[]})}function a(e){const n=t.multiselectionKeyPressed;t.edges=t.edges.map(t=>{const r=e.includes(t.id),o=n&&t.selected||r;return!!t.selected!==o?{...t,selected:o}:t}),n||i({edges:[]})}return Object.assign(t,{setNodeTypes:function(e){t.nodeTypes={...Tc,...e}},setEdgeTypes:function(e){t.edgeTypes={...Oc,...e}},addEdge:function(e){t.edges=((e,t)=>{if(!e.source||!e.target)return t;let n;return n=Ta(e)?{...e}:{...e,id:xl(e)},((e,t)=>t.some(t=>!(t.source!==e.source||t.target!==e.target||t.sourceHandle!==e.sourceHandle&&(t.sourceHandle||e.sourceHandle)||t.targetHandle!==e.targetHandle&&(t.targetHandle||e.targetHandle))))(n,t)?t:(null===n.sourceHandle&&delete n.sourceHandle,null===n.targetHandle&&delete n.targetHandle,t.concat(n))})(e,t.edges)},updateNodePositions:n,updateNodeInternals:function(e){const{changes:n,updatedInternals:r}=Bl(e,t.nodeLookup,t.parentLookup,t.domNode,t.nodeOrigin);if(!r)return;!function(e,t,n){const r=Ll(zl,n);for(const o of e.values())if(o.parentId)Rl(o,e,t,r);else{const e=Na(o,r.nodeOrigin),t=il(o.extent)?o.extent:r.nodeExtent,n=Fa(e,t,sl(o));o.internals.positionAbsolute=n}}(t.nodeLookup,t.parentLookup,{nodeOrigin:t.nodeOrigin,nodeExtent:t.nodeExtent}),t.fitViewQueued&&t.resolveFitView();const o=new Map;for(const i of n){const e=t.nodeLookup.get(i.id)?.internals.userNode;if(!e)continue;const n={...e};switch(i.type){case"dimensions":{const e={...n.measured,...i.dimensions};i.setAttributes&&(n.width=i.dimensions?.width??n.width,n.height=i.dimensions?.height??n.height),n.measured=e;break}case"position":n.position=i.position??n.position}o.set(i.id,n)}t.nodes=t.nodes.map(e=>o.get(e.id)??e)},zoomIn:function(e){return r(1.2,e)},zoomOut:function(e){return r(1/1.2,e)},fitView:function(e){const n=t.fitViewResolver??Promise.withResolvers();return t.fitViewQueued=!0,t.fitViewOptions=e,t.fitViewResolver=n,t.nodes=[...t.nodes],n.promise},setCenter:async function(e,n,r){const o=void 0!==r?.zoom?r.zoom:t.maxZoom,i=t.panZoom;return i?(await i.setViewport({x:t.width/2-e*o,y:t.height/2-n*o,zoom:o},{duration:r?.duration,ease:r?.ease,interpolate:r?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},setMinZoom:function(e){const n=t.panZoom;n&&(n.setScaleExtent([e,t.maxZoom]),t.minZoom=e)},setMaxZoom:function(e){const n=t.panZoom;n&&(n.setScaleExtent([t.minZoom,e]),t.maxZoom=e)},setTranslateExtent:function(e){const n=t.panZoom;n&&(n.setTranslateExtent(e),t.translateExtent=e)},unselectNodesAndEdges:i,addSelectedNodes:s,addSelectedEdges:a,handleNodeSelection:function(e,n,r){const o=t.nodeLookup.get(e);o?(t.selectionRect=null,t.selectionRectMode=null,o.selected?(n||o.selected&&t.multiselectionKeyPressed)&&(i({nodes:[o],edges:[]}),requestAnimationFrame(()=>r?.blur())):s([e])):console.warn("012",ua(e))},handleEdgeSelection:function(e){const n=t.edgeLookup.get(e);if(!n)return void console.warn("012",ua(e));(n.selectable||t.elementsSelectable&&void 0===n.selectable)&&(t.selectionRect=null,t.selectionRectMode=null,n.selected?n.selected&&t.multiselectionKeyPressed&&i({nodes:[],edges:[n]}):a([e]))},moveSelectedNodes:function(e,r){const{nodeExtent:o,snapGrid:i,nodeOrigin:s,nodeLookup:a,nodesDraggable:l,onerror:c}=t,u=new Map,d=i?.[0]??5,h=i?.[1]??5,p=e.x*d*r,f=e.y*h*r;for(const t of a.values()){if(!(t.selected&&(t.draggable||l&&void 0===t.draggable)))continue;let e={x:t.internals.positionAbsolute.x+p,y:t.internals.positionAbsolute.y+f};i&&(e=Qa(e,i));const{position:n,positionAbsolute:r}=La({nodeId:t.id,nextPosition:e,nodeLookup:a,nodeExtent:o,nodeOrigin:s,onError:c});t.position=n,t.internals.positionAbsolute=r,u.set(t.id,t)}n(u)},panBy:function(e){return async function({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}({delta:e,panZoom:t.panZoom,transform:[t.viewport.x,t.viewport.y,t.viewport.zoom],translateExtent:t.translateExtent,width:t.width,height:t.height})},updateConnection:e=>{t._connection={...e}},cancelConnection:function(){t._connection=wa},reset:function(){t.resetStoreValues(),i()}})}var Lc=cn('<div class="svelte-flow__zoom svelte-flow__container"><!></div>');function $c(e,t){X(t,!0);let n=yr(t,"store",15),r=xe(()=>n().panActivationKeyPressed||t.panOnDrag),o=xe(()=>n().panActivationKeyPressed||t.panOnScroll);const{viewport:i}=n();let s=!1;Qe(()=>{!s&&n().viewportInitialized&&(t.oninit?.(),s=!0)});var a=Lc();wn(Ke(a),()=>t.children),Nn(a,(e,t)=>function(e,t){const{minZoom:n,maxZoom:r,initialViewport:o,onPanZoomStart:i,onPanZoom:s,onPanZoomEnd:a,translateExtent:l,setPanZoomInstance:c,onDraggingChange:u,onTransformChange:d}=t,h=ic({domNode:e,minZoom:n,maxZoom:r,translateExtent:l,viewport:o,onPanZoom:s,onPanZoomStart:i,onPanZoomEnd:a,onDraggingChange:u}),p=h.getViewport();return o.x===p.x&&o.y===p.y&&o.zoom===p.zoom||d([p.x,p.y,p.zoom]),c(h),h.update(t),{update(e){h.update(e)}}}?.(e,t),()=>({viewport:n().viewport,minZoom:n().minZoom,maxZoom:n().maxZoom,initialViewport:i,onDraggingChange:e=>{n(n().dragging=e,!0)},setPanZoomInstance:e=>{n(n().panZoom=e,!0)},onPanZoomStart:t.onmovestart,onPanZoom:t.onmove,onPanZoomEnd:t.onmoveend,zoomOnScroll:t.zoomOnScroll,zoomOnDoubleClick:t.zoomOnDoubleClick,zoomOnPinch:t.zoomOnPinch,panOnScroll:Kt(o),panOnDrag:Kt(r),panOnScrollSpeed:t.panOnScrollSpeed,panOnScrollMode:t.panOnScrollMode,zoomActivationKeyPressed:n().zoomActivationKeyPressed,preventScrolling:"boolean"!=typeof t.preventScrolling||t.preventScrolling,noPanClassName:n().noPanClass,noWheelClassName:n().noWheelClass,userSelectionActive:!!n().selectionRect,translateExtent:n().translateExtent,lib:"svelte",paneClickDistance:t.paneClickDistance,selectionOnDrag:t.selectionOnDrag,onTransformChange:e=>{n(n().viewport={x:e[0],y:e[1],zoom:e[2]},!0)},connectionInProgress:n().connection.inProgress})),pn(e,a),Y()}function Rc(e,t){return n=>{n.target===t&&e?.(n)}}function Fc(e){return t=>{const n=e.has(t.id);return!!t.selected!==n?{...t,selected:n}:t}}function Bc(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}var Vc=cn("<div><!></div>");function Hc(e,t){X(t,!0);let n,r=yr(t,"store",15),o=yr(t,"panOnDrag",3,!0),i=yr(t,"paneClickDistance",3,1),s=null,a=new Set,l=new Set,c=xe(()=>r().panActivationKeyPressed||o()),u=xe(()=>r().selectionKeyPressed||!!r().selectionRect||t.selectionOnDrag&&!0!==Kt(c)),d=xe(()=>r().elementsSelectable&&(Kt(u)||"user"===r().selectionRectMode)),h=!1;function p(e){if(s=n?.getBoundingClientRect(),!s)return;const o=e.target===n,a=!o&&!!e.target.closest(".nokey"),l=t.selectionOnDrag&&o||r().selectionKeyPressed;if(a||!Kt(u)||!l||0!==e.button||!e.isPrimary)return;e.target?.setPointerCapture?.(e.pointerId),h=!1;const{x:c,y:d}=fl(e,s);r(r().selectionRect={width:0,height:0,startX:c,startY:d,x:c,y:d},!0),o||(e.stopPropagation(),e.preventDefault()),(0===i()||r().selectionKeyPressed)&&(r().unselectNodesAndEdges(),t.onselectionstart?.(e),h=!0)}function f(e){if(!Kt(u)||!s||!r().selectionRect)return;const o=fl(e,s),{startX:c=0,startY:d=0}=r().selectionRect;if(!h&&e.target===n&&!r().selectionKeyPressed&&i()>0){if(Math.hypot(o.x-c,o.y-d)<=i())return;r().unselectNodesAndEdges(),t.onselectionstart?.(e)}h=!0;const p={...r().selectionRect,x:o.x<c?o.x:c,y:o.y<d?o.y:d,width:Math.abs(o.x-c),height:Math.abs(o.y-d)},f=a,m=l;a=new Set(za(r().nodeLookup,p,[r().viewport.x,r().viewport.y,r().viewport.zoom],r().selectionMode===ka.Partial,!0).map(e=>e.id));const g=r().defaultEdgeOptions.selectable??!0;l=new Set;for(const t of a){const e=r().connectionLookup.get(t);if(e)for(const{edgeId:t}of e.values()){const e=r().edgeLookup.get(t);e&&(e.selectable??g)&&l.add(t)}}Bc(f,a)||r(r().nodes=r().nodes.map(Fc(a)),!0),Bc(m,l)||r(r().edges=r().edges.map(Fc(l)),!0),r(r().selectionRectMode="user",!0),r(r().selectionRect=p,!0)}function m(e){0===e.button&&(e.target?.releasePointerCapture?.(e.pointerId),h||e.target!==n||v?.(e),r(r().selectionRect=null,!0),h&&r(r().selectionRectMode=a.size>0?"nodes":null,!0),h&&t.onselectionend?.(e))}const g=e=>{Array.isArray(Kt(c))&&Kt(c).includes(2)?e.preventDefault():t.onpanecontextmenu?.({event:e})},y=e=>{h&&(e.stopPropagation(),h=!1)};function v(e){h||r().connection.inProgress?h=!1:(t.onpaneclick?.({event:e}),r().unselectNodesAndEdges(),r(r().selectionRectMode=null,!0),r(r().selectionRect=null,!0))}var k=Vc();let b;var w=xe(()=>Kt(d)?void 0:Rc(v,n));k.__click=function(...e){Kt(w)?.apply(this,e)},k.__pointermove=function(...e){(Kt(d)?f:void 0)?.apply(this,e)},k.__pointerup=function(...e){(Kt(d)?m:void 0)?.apply(this,e)};var x=xe(()=>Rc(g,n));k.__contextmenu=function(...e){Kt(x)?.apply(this,e)},wn(Ke(k),()=>t.children),or(k,e=>n=e,()=>n),it(e=>b=Fn(k,1,"svelte-flow__pane svelte-flow__container",null,b,e),[()=>({draggable:!0===o()||Array.isArray(o())&&o().includes(0),dragging:r().dragging,selection:Kt(u)})]),nn("pointerdown",k,function(...e){(Kt(d)?p:void 0)?.apply(this,e)},!0),nn("click",k,function(...e){(Kt(d)?y:void 0)?.apply(this,e)},!0),pn(e,k),Y()}rn(["click","pointermove","pointerup","contextmenu"]);var jc=cn('<div class="svelte-flow__viewport xyflow__viewport svelte-flow__container"><!></div>');function qc(e,t){const{store:n,onDrag:r,onDragStart:o,onDragStop:i,onNodeMouseDown:s}=t,a=Kl({onDrag:r,onDragStart:o,onDragStop:i,onNodeMouseDown:s,getStoreItems:()=>{const{snapGrid:e,viewport:t}=n;return{nodes:n.nodes,nodeLookup:n.nodeLookup,edges:n.edges,nodeExtent:n.nodeExtent,snapGrid:e||[0,0],snapToGrid:!!e,nodeOrigin:n.nodeOrigin,multiSelectionActive:n.multiselectionKeyPressed,domNode:n.domNode,transform:[t.x,t.y,t.zoom],autoPanOnNodeDrag:n.autoPanOnNodeDrag,nodesDraggable:n.nodesDraggable,selectNodesOnDrag:n.selectNodesOnDrag,nodeDragThreshold:n.nodeDragThreshold,unselectNodesAndEdges:n.unselectNodesAndEdges,updateNodePositions:n.updateNodePositions,onSelectionDrag:n.onselectiondrag,onSelectionDragStart:n.onselectiondragstart,onSelectionDragStop:n.onselectiondragstop,panBy:n.panBy}}});function l(e,t){t.disabled?a.destroy():a.update({domNode:e,noDragClassName:t.noDragClass,handleSelector:t.handleSelector,nodeId:t.nodeId,isSelectable:t.isSelectable,nodeClickDistance:t.nodeClickDistance})}return l(e,t),{update(t){l(e,t)},destroy(){a.destroy()}}}var Kc=cn('<div aria-live="assertive" aria-atomic="true" class="a11y-live-msg svelte-13pq11u"> </div>'),Wc=cn('<div class="a11y-hidden svelte-13pq11u"> </div> <div class="a11y-hidden svelte-13pq11u"> </div> <!>',1);const Zc="svelte-flow__node-desc",Uc="svelte-flow__edge-desc",Jc="svelte-flow__aria-live";var Gc=cn("<div><!></div>");function Xc(e,t){X(t,!0);let n=yr(t,"store",15),r=xe(()=>y(t.node.data,()=>({}),!0)),o=xe(()=>y(t.node.selected,!1)),i=xe(()=>t.node.draggable),s=xe(()=>t.node.selectable),a=xe(()=>y(t.node.deletable,!0)),l=xe(()=>t.node.connectable),c=xe(()=>t.node.focusable),u=xe(()=>y(t.node.hidden,!1)),d=xe(()=>y(t.node.dragging,!1)),h=xe(()=>y(t.node.style,"")),p=xe(()=>t.node.class),f=xe(()=>y(t.node.type,"default")),m=xe(()=>t.node.parentId),g=xe(()=>t.node.sourcePosition),v=xe(()=>t.node.targetPosition),k=xe(()=>y(t.node.measured,()=>({width:0,height:0}),!0).width),b=xe(()=>y(t.node.measured,()=>({width:0,height:0}),!0).height),w=xe(()=>t.node.initialWidth),x=xe(()=>t.node.initialHeight),C=xe(()=>t.node.width),_=xe(()=>t.node.height),S=xe(()=>t.node.dragHandle),E=xe(()=>y(t.node.internals.z,0)),M=xe(()=>t.node.internals.positionAbsolute.x),A=xe(()=>t.node.internals.positionAbsolute.y),D=xe(()=>t.node.internals.userNode),{id:T}=t.node,O=xe(()=>Kt(i)??n().nodesDraggable),N=xe(()=>Kt(s)??n().elementsSelectable),P=xe(()=>Kt(l)??n().nodesConnectable),z=xe(()=>al(t.node)),I=xe(()=>!!t.node.internals.handleBounds),L=xe(()=>Kt(z)&&Kt(I)),$=xe(()=>Kt(c)??n().nodesFocusable);let R=xe(()=>{return e=T,n().parentLookup.has(e);var e}),F=Oe(null),B=null,V=Kt(f),H=Kt(g),j=Kt(v),q=xe(()=>n().nodeTypes[Kt(f)]??dc),K=xe(()=>n().ariaLabelConfig);G("svelteflow__node_connectable",{get value(){return Kt(P)}}),G("svelteflow__node_id",T);let W=xe(()=>{const e=void 0===Kt(k)?Kt(C)??Kt(w):Kt(C),t=void 0===Kt(b)?Kt(_)??Kt(x):Kt(_);if(void 0!==e||void 0!==t||void 0!==Kt(h))return`${Kt(h)};${e?`width:${yc(e)};`:""}${t?`height:${yc(t)};`:""}`});function Z(e){Kt(N)&&(!n().selectNodesOnDrag||!Kt(O)||n().nodeDragThreshold>0)&&n().handleNodeSelection(T),t.onnodeclick?.({node:Kt(D),event:e})}function U(e){if(!hl(e)&&!n().disableKeyboardA11y)if(pa.includes(e.key)&&Kt(N)){const t="Escape"===e.key;n().handleNodeSelection(T,t,Kt(F))}else Kt(O)&&t.node.selected&&Object.prototype.hasOwnProperty.call(vc,e.key)&&(e.preventDefault(),n(n().ariaLiveMessage=Kt(K)["node.a11yDescription.ariaLiveMessage"]({direction:e.key.replace("Arrow","").toLowerCase(),x:~~t.node.internals.positionAbsolute.x,y:~~t.node.internals.positionAbsolute.y}),!0),n().moveSelectedNodes(vc[e.key],e.shiftKey?4:1))}Qe(()=>{(Kt(f)!==V||Kt(g)!==H||Kt(v)!==j)&&null!==Kt(F)&&requestAnimationFrame(()=>{null!==Kt(F)&&n().updateNodeInternals(new Map([[T,{id:T,nodeElement:Kt(F),force:!0}]]))}),V=Kt(f),H=Kt(g),j=Kt(v)}),Qe(()=>{!t.resizeObserver||Kt(L)&&Kt(F)===B||(B&&t.resizeObserver.unobserve(B),Kt(F)&&t.resizeObserver.observe(Kt(F)),B=Kt(F))}),Cn(()=>{B&&t.resizeObserver?.unobserve(B)});const J=()=>{if(n().disableKeyboardA11y||!n().autoPanOnNodeFocus||!Kt(F)?.matches(":focus-visible"))return;const{width:e,height:r,viewport:o}=n();za(new Map([[T,t.node]]),{x:0,y:0,width:e,height:r},[o.x,o.y,o.zoom],!0).length>0||n().setCenter(t.node.position.x+(t.node.measured.width??0)/2,t.node.position.y+(t.node.measured.height??0)/2,{zoom:o.zoom})};var Q=hn(),ee=We(Q),te=e=>{var i=Gc();Gn(i,()=>({"data-id":T,class:["svelte-flow__node",`svelte-flow__node-${Kt(f)}`,Kt(p)],style:Kt(W),onclick:Z,onpointerenter:t.onnodepointerenter?e=>t.onnodepointerenter({node:Kt(D),event:e}):void 0,onpointerleave:t.onnodepointerleave?e=>t.onnodepointerleave({node:Kt(D),event:e}):void 0,onpointermove:t.onnodepointermove?e=>t.onnodepointermove({node:Kt(D),event:e}):void 0,oncontextmenu:t.onnodecontextmenu?e=>t.onnodecontextmenu({node:Kt(D),event:e}):void 0,onkeydown:Kt($)?U:void 0,onfocus:Kt($)?J:void 0,tabIndex:Kt($)?0:void 0,role:t.node.ariaRole??(Kt($)?"group":void 0),"aria-roledescription":"node","aria-describedby":n().disableKeyboardA11y?void 0:`${Zc}-${n().flowId}`,...t.node.domAttributes,[qn]:{dragging:Kt(d),selected:Kt(o),draggable:Kt(O),connectable:Kt(P),selectable:Kt(N),nopan:Kt(O),parent:Kt(R)},[Kn]:{"z-index":Kt(E),transform:`translate(${Kt(M)??""}px, ${Kt(A)??""}px)`,visibility:Kt(z)?"visible":"hidden"}})),On(Ke(i),()=>Kt(q),(e,t)=>{t(e,{get data(){return Kt(r)},get id(){return T},get selected(){return Kt(o)},get selectable(){return Kt(N)},get deletable(){return Kt(a)},get sourcePosition(){return Kt(g)},get targetPosition(){return Kt(v)},get zIndex(){return Kt(E)},get dragging(){return Kt(d)},get draggable(){return Kt(O)},get dragHandle(){return Kt(S)},get parentId(){return Kt(m)},get type(){return Kt(f)},get isConnectable(){return Kt(P)},get positionAbsoluteX(){return Kt(M)},get positionAbsoluteY(){return Kt(A)},get width(){return Kt(C)},get height(){return Kt(_)}})}),Nn(i,(e,t)=>qc?.(e,t),()=>({nodeId:T,isSelectable:Kt(N),disabled:!Kt(O),handleSelector:Kt(S),noDragClass:n().noDragClass,nodeClickDistance:t.nodeClickDistance,onNodeMouseDown:n().handleNodeSelection,onDrag:(e,n,r,o)=>{t.onnodedrag?.({event:e,targetNode:r,nodes:o})},onDragStart:(e,n,r,o)=>{t.onnodedragstart?.({event:e,targetNode:r,nodes:o})},onDragStop:(e,n,r,o)=>{t.onnodedragstop?.({event:e,targetNode:r,nodes:o})},store:n()})),or(i,e=>Pe(F,e),()=>Kt(F)),pn(e,i)};_n(ee,e=>{Kt(u)||e(te)}),pn(e,Q),Y()}var Yc=cn('<div class="svelte-flow__nodes"></div>');var Qc=dn('<svg class="svelte-flow__edge-wrapper"><g><!></g></svg>');var eu=dn("<defs></defs>");function tu(e,t){X(t,!1);const n=Pc();ir();var r=eu();Sn(r,5,()=>n.markers,e=>e.id,(e,t)=>{!function(e,t){X(t,!0);let n=yr(t,"width",3,12.5),r=yr(t,"height",3,12.5),o=yr(t,"markerUnits",3,"strokeWidth"),i=yr(t,"orient",3,"auto-start-reverse"),s=yr(t,"color",3,"none");var a=ou(),l=Ke(a),c=e=>{var n=nu();let r;it(()=>{Jn(n,"stroke-width",t.strokeWidth),r=Vn(n,"",r,{stroke:s()})}),pn(e,n)},u=e=>{var n=hn(),r=We(n),o=e=>{var n=ru();let r;it(()=>{Jn(n,"stroke-width",t.strokeWidth),r=Vn(n,"",r,{stroke:s(),fill:s()})}),pn(e,n)};_n(r,e=>{t.type===_a.ArrowClosed&&e(o)},!0),pn(e,n)};_n(l,e=>{t.type===_a.Arrow?e(c):e(u,!1)}),it(()=>{Jn(a,"id",t.id),Jn(a,"markerWidth",`${n()}`),Jn(a,"markerHeight",`${r()}`),Jn(a,"markerUnits",o()),Jn(a,"orient",i())}),pn(e,a),Y()}(e,gr(()=>Kt(t)))}),pn(e,r),Y()}var nu=dn('<polyline class="arrow" fill="none" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4"></polyline>'),ru=dn('<polyline class="arrowclosed" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),ou=dn('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');var iu=cn('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!></div>');function su(e,t){X(t,!0);let n=yr(t,"store",15);var r=iu(),o=Ke(r);tu(Ke(o),{}),Sn(Ze(o,2),17,()=>n().visible.edges.values(),e=>e.id,(e,r)=>{!function(e,t){X(t,!0);let n=xe(()=>t.edge.source),r=xe(()=>t.edge.target),o=xe(()=>t.edge.sourceX),i=xe(()=>t.edge.sourceY),s=xe(()=>t.edge.targetX),a=xe(()=>t.edge.targetY),l=xe(()=>t.edge.sourcePosition),c=xe(()=>t.edge.targetPosition),u=xe(()=>y(t.edge.animated,!1)),d=xe(()=>y(t.edge.selected,!1)),h=xe(()=>t.edge.label),p=xe(()=>t.edge.labelStyle),f=xe(()=>y(t.edge.data,()=>({}),!0)),m=xe(()=>t.edge.style),g=xe(()=>t.edge.interactionWidth),v=xe(()=>y(t.edge.type,"default")),k=xe(()=>t.edge.sourceHandle),b=xe(()=>t.edge.targetHandle),w=xe(()=>t.edge.markerStart),x=xe(()=>t.edge.markerEnd),C=xe(()=>t.edge.selectable),_=xe(()=>t.edge.focusable),S=xe(()=>y(t.edge.deletable,!0)),E=xe(()=>t.edge.hidden),M=xe(()=>t.edge.zIndex),A=xe(()=>t.edge.class),D=xe(()=>t.edge.ariaLabel),T=null;const{id:O}=t.edge;G("svelteflow__edge_id",O);let N=xe(()=>Kt(C)??t.store.elementsSelectable),P=xe(()=>Kt(_)??t.store.edgesFocusable),z=xe(()=>t.store.edgeTypes[Kt(v)]??_c),I=xe(()=>Kt(w)?`url('#${Pl(Kt(w),t.store.flowId)}')`:void 0),L=xe(()=>Kt(x)?`url('#${Pl(Kt(x),t.store.flowId)}')`:void 0);function $(e){const n=t.store.edgeLookup.get(O);n&&(Kt(N)&&t.store.handleEdgeSelection(O),t.onedgeclick?.({event:e,edge:n}))}function R(e,n){const r=t.store.edgeLookup.get(O);r&&n({event:e,edge:r})}function F(e){if(!t.store.disableKeyboardA11y&&pa.includes(e.key)&&Kt(N)){const{unselectNodesAndEdges:n,addSelectedEdges:r}=t.store;"Escape"===e.key?(T?.blur(),n({edges:[t.edge]})):r([O])}}var B=hn(),V=We(B),H=e=>{var y=Qc();let w;var x=Ke(y);Gn(x,()=>({class:["svelte-flow__edge",Kt(A)],"data-id":O,onclick:$,oncontextmenu:t.onedgecontextmenu?e=>{R(e,t.onedgecontextmenu)}:void 0,onpointerenter:t.onedgepointerenter?e=>{R(e,t.onedgepointerenter)}:void 0,onpointerleave:t.onedgepointerleave?e=>{R(e,t.onedgepointerleave)}:void 0,"aria-label":null===Kt(D)?void 0:Kt(D)?Kt(D):`Edge from ${Kt(n)} to ${Kt(r)}`,"aria-describedby":Kt(P)?`${Uc}-${t.store.flowId}`:void 0,role:t.edge.ariaRole??(Kt(P)?"group":"img"),"aria-roledescription":"edge",onkeydown:Kt(P)?F:void 0,tabindex:Kt(P)?0:void 0,...t.edge.domAttributes,[qn]:{animated:Kt(u),selected:Kt(d),selectable:Kt(N)}})),On(Ke(x),()=>Kt(z),(e,t)=>{t(e,{get id(){return O},get source(){return Kt(n)},get target(){return Kt(r)},get sourceX(){return Kt(o)},get sourceY(){return Kt(i)},get targetX(){return Kt(s)},get targetY(){return Kt(a)},get sourcePosition(){return Kt(l)},get targetPosition(){return Kt(c)},get animated(){return Kt(u)},get selected(){return Kt(d)},get label(){return Kt(h)},get labelStyle(){return Kt(p)},get data(){return Kt(f)},get style(){return Kt(m)},get interactionWidth(){return Kt(g)},get selectable(){return Kt(N)},get deletable(){return Kt(S)},get type(){return Kt(v)},get sourceHandleId(){return Kt(k)},get targetHandleId(){return Kt(b)},get markerStart(){return Kt(I)},get markerEnd(){return Kt(L)}})}),or(x,e=>T=e,()=>T),it(()=>w=Vn(y,"",w,{"z-index":Kt(M)})),pn(e,y)};_n(V,e=>{Kt(E)||e(H)}),pn(e,B),Y()}(e,{get edge(){return Kt(r)},get onedgeclick(){return t.onedgeclick},get onedgecontextmenu(){return t.onedgecontextmenu},get onedgepointerenter(){return t.onedgepointerenter},get onedgepointerleave(){return t.onedgepointerleave},get store(){return n()},set store(e){n(e)}})}),pn(e,r),Y()}var au=cn('<div class="svelte-flow__selection svelte-1vr3gfi"></div>');function lu(e,t){X(t,!0);let n=yr(t,"x",3,0),r=yr(t,"y",3,0),o=yr(t,"width",3,0),i=yr(t,"height",3,0),s=yr(t,"isVisible",3,!0);var a=hn(),l=We(a),c=e=>{var t=au();let s;it(e=>s=Vn(t,"",s,e),[()=>({width:"string"==typeof o()?o():yc(o()),height:"string"==typeof i()?i():yc(i()),transform:`translate(${n()}px, ${r()}px)`})]),pn(e,t)};_n(l,e=>{s()&&e(c)}),pn(e,a),Y()}var cu=cn("<div><!></div>");function uu(e,t){X(t,!0);let n=Oe(void 0);Qe(()=>{t.store.disableKeyboardA11y||Kt(n)?.focus({preventScroll:!0})});let r=xe(()=>{if("nodes"===t.store.selectionRectMode){t.store.nodes;const e=Pa(t.store.nodeLookup,{filter:e=>!!e.selected});if(e.width>0&&e.height>0)return e}return null});function o(e){const n=t.store.nodes.filter(e=>e.selected);t.onselectioncontextmenu?.({nodes:n,event:e})}function i(e){const n=t.store.nodes.filter(e=>e.selected);t.onselectionclick?.({nodes:n,event:e})}function s(e){Object.prototype.hasOwnProperty.call(vc,e.key)&&(e.preventDefault(),t.store.moveSelectedNodes(vc[e.key],e.shiftKey?4:1))}var a=hn(),l=We(a),c=e=>{var a=cu();let l;a.__contextmenu=o,a.__click=i,a.__keydown=function(...e){(t.store.disableKeyboardA11y?void 0:s)?.apply(this,e)},lu(Ke(a),{width:"100%",height:"100%",x:0,y:0}),Nn(a,(e,t)=>qc?.(e,t),()=>({disabled:!1,store:t.store,onDrag:(e,n,r,o)=>{t.onnodedrag?.({event:e,targetNode:null,nodes:o})},onDragStart:(e,n,r,o)=>{t.onnodedragstart?.({event:e,targetNode:null,nodes:o})},onDragStop:(e,n,r,o)=>{t.onnodedragstop?.({event:e,targetNode:null,nodes:o})}})),or(a,e=>Pe(n,e),()=>Kt(n)),it(e=>{Fn(a,1,In(["svelte-flow__selection-wrapper",t.store.noPanClass]),"svelte-sf2y5e"),Jn(a,"role",t.store.disableKeyboardA11y?void 0:"button"),Jn(a,"tabindex",t.store.disableKeyboardA11y?void 0:-1),l=Vn(a,"",l,e)},[()=>({width:yc(Kt(r).width),height:yc(Kt(r).height),transform:`translate(${Kt(r).x??""}px, ${Kt(r).y??""}px)`})]),pn(e,a)};_n(l,e=>{"nodes"===t.store.selectionRectMode&&Kt(r)&&Xa(Kt(r).x)&&Xa(Kt(r).y)&&e(c)}),pn(e,a),Y()}function du(e){switch(e){case"ctrl":return 8;case"shift":return 4;case"alt":return 2;case"meta":return 1}}function hu(e,t){let n,{enabled:r=!0,trigger:o,type:i="keydown"}=t;function s(t){const n=Array.isArray(o)?o:[o],r=[t.metaKey,t.altKey,t.shiftKey,t.ctrlKey].reduce((e,t,n)=>t?e|1<<n:e,0);for(const o of n){const n={preventDefault:!1,enabled:!0,...o},{modifier:i,key:s,callback:a,preventDefault:l,enabled:c}=n;if(c){if(t.key!==s)continue;if(null===i||!1===i){if(0!==r)continue}else if(void 0!==i&&i?.[0]?.length>0){const e=Array.isArray(i)?i:[i];let t=!1;for(const n of e){if((Array.isArray(n)?n:[n]).reduce((e,t)=>e|du(t),0)===r){t=!0;break}}if(!t)continue}l&&t.preventDefault();const o={node:e,trigger:n,originalEvent:t};e.dispatchEvent(new CustomEvent("shortcut",{detail:o})),a?.(o)}}}return r&&(n=tn(e,i,s)),{update:t=>{const{enabled:a=!0,type:l="keydown"}=t;!r||a&&i===l?!r&&a&&(n=tn(e,l,s)):n?.(),r=a,i=l,o=t.trigger},destroy:()=>{n?.()}}}function pu(){const e=xe(Pc),t=t=>{const n=gc(t)?t:Kt(e).nodeLookup.get(t.id),r=n.parentId?function(e,t={width:0,height:0},n,r,o){const i={...e},s=r.get(n);if(s){const e=s.origin||o;i.x+=s.internals.positionAbsolute.x-(t.width??0)*e[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*e[1]}return i}(n.position,n.measured,n.parentId,Kt(e).nodeLookup,Kt(e).nodeOrigin):n.position,o={...n,position:r,width:n.measured?.width??n.width,height:n.measured?.height??n.height};return Wa(o)};function n(t,n,r={replace:!1}){Kt(e).nodes=Zt(()=>Kt(e).nodes).map(e=>{if(e.id===t){const t="function"==typeof n?n(e):n;return r?.replace&&gc(t)?t:{...e,...t}}return e})}const r=t=>Kt(e).nodeLookup.get(t);return{zoomIn:Kt(e).zoomIn,zoomOut:Kt(e).zoomOut,getInternalNode:r,getNode:e=>r(e)?.internals.userNode,getNodes:t=>void 0===t?Kt(e).nodes:fu(Kt(e).nodeLookup,t),getEdge:t=>Kt(e).edgeLookup.get(t),getEdges:t=>void 0===t?Kt(e).edges:fu(Kt(e).edgeLookup,t),setZoom:(t,n)=>{const r=Kt(e).panZoom;return r?r.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>Kt(e).viewport.zoom,setViewport:async(t,n)=>{const r=Kt(e).viewport;return Kt(e).panZoom?(await Kt(e).panZoom.setViewport({x:t.x??r.x,y:t.y??r.y,zoom:t.zoom??r.zoom},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>K(Kt(e).viewport),setCenter:async(t,n,r)=>Kt(e).setCenter(t,n,r),fitView:t=>Kt(e).fitView(t),fitBounds:async(t,n)=>{if(!Kt(e).panZoom)return Promise.resolve(!1);const r=rl(t,Kt(e).width,Kt(e).height,Kt(e).minZoom,Kt(e).maxZoom,n?.padding??.1);return await Kt(e).panZoom.setViewport(r,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)},getIntersectingNodes:(n,r=!0,o)=>{const i=Ga(n),s=i?n:t(n);return s?(o||Kt(e).nodes).filter(t=>{const o=Kt(e).nodeLookup.get(t.id);if(!o||!i&&t.id===n.id)return!1;const a=Wa(o),l=Ja(a,s);return r&&l>0||l>=a.width*a.height||l>=s.width*s.height}):[]},isNodeIntersecting:(e,n,r=!0)=>{const o=Ga(e)?e:t(e);if(!o)return!1;const i=Ja(o,n);return r&&i>0||i>=n.width*n.height||i>=o.width*o.height},deleteElements:async({nodes:t=[],edges:n=[]})=>{const{nodes:r,edges:o}=await $a({nodesToRemove:t,edgesToRemove:n,nodes:Kt(e).nodes,edges:Kt(e).edges,onBeforeDelete:Kt(e).onbeforedelete});return r&&(Kt(e).nodes=Zt(()=>Kt(e).nodes).filter(e=>!r.some(({id:t})=>t===e.id))),o&&(Kt(e).edges=Zt(()=>Kt(e).edges).filter(e=>!o.some(({id:t})=>t===e.id))),(r.length>0||o.length>0)&&Kt(e).ondelete?.({nodes:r,edges:o}),{deletedNodes:r,deletedEdges:o}},screenToFlowPosition:(t,n={snapToGrid:!0})=>{if(!Kt(e).domNode)return t;const r=!!n.snapToGrid&&Kt(e).snapGrid,{x:o,y:i,zoom:s}=Kt(e).viewport,{x:a,y:l}=Kt(e).domNode.getBoundingClientRect(),c={x:t.x-a,y:t.y-l};return el(c,[o,i,s],null!==r,r||[1,1])},flowToScreenPosition:t=>{if(!Kt(e).domNode)return t;const{x:n,y:r,zoom:o}=Kt(e).viewport,{x:i,y:s}=Kt(e).domNode.getBoundingClientRect(),a=tl(t,[n,r,o]);return{x:a.x+i,y:a.y+s}},toObject:()=>structuredClone({nodes:[...Kt(e).nodes],edges:[...Kt(e).edges],viewport:{...Kt(e).viewport}}),updateNode:n,updateNodeData:(t,r,o)=>{const i=Kt(e).nodeLookup.get(t)?.internals.userNode;if(!i)return;const s="function"==typeof r?r(i):r;n(t,e=>({...e,data:o?.replace?s:{...e.data,...s}}))},updateEdge:function(t,n,r={replace:!1}){Kt(e).edges=Zt(()=>Kt(e).edges).map(e=>{if(e.id===t){const t="function"==typeof n?n(e):n;return r.replace&&Ta(t)?t:{...e,...t}}return e})},getNodesBounds:t=>((e,t={nodeOrigin:[0,0]})=>{if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce((e,n)=>{const r="string"==typeof n;let o=t.nodeLookup||r?void 0:n;t.nodeLookup&&(o=r?t.nodeLookup.get(n):Oa(n)?n:t.nodeLookup.get(n.id));const i=o?Za(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return ja(e,i)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ka(n)})(t,{nodeLookup:Kt(e).nodeLookup,nodeOrigin:Kt(e).nodeOrigin}),getHandleConnections:({type:t,id:n,nodeId:r})=>Array.from(Kt(e).connectionLookup.get(`${r}-${t}-${n??null}`)?.values()??[])}}function fu(e,t){const n=[];for(const r of t){const t=e.get(r);if(t){const e="internals"in t?t.internals?.userNode:t;n.push(e)}}return n}function mu(e,t){X(t,!0);let n=yr(t,"store",15),r=yr(t,"selectionKey",3,"Shift"),o=yr(t,"multiSelectionKey",19,()=>ol()?"Meta":"Control"),i=yr(t,"deleteKey",3,"Backspace"),s=yr(t,"panActivationKey",3," "),a=yr(t,"zoomActivationKey",19,()=>ol()?"Meta":"Control"),{deleteElements:l}=pu();function c(e){return null!==e&&"object"==typeof e}function u(e){return c(e)&&e.modifier||[]}function d(e,t){return(Array.isArray(e)?e:[e]).map(e=>{const n=function(e){return null==e?"":c(e)?e.key:e}(e);return{key:n,modifier:u(e),enabled:null!==n,callback:t}})}function h(){n(n().selectionRect=null,!0),n(n().selectionKeyPressed=!1,!0),n(n().multiselectionKeyPressed=!1,!0),n(n().deleteKeyPressed=!1,!0),n(n().panActivationKeyPressed=!1,!0),n(n().zoomActivationKeyPressed=!1,!0)}nn("blur",Be,h),nn("contextmenu",Be,h),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(r(),()=>n(n().selectionKeyPressed=!0,!0)),type:"keydown"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(r(),()=>n(n().selectionKeyPressed=!1,!0)),type:"keyup"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(o(),()=>{n(n().multiselectionKeyPressed=!0,!0)}),type:"keydown"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(o(),()=>n(n().multiselectionKeyPressed=!1,!0)),type:"keyup"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(i(),e=>{e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey||hl(e.originalEvent)||(n(n().deleteKeyPressed=!0,!0),function(){const e=n().nodes.filter(e=>e.selected),t=n().edges.filter(e=>e.selected);l({nodes:e,edges:t})}())}),type:"keydown"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(i(),()=>n(n().deleteKeyPressed=!1,!0)),type:"keyup"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(s(),()=>n(n().panActivationKeyPressed=!0,!0)),type:"keydown"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(s(),()=>n(n().panActivationKeyPressed=!1,!0)),type:"keyup"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(a(),()=>n(n().zoomActivationKeyPressed=!0,!0)),type:"keydown"})),Nn(Be,(e,t)=>hu?.(e,t),()=>({trigger:d(a(),()=>n(n().zoomActivationKeyPressed=!1,!0)),type:"keyup"})),Y()}rn(["contextmenu","click","keydown"]);var gu=dn('<path fill="none" class="svelte-flow__connection-path"></path>'),yu=dn('<svg class="svelte-flow__connectionline"><g><!></g></svg>');var vu=cn("<div><!></div>");function ku(e,t){X(t,!0);let n=yr(t,"position",3,"top-right"),r=fr(t,["$$slots","$$events","$$legacy","position","style","class","children"]),o=xe(()=>`${n()}`.split("-"));var i=vu();Gn(i,e=>({class:e,style:t.style,...r}),[()=>["svelte-flow__panel",t.class,...Kt(o)]]),wn(Ke(i),()=>t.children??p),pn(e,i),Y()}var bu=cn('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');var wu=cn("<div><!></div>");var xu=cn('<div class="svelte-flow__viewport-back svelte-flow__container"></div> <!> <div class="svelte-flow__edge-labels svelte-flow__container"></div> <!> <!> <!> <div class="svelte-flow__viewport-front svelte-flow__container"></div>',1),Cu=cn("<!> <!>",1),_u=cn("<!> <!> <!> <!> <!>",1);function Su(e,t){X(t,!0);let n=yr(t,"paneClickDistance",3,1),r=yr(t,"nodeClickDistance",3,1),o=yr(t,"panOnScrollMode",19,()=>ya.Free),i=yr(t,"preventScrolling",3,!0),s=yr(t,"zoomOnScroll",3,!0),a=yr(t,"zoomOnDoubleClick",3,!0),l=yr(t,"zoomOnPinch",3,!0),c=yr(t,"panOnScroll",3,!1),u=yr(t,"panOnScrollSpeed",3,.5),d=yr(t,"panOnDrag",3,!0),h=yr(t,"selectionOnDrag",3,!0),f=yr(t,"connectionLineType",19,()=>xa.Bezier),m=yr(t,"nodes",31,()=>$e([])),g=yr(t,"edges",31,()=>$e([])),y=yr(t,"viewport",15,void 0),v=fr(t,["$$slots","$$events","$$legacy","width","height","proOptions","selectionKey","deleteKey","panActivationKey","multiSelectionKey","zoomActivationKey","paneClickDistance","nodeClickDistance","onmovestart","onmoveend","onmove","oninit","onnodeclick","onnodecontextmenu","onnodedrag","onnodedragstart","onnodedragstop","onnodepointerenter","onnodepointermove","onnodepointerleave","onselectionclick","onselectioncontextmenu","onselectionstart","onselectionend","onedgeclick","onedgecontextmenu","onedgepointerenter","onedgepointerleave","onpaneclick","onpanecontextmenu","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnDrag","selectionOnDrag","connectionLineComponent","connectionLineStyle","connectionLineContainerStyle","connectionLineType","attributionPosition","children","nodes","edges","viewport"]),k=Ic({props:v,width:t.width,height:t.height,get nodes(){return m()},set nodes(e){m(e)},get edges(){return g()},set edges(e){g(e)},get viewport(){return y()},set viewport(e){y(e)}});const b=J(zc);b&&b.setStore&&b.setStore(k),G(zc,{provider:!1,getStore:()=>k}),Qe(()=>{const e={nodes:k.selectedNodes,edges:k.selectedEdges};Zt(()=>t.onselectionchange)?.(e);for(const t of k.selectionChangeHandlers.values())t(e)}),Cn(()=>{k.reset()}),function(e,t){X(t,!0);let n=yr(t,"domNode",15),r=yr(t,"clientWidth",15),o=yr(t,"clientHeight",15),i=xe(()=>t.rest.class),s=xe(()=>function(e,t){var n={};for(var r in e)t.includes(r)||(n[r]=e[r]);return n}(t.rest,["id","class","nodeTypes","edgeTypes","colorMode","isValidConnection","onmove","onmovestart","onmoveend","onflowerror","ondelete","onbeforedelete","onbeforeconnect","onconnect","onconnectstart","onconnectend","onbeforereconnect","onreconnect","onreconnectstart","onreconnectend","onclickconnectstart","onclickconnectend","oninit","onselectionchange","onselectiondragstart","onselectiondrag","onselectiondragstop","onselectionstart","onselectionend","clickConnect","fitView","fitViewOptions","nodeOrigin","nodeDragThreshold","connectionDragThreshold","minZoom","maxZoom","initialViewport","connectionRadius","connectionMode","selectionMode","selectNodesOnDrag","snapGrid","defaultMarkerColor","translateExtent","nodeExtent","onlyRenderVisibleElements","autoPanOnConnect","autoPanOnNodeDrag","colorModeSSR","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","elementsSelectable","nodesFocusable","edgesFocusable","disableKeyboardA11y","noDragClass","noPanClass","noWheelClass","ariaLabelConfig","autoPanSpeed","panOnScrollSpeed"]));function a(e){e.currentTarget.scrollTo({top:0,left:0,behavior:"auto"}),t.rest.onscroll&&t.rest.onscroll(e)}var l=wu();Gn(l,e=>({class:["svelte-flow","svelte-flow__container",Kt(i),t.colorMode],"data-testid":"svelte-flow__wrapper",role:"application",onscroll:a,...Kt(s),[Kn]:e}),[()=>({width:yc(t.width),height:yc(t.height)})],void 0,void 0,"svelte-mkap6j"),wn(Ke(l),()=>t.children??p),or(l,e=>n(e),()=>n()),nr(l,"clientHeight",o),nr(l,"clientWidth",r),pn(e,l),Y()}(e,{get colorMode(){return k.colorMode},get width(){return t.width},get height(){return t.height},get rest(){return v},get domNode(){return k.domNode},set domNode(e){k.domNode=e},get clientWidth(){return k.width},set clientWidth(e){k.width=e},get clientHeight(){return k.height},set clientHeight(e){k.height=e},children:(e,m)=>{var g=_u(),y=We(g);mu(0,{get selectionKey(){return t.selectionKey},get deleteKey(){return t.deleteKey},get panActivationKey(){return t.panActivationKey},get multiSelectionKey(){return t.multiSelectionKey},get zoomActivationKey(){return t.zoomActivationKey},get store(){return k},set store(e){k=e}});var v=Ze(y,2);$c(v,{get panOnScrollMode(){return o()},get preventScrolling(){return i()},get zoomOnScroll(){return s()},get zoomOnDoubleClick(){return a()},get zoomOnPinch(){return l()},get panOnScroll(){return c()},get panOnScrollSpeed(){return u()},get panOnDrag(){return d()},get paneClickDistance(){return n()},get selectionOnDrag(){return h()},get onmovestart(){return t.onmovestart},get onmove(){return t.onmove},get onmoveend(){return t.onmoveend},get oninit(){return t.oninit},get store(){return k},set store(e){k=e},children:(e,o)=>{Hc(e,{get onpaneclick(){return t.onpaneclick},get onpanecontextmenu(){return t.onpanecontextmenu},get onselectionstart(){return t.onselectionstart},get onselectionend(){return t.onselectionend},get panOnDrag(){return d()},get paneClickDistance(){return n()},get selectionOnDrag(){return h()},get store(){return k},set store(e){k=e},children:(e,n)=>{var o=Cu(),i=We(o);!function(e,t){X(t,!0);var n=jc();let r;wn(Ke(n),()=>t.children),it(()=>r=Vn(n,"",r,{transform:`translate(${t.store.viewport.x??""}px, ${t.store.viewport.y??""}px) scale(${t.store.viewport.zoom??""})`})),pn(e,n),Y()}(i,{get store(){return k},set store(e){k=e},children:(e,n)=>{var o=xu(),i=Ze(We(o),2);su(i,{get onedgeclick(){return t.onedgeclick},get onedgecontextmenu(){return t.onedgecontextmenu},get onedgepointerenter(){return t.onedgepointerenter},get onedgepointerleave(){return t.onedgepointerleave},get store(){return k},set store(e){k=e}});var s=Ze(i,4);!function(e,t){X(t,!0);let n=xe(()=>{if(!t.store.connection.inProgress)return"";const e={sourceX:t.store.connection.from.x,sourceY:t.store.connection.from.y,sourcePosition:t.store.connection.fromPosition,targetX:t.store.connection.to.x,targetY:t.store.connection.to.y,targetPosition:t.store.connection.toPosition};switch(t.type){case xa.Bezier:{const[t]=vl(e);return t}case xa.Straight:{const[t]=Cl(e);return t}case xa.Step:case xa.SmoothStep:{const[n]=Ml({...e,borderRadius:t.type===xa.Step?0:void 0});return n}}});var r=hn(),o=We(r),i=e=>{var r=yu(),o=Ke(r),i=Ke(o),s=e=>{var n=hn();On(We(n),()=>t.LineComponent,(e,t)=>{t(e,{})}),pn(e,n)},a=e=>{var r=gu();it(()=>{Jn(r,"d",Kt(n)),Vn(r,t.style)}),pn(e,r)};_n(i,e=>{t.LineComponent?e(s):e(a,!1)}),it(e=>{Jn(r,"width",t.store.width),Jn(r,"height",t.store.height),Vn(r,t.containerStyle),Fn(o,0,e)},[()=>{return In(["svelte-flow__connection",(e=t.store.connection.isValid,null===e?null:e?"valid":"invalid")]);var e}]),pn(e,r)};_n(o,e=>{t.store.connection.inProgress&&e(i)}),pn(e,r),Y()}(s,{get type(){return f()},get LineComponent(){return t.connectionLineComponent},get containerStyle(){return t.connectionLineContainerStyle},get style(){return t.connectionLineStyle},get store(){return k},set store(e){k=e}});var a=Ze(s,2);!function(e,t){X(t,!0);let n=yr(t,"store",15);const r="undefined"==typeof ResizeObserver?null:new ResizeObserver(e=>{const t=new Map;e.forEach(e=>{const n=e.target.getAttribute("data-id");t.set(n,{id:n,nodeElement:e.target,force:!0})}),n().updateNodeInternals(t)});Cn(()=>{r?.disconnect()});var o=Yc();Sn(o,21,()=>n().visible.nodes.values(),e=>e.id,(e,o)=>{Xc(e,{get node(){return Kt(o)},get resizeObserver(){return r},get nodeClickDistance(){return t.nodeClickDistance},get onnodeclick(){return t.onnodeclick},get onnodepointerenter(){return t.onnodepointerenter},get onnodepointermove(){return t.onnodepointermove},get onnodepointerleave(){return t.onnodepointerleave},get onnodedrag(){return t.onnodedrag},get onnodedragstart(){return t.onnodedragstart},get onnodedragstop(){return t.onnodedragstop},get onnodecontextmenu(){return t.onnodecontextmenu},get store(){return n()},set store(e){n(e)}})}),pn(e,o),Y()}(a,{get nodeClickDistance(){return r()},get onnodeclick(){return t.onnodeclick},get onnodecontextmenu(){return t.onnodecontextmenu},get onnodepointerenter(){return t.onnodepointerenter},get onnodepointermove(){return t.onnodepointermove},get onnodepointerleave(){return t.onnodepointerleave},get onnodedrag(){return t.onnodedrag},get onnodedragstart(){return t.onnodedragstart},get onnodedragstop(){return t.onnodedragstop},get store(){return k},set store(e){k=e}}),uu(Ze(a,2),{get onselectionclick(){return t.onselectionclick},get onselectioncontextmenu(){return t.onselectioncontextmenu},get onnodedrag(){return t.onnodedrag},get onnodedragstart(){return t.onnodedragstart},get onnodedragstop(){return t.onnodedragstop},get store(){return k},set store(e){k=e}}),pn(e,o)},$$slots:{default:!0}});var s=Ze(i,2);{let e=xe(()=>!(!k.selectionRect||"user"!==k.selectionRectMode)),t=xe(()=>k.selectionRect?.width),n=xe(()=>k.selectionRect?.height),r=xe(()=>k.selectionRect?.x),o=xe(()=>k.selectionRect?.y);lu(s,{get isVisible(){return Kt(e)},get width(){return Kt(t)},get height(){return Kt(n)},get x(){return Kt(r)},get y(){return Kt(o)}})}pn(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var b=Ze(v,2);!function(e,t){X(t,!0);let n=yr(t,"position",3,"bottom-right");var r=hn(),o=We(r),i=e=>{ku(e,{get position(){return n()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(e,t)=>{pn(e,bu())},$$slots:{default:!0}})};_n(o,e=>{t.proOptions?.hideAttribution||e(i)}),pn(e,r),Y()}(b,{get proOptions(){return t.proOptions},get position(){return t.attributionPosition}});var w=Ze(b,2);!function(e,t){X(t,!0);var n=Wc(),r=We(n),o=Ke(r),i=Ze(r,2),s=Ke(i),a=Ze(i,2),l=e=>{var n=Kc(),r=Ke(n);it(()=>{Jn(n,"id",`${Jc}-${t.store.flowId}`),kn(r,t.store.ariaLiveMessage)}),pn(e,n)};_n(a,e=>{t.store.disableKeyboardA11y||e(l)}),it(()=>{Jn(r,"id",`${Zc}-${t.store.flowId}`),kn(o,t.store.disableKeyboardA11y?t.store.ariaLabelConfig["node.a11yDescription.default"]:t.store.ariaLabelConfig["node.a11yDescription.keyboardDisabled"]),Jn(i,"id",`${Uc}-${t.store.flowId}`),kn(s,t.store.ariaLabelConfig["edge.a11yDescription.default"])}),pn(e,n),Y()}(w,{get store(){return k}}),wn(Ze(w,2),()=>t.children??p),pn(e,g)},$$slots:{default:!0}}),Y()}var Eu=cn("<button><!></button>");function Mu(e,t){let n=fr(t,["$$slots","$$events","$$legacy","class","bgColor","bgColorHover","color","colorHover","borderColor","onclick","children"]);var r=Eu();Gn(r,()=>({type:"button",onclick:t.onclick,class:["svelte-flow__controls-button",t.class],...n,[Kn]:{"--xy-controls-button-background-color-props":t.bgColor,"--xy-controls-button-background-color-hover-props":t.bgColorHover,"--xy-controls-button-color-props":t.color,"--xy-controls-button-color-hover-props":t.colorHover,"--xy-controls-button-border-color-props":t.borderColor}})),wn(Ke(r),()=>t.children??p),pn(e,r)}var Au=dn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"></path></svg>');var Du=dn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 5"><path d="M0 0h32v4.2H0z"></path></svg>');var Tu=dn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 30"><path d="M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"></path></svg>');var Ou=dn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"></path></svg>');var Nu=dn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"></path></svg>');var Pu,zu,Iu=cn("<!> <!>",1),Lu=cn("<!> <!> <!> <!> <!> <!>",1);function $u(e,t){X(t,!0);let n=yr(t,"position",3,"bottom-left"),r=yr(t,"orientation",3,"vertical"),o=yr(t,"showZoom",3,!0),i=yr(t,"showFitView",3,!0),s=yr(t,"showLock",3,!0),a=fr(t,["$$slots","$$events","$$legacy","position","orientation","showZoom","showFitView","showLock","style","class","buttonBgColor","buttonBgColorHover","buttonColor","buttonColorHover","buttonBorderColor","fitViewOptions","children","before","after"]),l=xe(Pc);const c={bgColor:t.buttonBgColor,bgColorHover:t.buttonBgColorHover,color:t.buttonColor,colorHover:t.buttonColorHover,borderColor:t.buttonBorderColor};let u=xe(()=>Kt(l).nodesDraggable||Kt(l).nodesConnectable||Kt(l).elementsSelectable),d=xe(()=>Kt(l).viewport.zoom<=Kt(l).minZoom),h=xe(()=>Kt(l).viewport.zoom>=Kt(l).maxZoom),p=xe(()=>Kt(l).ariaLabelConfig),f=xe(()=>"horizontal"===r()?"horizontal":"vertical");const m=()=>{Kt(l).zoomIn()},g=()=>{Kt(l).zoomOut()},y=()=>{Kt(l).fitView(t.fitViewOptions)},v=()=>{let e=!Kt(u);Kt(l).nodesDraggable=e,Kt(l).nodesConnectable=e,Kt(l).elementsSelectable=e};{let r=xe(()=>["svelte-flow__controls",Kt(f),t.class]);ku(e,gr({get class(){return Kt(r)},get position(){return n()},"data-testid":"svelte-flow__controls",get"aria-label"(){return Kt(p)["controls.ariaLabel"]},get style(){return t.style}},()=>a,{children:(e,n)=>{var r=Lu(),a=We(r),l=e=>{var n=hn();wn(We(n),()=>t.before),pn(e,n)};_n(a,e=>{t.before&&e(l)});var f=Ze(a,2),k=e=>{var t=Iu(),n=We(t);Mu(n,gr({onclick:m,class:"svelte-flow__controls-zoomin",get title(){return Kt(p)["controls.zoomIn.ariaLabel"]},get"aria-label"(){return Kt(p)["controls.zoomIn.ariaLabel"]},get disabled(){return Kt(h)}},()=>c,{children:(e,t)=>{!function(e){pn(e,Au())}(e)},$$slots:{default:!0}})),Mu(Ze(n,2),gr({onclick:g,class:"svelte-flow__controls-zoomout",get title(){return Kt(p)["controls.zoomOut.ariaLabel"]},get"aria-label"(){return Kt(p)["controls.zoomOut.ariaLabel"]},get disabled(){return Kt(d)}},()=>c,{children:(e,t)=>{!function(e){pn(e,Du())}(e)},$$slots:{default:!0}})),pn(e,t)};_n(f,e=>{o()&&e(k)});var b=Ze(f,2),w=e=>{Mu(e,gr({class:"svelte-flow__controls-fitview",onclick:y,get title(){return Kt(p)["controls.fitView.ariaLabel"]},get"aria-label"(){return Kt(p)["controls.fitView.ariaLabel"]}},()=>c,{children:(e,t)=>{!function(e){pn(e,Tu())}(e)},$$slots:{default:!0}}))};_n(b,e=>{i()&&e(w)});var x=Ze(b,2),C=e=>{Mu(e,gr({class:"svelte-flow__controls-interactive",onclick:v,get title(){return Kt(p)["controls.interactive.ariaLabel"]},get"aria-label"(){return Kt(p)["controls.interactive.ariaLabel"]}},()=>c,{children:(e,t)=>{var n=hn(),r=We(n),o=e=>{!function(e){pn(e,Nu())}(e)},i=e=>{!function(e){pn(e,Ou())}(e)};_n(r,e=>{Kt(u)?e(o):e(i,!1)}),pn(e,n)},$$slots:{default:!0}}))};_n(x,e=>{s()&&e(C)});var _=Ze(x,2),S=e=>{var n=hn();wn(We(n),()=>t.children),pn(e,n)};_n(_,e=>{t.children&&e(S)});var E=Ze(_,2),M=e=>{var n=hn();wn(We(n),()=>t.after),pn(e,n)};_n(E,e=>{t.after&&e(M)}),pn(e,r)},$$slots:{default:!0}}))}Y()}(zu=Pu||(Pu={})).Lines="lines",zu.Dots="dots",zu.Cross="cross";var Ru=dn("<circle></circle>");var Fu=dn("<path></path>");const Bu={[Pu.Dots]:1,[Pu.Lines]:1,[Pu.Cross]:6};var Vu=dn('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function Hu(e,t){X(t,!0);let n=yr(t,"variant",19,()=>Pu.Dots),r=yr(t,"gap",3,20),o=yr(t,"lineWidth",3,1),i=xe(Pc),s=xe(()=>n()===Pu.Dots),a=xe(()=>n()===Pu.Cross),l=xe(()=>Array.isArray(r())?r():[r(),r()]),c=xe(()=>`background-pattern-${Kt(i).flowId}-${t.id??""}`),u=xe(()=>[Kt(l)[0]*Kt(i).viewport.zoom||1,Kt(l)[1]*Kt(i).viewport.zoom||1]),d=xe(()=>(t.size??Bu[n()])*Kt(i).viewport.zoom),h=xe(()=>Kt(a)?[Kt(d),Kt(d)]:Kt(u)),p=xe(()=>Kt(s)?[Kt(d)/2,Kt(d)/2]:[Kt(h)[0]/2,Kt(h)[1]/2]);var f=Vu();let m;var g=Ke(f),y=Ke(g),v=e=>{{let n=xe(()=>Kt(d)/2);!function(e,t){var n=Ru();it(()=>{Jn(n,"cx",t.radius),Jn(n,"cy",t.radius),Jn(n,"r",t.radius),Fn(n,0,In(["svelte-flow__background-pattern","dots",t.class]))}),pn(e,n)}(e,{get radius(){return Kt(n)},get class(){return t.patternClass}})}},k=e=>{!function(e,t){X(t,!0);var n=Fu();it(()=>{Jn(n,"stroke-width",t.lineWidth),Jn(n,"d",`M${t.dimensions[0]/2} 0 V${t.dimensions[1]} M0 ${t.dimensions[1]/2} H${t.dimensions[0]}`),Fn(n,0,In(["svelte-flow__background-pattern",t.variant,t.class]))}),pn(e,n),Y()}(e,{get dimensions(){return Kt(h)},get variant(){return n()},get lineWidth(){return o()},get class(){return t.patternClass}})};_n(y,e=>{Kt(s)?e(v):e(k,!1)});var b=Ze(g);it(()=>{Fn(f,0,In(["svelte-flow__background","svelte-flow__container",t.class])),m=Vn(f,"",m,{"--xy-background-color-props":t.bgColor,"--xy-background-pattern-color-props":t.patternColor}),Jn(g,"id",Kt(c)),Jn(g,"x",Kt(i).viewport.x%Kt(u)[0]),Jn(g,"y",Kt(i).viewport.y%Kt(u)[1]),Jn(g,"width",Kt(u)[0]),Jn(g,"height",Kt(u)[1]),Jn(g,"patternTransform",`translate(-${Kt(p)[0]},-${Kt(p)[1]})`),Jn(b,"fill",`url(#${Kt(c)})`)}),pn(e,f),Y()}var ju=dn("<rect></rect>");function qu(e,t){const n=function({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=Lo(e);return{update:function({translateExtent:e,width:i,height:s,zoomStep:a=1,pannable:l=!0,zoomable:c=!0,inversePan:u=!1}){let d=[0,0];const h=aa().on("start",e=>{"mousedown"!==e.sourceEvent.type&&"touchstart"!==e.sourceEvent.type||(d=[e.sourceEvent.clientX??e.sourceEvent.touches[0].clientX,e.sourceEvent.clientY??e.sourceEvent.touches[0].clientY])}).on("zoom",l?o=>{const a=n();if("mousemove"!==o.sourceEvent.type&&"touchmove"!==o.sourceEvent.type||!t)return;const l=[o.sourceEvent.clientX??o.sourceEvent.touches[0].clientX,o.sourceEvent.clientY??o.sourceEvent.touches[0].clientY],c=[l[0]-d[0],l[1]-d[1]];d=l;const h=r()*Math.max(a[2],Math.log(a[2]))*(u?-1:1),p={x:a[0]-c[0]*h,y:a[1]-c[1]*h},f=[[0,0],[i,s]];t.setViewportConstrained({x:p.x,y:p.y,zoom:a[2]},f,e)}:null).on("zoom.wheel",c?e=>{if("wheel"!==e.sourceEvent.type||!t)return;const r=n(),o=e.sourceEvent.ctrlKey&&ol()?10:1,i=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*a,s=r[2]*Math.pow(2,i*o);t.scaleTo(s)}:null);o.call(h,{})},destroy:function(){o.on("zoom",null)},pointer:$o}}({domNode:e,panZoom:t.panZoom,getTransform:()=>{const{viewport:e}=t.store;return[e.x,e.y,e.zoom]},getViewScale:t.getViewScale});return n.update({translateExtent:t.translateExtent,width:t.width,height:t.height,inversePan:t.inversePan,zoomStep:t.zoomStep,pannable:t.pannable,zoomable:t.zoomable}),{update:function(e){n.update({translateExtent:e.translateExtent,width:e.width,height:e.height,inversePan:e.inversePan,zoomStep:e.zoomStep,pannable:e.pannable,zoomable:e.zoomable})},destroy(){n.destroy()}}}const Ku=e=>e instanceof Function?e:()=>e;var Wu=dn("<title> </title>"),Zu=dn('<svg class="svelte-flow__minimap-svg" role="img"><!><!><path class="svelte-flow__minimap-mask" fill-rule="evenodd" pointer-events="none"></path></svg>'),Uu=cn('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Ju(e,t){X(t,!0);let n=yr(t,"position",3,"bottom-right"),r=yr(t,"nodeStrokeColor",3,"transparent"),o=yr(t,"nodeClass",3,""),i=yr(t,"nodeBorderRadius",3,5),s=yr(t,"nodeStrokeWidth",3,2),a=yr(t,"width",3,200),l=yr(t,"height",3,150),c=yr(t,"pannable",3,!0),u=yr(t,"zoomable",3,!0),d=fr(t,["$$slots","$$events","$$legacy","position","ariaLabel","nodeStrokeColor","nodeColor","nodeClass","nodeBorderRadius","nodeStrokeWidth","nodeComponent","bgColor","maskColor","maskStrokeColor","maskStrokeWidth","width","height","pannable","zoomable","inversePan","zoomStep","class"]),h=xe(Pc),p=xe(()=>Kt(h).ariaLabelConfig);const f=void 0===t.nodeColor?void 0:Ku(t.nodeColor),m=Ku(r()),g=Ku(o()),y="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";let v=xe(()=>`svelte-flow__minimap-desc-${Kt(h).flowId}`),k=xe(()=>({x:-Kt(h).viewport.x/Kt(h).viewport.zoom,y:-Kt(h).viewport.y/Kt(h).viewport.zoom,width:Kt(h).width/Kt(h).viewport.zoom,height:Kt(h).height/Kt(h).viewport.zoom})),b=xe(()=>Ua(Pa(Kt(h).nodeLookup,{filter:e=>!e.hidden}),Kt(k))),w=xe(()=>Kt(b).width/a()),x=xe(()=>Kt(b).height/l()),C=xe(()=>Math.max(Kt(w),Kt(x))),_=xe(()=>Kt(C)*a()),S=xe(()=>Kt(C)*l()),E=xe(()=>5*Kt(C)),M=xe(()=>Kt(b).x-(Kt(_)-Kt(b).width)/2-Kt(E)),A=xe(()=>Kt(b).y-(Kt(S)-Kt(b).height)/2-Kt(E)),D=xe(()=>Kt(_)+2*Kt(E)),T=xe(()=>Kt(S)+2*Kt(E));const O=()=>Kt(C);var N,P,z=Uu(),I=We(z);{let e=xe(()=>["svelte-flow__minimap",t.class]);N=I,P=()=>({"--xy-minimap-background-color-props":t.bgColor}),ot(()=>{var e=P();for(var t in e){var n=e[t];n?N.style.setProperty(t,n):N.style.removeProperty(t)}}),ku(I.lastChild,gr({get position(){return n()},get class(){return Kt(e)},"data-testid":"svelte-flow__minimap"},()=>d,{children:(e,n)=>{var r=hn(),o=We(r),d=e=>{var n=Zu();let r;var o=Ke(n),d=e=>{var n=Wu(),r=Ke(n);it(()=>{Jn(n,"id",Kt(v)),kn(r,t.ariaLabel??Kt(p)["minimap.ariaLabel"])}),pn(e,n)};_n(o,e=>{(t.ariaLabel??Kt(p)["minimap.ariaLabel"])&&e(d)});var b=Ze(o);Sn(b,17,()=>Kt(h).nodes,e=>e.id,(e,n)=>{const r=xe(()=>Kt(h).nodeLookup.get(Kt(n).id));var o=hn(),a=We(o),l=e=>{const n=xe(()=>sl(Kt(r)));{let o=xe(()=>f?.(Kt(r))),a=xe(()=>m(Kt(r))),l=xe(()=>g(Kt(r)));!function(e,t){let n=yr(t,"borderRadius",3,5),r=yr(t,"strokeWidth",3,2);var o=hn(),i=We(o),s=e=>{const o=xe(()=>t.nodeComponent);var i=hn();On(We(i),()=>Kt(o),(e,o)=>{o(e,{get id(){return t.id},get x(){return t.x},get y(){return t.y},get width(){return t.width},get height(){return t.height},get borderRadius(){return n()},get class(){return t.class},get color(){return t.color},get shapeRendering(){return t.shapeRendering},get strokeColor(){return t.strokeColor},get strokeWidth(){return r()},get selected(){return t.selected}})}),pn(e,i)},a=e=>{var o=ju();let i,s;it(()=>{i=Fn(o,0,In(["svelte-flow__minimap-node",t.class]),null,i,{selected:t.selected}),Jn(o,"x",t.x),Jn(o,"y",t.y),Jn(o,"rx",n()),Jn(o,"ry",n()),Jn(o,"width",t.width),Jn(o,"height",t.height),Jn(o,"shape-rendering",t.shapeRendering),s=Vn(o,"",s,{fill:t.color,stroke:t.strokeColor,"stroke-width":r()})}),pn(e,o)};_n(i,e=>{t.nodeComponent?e(s):e(a,!1)}),pn(e,o)}(e,gr({get id(){return Kt(r).id},get x(){return Kt(r).internals.positionAbsolute.x},get y(){return Kt(r).internals.positionAbsolute.y}},()=>Kt(n),{get selected(){return Kt(r).selected},get nodeComponent(){return t.nodeComponent},get color(){return Kt(o)},get borderRadius(){return i()},get strokeColor(){return Kt(a)},get strokeWidth(){return s()},get shapeRendering(){return y},get class(){return Kt(l)}}))}};_n(a,e=>{Kt(r)&&al(Kt(r))&&!Kt(r).hidden&&e(l)}),pn(e,o)});var w=Ze(b);Nn(n,(e,t)=>qu?.(e,t),()=>({store:Kt(h),panZoom:Kt(h).panZoom,getViewScale:O,translateExtent:Kt(h).translateExtent,width:Kt(h).width,height:Kt(h).height,inversePan:t.inversePan,zoomStep:t.zoomStep,pannable:c(),zoomable:u()})),it(()=>{Jn(n,"width",a()),Jn(n,"height",l()),Jn(n,"viewBox",`${Kt(M)??""} ${Kt(A)??""} ${Kt(D)??""} ${Kt(T)??""}`),Jn(n,"aria-labelledby",Kt(v)),r=Vn(n,"",r,{"--xy-minimap-mask-background-color-props":t.maskColor,"--xy-minimap-mask-stroke-color-props":t.maskStrokeColor,"--xy-minimap-mask-stroke-width-props":t.maskStrokeWidth?t.maskStrokeWidth*Kt(C):void 0}),Jn(w,"d",`M${Kt(M)-Kt(E)},${Kt(A)-Kt(E)}h${Kt(D)+2*Kt(E)}v${Kt(T)+2*Kt(E)}h${-Kt(D)-2*Kt(E)}z\n      M${Kt(k).x??""},${Kt(k).y??""}h${Kt(k).width??""}v${Kt(k).height??""}h${-Kt(k).width}z`)}),pn(e,n)};_n(o,e=>{Kt(h).panZoom&&e(d)}),pn(e,r)},$$slots:{default:!0}}))}pn(e,z),Y()}let Gu;try{Gu=acquireVsCodeApi()}catch(uA){console.warn("VSCode API not available, running in standalone mode"),Gu={postMessage:e=>console.log("Mock postMessage:",e),setState:e=>console.log("Mock setState:",e),getState:()=>null}}const Xu=cr([]),Yu=cr([]);let Qu,ed=[],td=[];function nd(){Qu&&clearTimeout(Qu),Qu=window.setTimeout(()=>{!function(){const e=(n=ed,r=td,{nodes:n.map(e=>({id:e.id,x:e.position.x,y:e.position.y,width:e.data?.width||250,height:e.data?.height||60,type:"file"===e.type?"file":"text",text:"file"===e.type?void 0:e.data?.text||e.data?.label||"",file:"file"===e.type?e.data?.file:void 0,color:e.data?.color})),edges:r.map(e=>({id:e.id,fromNode:e.source,fromSide:e.data?.fromSide||"right",toNode:e.target,toSide:e.data?.toSide||"left",color:e.data?.color,label:e.data?.label}))}),t=JSON.stringify(e,null,2);var n,r;Gu.postMessage({type:"save",content:t}),console.log("ð¾ Saved canvas to extension")}()},500)}function rd(e){this.content=e}function od(e,t,n){for(let r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;let o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(let e=0;o.text[e]==i.text[e];e++)n++;return n}if(o.content.size||i.content.size){let e=od(o.content,i.content,n+1);if(null!=e)return e}n+=o.nodeSize}else n+=o.nodeSize}}function id(e,t,n,r){for(let o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};let s=e.child(--o),a=t.child(--i),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){let e=0,t=Math.min(s.text.length,a.text.length);for(;e<t&&s.text[s.text.length-e-1]==a.text[a.text.length-e-1];)e++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){let e=id(s.content,a.content,n-1,r-1);if(e)return e}n-=l,r-=l}else n-=l,r-=l}}Xu.subscribe(e=>{ed=e,nd()}),Yu.subscribe(e=>{td=e,nd()}),window.addEventListener("message",e=>{const t=e.data;switch(t.type){case"loadContent":!function(e){try{const n=JSON.parse(e),{nodes:r,edges:o}={nodes:(t=n).nodes.map(e=>({id:e.id,type:"file"===e.type?"file":"text",position:{x:e.x,y:e.y},data:{label:e.text||e.file||"",text:e.text||"",file:e.file,width:e.width,height:e.height,color:e.color},style:e.width&&e.height?`width: ${e.width}px; height: ${e.height}px`:void 0})),edges:t.edges.map(e=>({id:e.id,source:e.fromNode,target:e.toNode,data:{fromSide:e.fromSide,toSide:e.toSide,color:e.color,label:e.label}}))};Xu.set(r),Yu.set(o),console.log("ð Loaded canvas:",r.length,"nodes,",o.length,"edges")}catch(n){console.error("Failed to load canvas:",n)}var t}(t.content);break;case"groqApiKey":console.log("ð Received API key")}}),Gu.postMessage({type:"ready"}),rd.prototype={constructor:rd,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new rd(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new rd(n)},addToStart:function(e,t){return new rd([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new rd(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new rd(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=rd.from(e)).size?new rd(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=rd.from(e)).size?new rd(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=rd.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},rd.from=function(e){if(e instanceof rd)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new rd(t)};class sd{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,r=0,o){for(let i=0,s=0;s<t;i++){let a=this.content[i],l=s+a.nodeSize;if(l>e&&!1!==n(a,r+s,o||null,i)&&a.content.size){let o=s+1;a.nodesBetween(Math.max(0,e-o),Math.min(a.content.size,t-o),n,r+o)}s=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let o="",i=!0;return this.nodesBetween(e,t,(s,a)=>{let l=s.isText?s.text.slice(Math.max(e,a)-a,t-a):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(i?i=!1:o+=n),o+=l},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new sd(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let o=0,i=0;i<t;o++){let s=this.content[o],a=i+s.nodeSize;a>e&&((i<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),r+=s.nodeSize),i=a}return new sd(n,r)}cutByIndex(e,t){return e==t?sd.empty:0==e&&t==this.content.length?this:new sd(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new sd(r,o)}addToStart(e){return new sd([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new sd(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return od(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return id(this,e,t,n)}findIndex(e){if(0==e)return ld(0,e);if(e==this.size)return ld(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,n=0;;t++){let r=n+this.child(t).nodeSize;if(r>=e)return r==e?ld(t+1,r):ld(t,n);n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return sd.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new sd(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return sd.empty;let t,n=0;for(let r=0;r<e.length;r++){let o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new sd(t||e,n)}static from(e){if(!e)return sd.empty;if(e instanceof sd)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new sd([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}sd.empty=new sd([],0);const ad={index:0,offset:0};function ld(e,t){return ad.index=e,ad.offset=t,ad}function cd(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!cd(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!cd(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let ud=class e{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&cd(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return e.none;if(t instanceof e)return[t];let n=t.slice();return n.sort((e,t)=>e.type.rank-t.type.rank),n}};ud.none=[];class dd extends Error{}class hd{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=fd(this.content,e+this.openStart,t);return n&&new hd(n,this.openStart,this.openEnd)}removeBetween(e,t){return new hd(pd(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return hd.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new hd(sd.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)r++;return new hd(e,n,r)}}function pd(e,t,n){let{index:r,offset:o}=e.findIndex(t),i=e.maybeChild(r),{index:s,offset:a}=e.findIndex(n);if(o==t||i.isText){if(a!=n&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(r,i.copy(pd(i.content,t-o-1,n-o-1)))}function fd(e,t,n,r){let{index:o,offset:i}=e.findIndex(t),s=e.maybeChild(o);if(i==t||s.isText)return r&&!r.canReplace(o,o,n)?null:e.cut(0,t).append(n).append(e.cut(t));let a=fd(s.content,t-i-1,n,s);return a&&e.replaceChild(o,s.copy(a))}function md(e,t,n){if(n.openStart>e.depth)throw new dd("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new dd("Inconsistent open depths");return gd(e,t,n,0)}function gd(e,t,n,r){let o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){let s=gd(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){let{start:o,end:s}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let o=n-1;o>=0;o--)r=t.node(o).copy(sd.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return wd(i,xd(e,o,s,t,r))}{let r=e.parent,o=r.content;return wd(r,o.cut(0,e.parentOffset).append(n.content).append(o.cut(t.parentOffset)))}}return wd(i,Cd(e,t,r))}function yd(e,t){if(!t.type.compatibleContent(e.type))throw new dd("Cannot join "+t.type.name+" onto "+e.type.name)}function vd(e,t,n){let r=e.node(n);return yd(r,t.node(n)),r}function kd(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function bd(e,t,n,r){let o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(kd(e.nodeAfter,r),i++));for(let a=i;a<s;a++)kd(o.child(a),r);t&&t.depth==n&&t.textOffset&&kd(t.nodeBefore,r)}function wd(e,t){return e.type.checkContent(t),e.copy(t)}function xd(e,t,n,r,o){let i=e.depth>o&&vd(e,t,o+1),s=r.depth>o&&vd(n,r,o+1),a=[];return bd(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(yd(i,s),kd(wd(i,xd(e,t,n,r,o+1)),a)):(i&&kd(wd(i,Cd(e,t,o+1)),a),bd(t,n,o,a),s&&kd(wd(s,Cd(n,r,o+1)),a)),bd(r,null,o,a),new sd(a)}function Cd(e,t,n){let r=[];if(bd(null,e,n,r),e.depth>n){kd(wd(vd(e,t,n+1),Cd(e,t,n+1)),r)}return bd(t,null,n,r),new sd(r)}hd.empty=new hd(sd.empty,0,0);class _d{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let o=0;o<e;o++)r+=n.child(o).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return ud.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new Ad(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],r=0,o=t;for(let i=e;;){let{index:e,offset:t}=i.content.findIndex(o),s=o-t;if(n.push(i,e,r+t),!s)break;if(i=i.child(e),i.isText)break;o=s-1,r+=t+1}return new _d(t,n,o)}static resolveCached(e,t){let n=Md.get(e);if(n)for(let o=0;o<n.elts.length;o++){let e=n.elts[o];if(e.pos==t)return e}else Md.set(e,n=new Sd);let r=n.elts[n.i]=_d.resolve(e,t);return n.i=(n.i+1)%Ed,r}}class Sd{constructor(){this.elts=[],this.i=0}}const Ed=12,Md=new WeakMap;class Ad{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Dd=Object.create(null);let Td=class e{constructor(e,t,n,r=ud.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||sd.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&cd(this.attrs,t||e.defaultAttrs||Dd)&&ud.sameSet(this.marks,n||ud.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return hd.empty;let r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new hd(a,r.depth-i,o.depth-i)}replace(e,t,n){return md(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return _d.resolveCached(this,e)}resolveNoCache(e){return _d.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Nd(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=sd.empty,r=0,o=n.childCount){let i=this.contentMatchAt(e).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(let a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ud.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!ud.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=sd.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,r,n);return o.type.checkAttrs(o.attrs),o}};Td.prototype.text=void 0;let Od=class e extends Td{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Nd(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}};function Nd(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class Pd{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new zd(e,t);if(null==n.next)return Pd.empty;let r=Id(n);n.next&&n.err("Unexpected trailing text");let o=function(e){let t=Object.create(null);return n(Vd(e,0));function n(r){let o=[];r.forEach(t=>{e[t].forEach(({term:t,to:n})=>{if(!t)return;let r;for(let e=0;e<o.length;e++)o[e][0]==t&&(r=o[e][1]);Vd(e,n).forEach(e=>{r||o.push([t,r=[]]),-1==r.indexOf(e)&&r.push(e)})})});let i=t[r.join(",")]=new Pd(r.indexOf(e.length-1)>-1);for(let e=0;e<o.length;e++){let r=o[e][1].sort(Bd);i.next.push({type:o[e][0],next:t[r.join(",")]||n(r)})}return i}}(function(e){let t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach(e=>e.to=t)}function i(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(i(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let s=n();return r(t,s),o(i(e.expr,s),s),[r(s)]}if("plus"==e.type){let s=n();return o(i(e.expr,t),s),o(i(e.expr,s),s),[r(s)]}if("opt"==e.type)return[r(t)].concat(i(e.expr,t));if("range"==e.type){let s=t;for(let t=0;t<e.min;t++){let t=n();o(i(e.expr,s),t),s=t}if(-1==e.max)o(i(e.expr,s),s);else for(let t=e.min;t<e.max;t++){let t=n();r(s,t),o(i(e.expr,s),t),s=t}return[r(s)]}if("name"==e.type)return[r(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let r=0;;r++){let s=i(e.exprs[r],t);if(r==e.exprs.length-1)return s;o(s,t=n())}}}(r));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],o=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:s}=e.next[t];i.push(n.name),!o||n.isText||n.hasRequiredAttrs()||(o=!1),-1==r.indexOf(s)&&r.push(s)}o&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function o(i,s){let a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return sd.from(s.map(e=>e.createAndFill()));for(let e=0;e<i.next.length;e++){let{type:t,next:n}=i.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==r.indexOf(n)){r.push(n);let e=o(n,s.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<o.next.length;e++){let{type:i,next:s}=o.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||r.type&&!s.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let o=0;o<t.next.length;o++)r+=(o?", ":"")+t.next[o].type.name+"->"+e.indexOf(t.next[o].next);return r}).join("\n")}}Pd.empty=new Pd(!0);class zd{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Id(e){let t=[];do{t.push(Ld(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function Ld(e){let t=[];do{t.push($d(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function $d(e){let t=function(e){if(e.eat("(")){let t=Id(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let o=[];for(let i in n){let e=n[i];e.isInGroup(t)&&o.push(e)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=Fd(e,t)}return t}function Rd(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function Fd(e,t){let n=Rd(e),r=n;return e.eat(",")&&(r="}"!=e.next?Rd(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Bd(e,t){return t-e}function Vd(e,t){let n=[];return function t(r){let o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(let e=0;e<o.length;e++){let{term:r,to:i}=o[e];r||-1!=n.indexOf(i)||t(i)}}(t),n.sort(Bd)}function Hd(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function jd(e,t){let n=Object.create(null);for(let r in e){let o=t&&t[r];if(void 0===o){let t=e[r];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=t.default}n[r]=o}return n}function qd(e,t,n,r){for(let o in t)if(!(o in e))throw new RangeError(`Unsupported attribute ${o} for ${n} of type ${o}`);for(let o in e){let n=e[o];n.validate&&n.validate(t[o])}}function Kd(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new Zd(e,r,t[r]);return n}let Wd=class e{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Kd(e,n.attrs),this.defaultAttrs=Hd(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Pd.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:jd(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Td(this,this.computeAttrs(e),sd.from(t),ud.setFrom(n))}createChecked(e=null,t,n){return t=sd.from(t),this.checkContent(t),new Td(this,this.computeAttrs(e),t,ud.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=sd.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),o=r&&r.fillBefore(sd.empty,!0);return o?new Td(this,e,t.append(o),ud.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){qd(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:ud.none:e}static compile(t,n){let r=Object.create(null);t.forEach((t,o)=>r[t]=new e(t,n,o));let o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let e in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class Zd{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let o=null===n?"null":typeof n;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${o}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Ud{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=Kd(e,r.attrs),this.excluded=null;let o=Hd(this.attrs);this.instance=o?new ud(this,o):null}create(e=null){return!e&&this.instance?this.instance:new ud(this,jd(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,o)=>n[e]=new Ud(e,r++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){qd(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Jd{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=rd.from(e.nodes),t.marks=rd.from(e.marks||{}),this.nodes=Wd.compile(this.spec.nodes,this),this.marks=Ud.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let e=this.nodes[r],t=e.spec.content||"",o=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=Pd.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==o?null:o?Gd(this,o.split(" ")):""!=o&&e.inlineContent?null:[]}for(let r in this.marks){let e=this.marks[r],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:Gd(this,t.split(" "))}this.nodeFromJSON=e=>Td.fromJSON(this,e),this.markFromJSON=e=>ud.fromJSON(this,e),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Wd))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new Od(n,n.defaultAttrs,e,ud.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Gd(e,t){let n=[];for(let r=0;r<t.length;r++){let o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(let t in e.marks){let r=e.marks[t];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=r)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class Xd{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new rh(this,t,!1);return n.addAll(e,ud.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new rh(this,t,!0);return n.addAll(e,ud.none,t.from,t.to),hd.maxOpen(n.finish())}matchTag(e,t,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let n=this.tags[r];if(oh(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(!(0!=i.indexOf(e)||r.context&&!n.matchesContext(r.context)||i.length>e.length&&(61!=i.charCodeAt(e.length)||i.slice(e.length+1)!=t))){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let r in e.marks){let t=e.marks[r].spec.parseDOM;t&&t.forEach(e=>{n(e=ih(e)),e.mark||e.ignore||e.clearMark||(e.mark=r)})}for(let r in e.nodes){let t=e.nodes[r].spec.parseDOM;t&&t.forEach(e=>{n(e=ih(e)),e.node||e.ignore||e.mark||(e.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Xd(e,Xd.schemaRules(e)))}}const Yd={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Qd={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},eh={ol:!0,ul:!0};function th(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class nh{constructor(e,t,n,r,o,i){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=ud.none,this.match=o||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(sd.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=sd.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(sd.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Yd.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class rh{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r,o=t.topNode,i=th(null,t.preserveWhitespace,0)|(n?4:0);r=o?new nh(o.type,o.attrs,ud.none,!0,t.topMatch||o.type.contentMatch,i):new nh(n?null:e.schema.topNodeType,null,ud.none,!0,null,i),this.nodes=[r],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0,{schema:i}=this.parser;if("full"===o||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)if("full"===o)n=n.replace(/\r\n?/g,"\n");else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let e=n.split(/\r?\n|\r/);for(let n=0;n<e.length;n++)n&&this.insertNode(i.linebreakReplacement.create(),t,!0),e[n]&&this.insertNode(i.text(e[n]),t,!/\S/.test(e[n]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],o=e.previousSibling;(!t||o&&"BR"==o.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,o=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i,s=e.nodeName.toLowerCase();eh.hasOwnProperty(s)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&eh.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));e:if(a?a.ignore:Qd.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,r=this.needsBlock;if(Yd.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let i=a&&a.skip?t:this.readStyles(e,t);i&&this.addAll(e,i),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?i:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let e=this.parser.matchedStyles[r],o=n.getPropertyValue(e);if(o)for(let n;;){let r=this.parser.matchStyle(e,o,this,n);if(!r)break;if(r.ignore)return null;if(t=r.clearMark?t.filter(e=>!r.clearMark(e)):t.concat(this.parser.schema.marks[r.mark].create(r.attrs)),!1!==r.consuming)break;n=r}}return t}addElementByRule(e,t,n,r){let o,i;if(t.node)if(i=this.parser.schema.nodes[t.node],i.isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(o=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let s=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}o&&this.sync(s)&&this.open--}addAll(e,t,n,r){let o=n||0;for(let i=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i,t);this.findAtPoint(e,o)}findPlace(e,t,n){let r,o;for(let i=this.open,s=0;i>=0;i--){let t=this.nodes[i],a=t.findWrapping(e);if(a&&(!r||r.length>a.length+s)&&(r=a,o=t,!a.length))break;if(t.solid){if(n)break;s+=2}}if(!r)return null;this.sync(o);for(let i=0;i<r.length;i++)t=this.enterInner(r[i],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=ud.none;for(let o of r.concat(e.marks))(t.type?t.type.allowsMarkType(o.type):sh(o.type,e.type))&&(n=o.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let o=this.findPlace(e.create(t),n,!1);return o&&(o=this.enterInner(e,t,n,!0,r)),o}enterInner(e,t,n,r=!1,o){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let s=th(e,o,i.options);4&i.options&&0==i.content.length&&(s|=4);let a=ud.none;return n=n.filter(t=>!(i.type?i.type.allowsMarkType(t.type):sh(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new nh(e,t,a,r,null,s)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)){t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),i=(e,s)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;s>=o;s--)if(i(e-1,s))return!0;return!1}{let e=s>0||0==s&&r?this.nodes[s].type:n&&s>=o?n.node(s-o).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;s--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function oh(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function ih(e){let t={};for(let n in e)t[n]=e[n];return t}function sh(e,t){let n=t.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(e))continue;let i=[],s=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:o}=e.edge(n);if(r==t)return!0;if(i.indexOf(o)<0&&s(o))return!0}};if(s(o.contentMatch))return!0}}class ah{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=ch(t).createDocumentFragment());let r=n,o=[];return e.forEach(e=>{if(o.length||e.marks.length){let n=0,i=0;for(;n<o.length&&i<e.marks.length;){let t=e.marks[i];if(this.marks[t.type.name]){if(!t.eq(o[n][0])||!1===t.type.spec.spanning)break;n++,i++}else i++}for(;n<o.length;)r=o.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],s=this.serializeMark(n,e.isInline,t);s&&(o.push([n,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=hh(ch(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&hh(ch(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return hh(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ah(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=lh(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return lh(e.marks)}}function lh(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function ch(e){return e.document||window.document}const uh=new WeakMap;function dh(e){let t=uh.get(e);return void 0===t&&uh.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function hh(e,t,n,r){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let o,i=t[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=dh(r))&&o.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s,a=i.indexOf(" ");a>0&&(n=i.slice(0,a),i=i.slice(a+1));let l=n?e.createElementNS(n,i):e.createElement(i),c=t[1],u=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){u=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):"style"==e&&l.style?l.style.cssText=c[e]:l.setAttribute(e,c[e])}}for(let d=u;d<t.length;d++){let o=t[d];if(0===o){if(d<t.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:i}=hh(e,o,n,r);if(l.appendChild(t),i){if(s)throw new RangeError("Multiple content holes");s=i}}}return{dom:l,contentDOM:s}}const ph=Math.pow(2,16);function fh(e,t){return e+t*ph}function mh(e){return 65535&e}class gh{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class yh{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&yh.empty)return yh.empty}recover(e){let t=0,n=mh(e);if(!this.inverted)for(let r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/ph}(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?r:0);if(a>e)break;let l=this.ranges[s+o],c=this.ranges[s+i],u=a+l;if(e<=u){let o=a+r+((l?e==a?-1:e==u?1:t:t)<0?0:c);if(n)return o;let i=e==(t<0?a:u)?null:fh(s/3,e-a),d=e==a?2:e==u?1:4;return(t<0?e!=a:e!=u)&&(d|=8),new gh(o,d,i)}r+=c-l}return n?e+r:new gh(e+r,0,null)}touches(e,t){let n=0,r=mh(t),o=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let t=this.ranges[s]-(this.inverted?n:0);if(t>e)break;let a=this.ranges[s+o];if(e<=t+a&&s==3*r)return!0;n+=this.ranges[s+i]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),l=this.ranges[r+t],c=this.ranges[r+n];e(s,s+l,a,a+c),o+=c-l}}invert(){return new yh(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?yh.empty:new yh(e<0?[0,-e,0]:[0,0,e])}}yh.empty=new yh([]);class vh{constructor(e,t,n=0,r=(e?e.length:0)){this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new vh(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new vh;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let o=this.from;o<this.to;o++){let n=this._maps[o].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(o);if(null!=t&&t>o&&t<this.to){o=t,e=this._maps[t].recover(n.recover);continue}}r|=n.delInfo,e=n.pos}return n?e:new gh(e,r,null)}}const kh=Object.create(null);class bh{getMap(){return yh.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=kh[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in kh)throw new RangeError("Duplicate use of step JSON ID "+e);return kh[e]=t,t.prototype.jsonID=e,t}}class wh{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new wh(e,null)}static fail(e){return new wh(null,e)}static fromReplace(e,t,n,r){try{return wh.ok(e.replace(t,n,r))}catch(uA){if(uA instanceof dd)return wh.fail(uA.message);throw uA}}}function xh(e,t,n){let r=[];for(let o=0;o<e.childCount;o++){let i=e.child(o);i.content.size&&(i=i.copy(xh(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return sd.fromArray(r)}class Ch extends bh{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new hd(xh(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return wh.fromReplace(e,this.from,this.to,o)}invert(){return new _h(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Ch(t.pos,n.pos,this.mark)}merge(e){return e instanceof Ch&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ch(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ch(t.from,t.to,e.markFromJSON(t.mark))}}bh.jsonID("addMark",Ch);class _h extends bh{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new hd(xh(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return wh.fromReplace(e,this.from,this.to,n)}invert(){return new Ch(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new _h(t.pos,n.pos,this.mark)}merge(e){return e instanceof _h&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new _h(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new _h(t.from,t.to,e.markFromJSON(t.mark))}}bh.jsonID("removeMark",_h);class Sh extends bh{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return wh.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return wh.fromReplace(e,this.pos,this.pos+1,new hd(sd.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new Sh(this.pos,t.marks[n]);return new Sh(this.pos,this.mark)}}return new Eh(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Sh(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Sh(t.pos,e.markFromJSON(t.mark))}}bh.jsonID("addNodeMark",Sh);class Eh extends bh{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return wh.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return wh.fromReplace(e,this.pos,this.pos+1,new hd(sd.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new Sh(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Eh(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Eh(t.pos,e.markFromJSON(t.mark))}}bh.jsonID("removeNodeMark",Eh);class Mh extends bh{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&Dh(e,this.from,this.to)?wh.fail("Structure replace would overwrite content"):wh.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new yh([this.from,this.to-this.from,this.slice.size])}invert(e){return new Mh(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new Mh(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Mh)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?hd.empty:new hd(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Mh(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?hd.empty:new hd(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Mh(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Mh(t.from,t.to,hd.fromJSON(e,t.slice),!!t.structure)}}bh.jsonID("replace",Mh);class Ah extends bh{constructor(e,t,n,r,o,i,s=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=s}apply(e){if(this.structure&&(Dh(e,this.from,this.gapFrom)||Dh(e,this.gapTo,this.to)))return wh.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return wh.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?wh.fromReplace(e,this.from,this.to,n):wh.fail("Content does not fit in gap")}getMap(){return new yh([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ah(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||o>n.pos?null:new Ah(t.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ah(t.from,t.to,t.gapFrom,t.gapTo,hd.fromJSON(e,t.slice),t.insert,!!t.structure)}}function Dh(e,t,n){let r=e.resolve(t),o=n-t,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let e=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,o--}}return!1}function Th(e,t,n,r=n.contentMatch,o=!0){let i=e.doc.nodeAt(t),s=[],a=t+1;for(let l=0;l<i.childCount;l++){let t=i.child(l),c=a+t.nodeSize,u=r.matchType(t.type);if(u){r=u;for(let r=0;r<t.marks.length;r++)n.allowsMarkType(t.marks[r].type)||e.step(new _h(a,c,t.marks[r]));if(o&&t.isText&&"pre"!=n.whitespace){let e,r,o=/\r?\n|\r/g;for(;e=o.exec(t.text);)r||(r=new hd(sd.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),s.push(new Mh(a+e.index,a+e.index+e[0].length,r))}}else s.push(new Mh(a,c,hd.empty));a=c}if(!r.validEnd){let t=r.fillBefore(sd.empty,!0);e.replace(a,a,new hd(t,0,0))}for(let l=s.length-1;l>=0;l--)e.step(s[l])}function Oh(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function Nh(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!Oh(r,o,i))break}return null}function Ph(e,t,n=null,r=e){let o=function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;let s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}(e,t),i=o&&function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;let a=(s.length?s[s.length-1]:t).contentMatch;for(let l=r;a&&l<o;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?s:null}(r,t);return i?o.map(zh).concat({type:t,attrs:n}).concat(i.map(zh)):null}function zh(e){return{type:e,attrs:null}}function Ih(e,t,n,r){t.forEach((o,i)=>{if(o.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(o.text);){let o=e.mapping.slice(r).map(n+1+i+s.index);e.replaceWith(o,o+1,t.type.schema.linebreakReplacement.create())}}})}function Lh(e,t,n,r){t.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=e.mapping.slice(r).map(n+1+i);e.replaceWith(o,o+1,t.type.schema.text("\n"))}})}function $h(e,t,n=1,r){let o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,u=n-2;c>i;c--,u--){let e=o.node(c),t=o.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),i=r&&r[u+1];i&&(n=n.replaceChild(0,i.type.create(i.attrs)));let s=r&&r[u]||e;if(!e.canReplace(t+1,e.childCount)||!s.type.validContent(n))return!1}let a=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(a,a,l?l.type:o.node(i+1).type)}function Rh(e,t){let n=e.resolve(t),r=n.index();return Fh(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Fh(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let o=0;o<t.childCount;o++){let i=t.child(o),s=i.type==r?e.type.schema.nodes.text:i.type;if(n=n.matchType(s),!n)return!1;if(!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}function Bh(e,t,n=-1){let r=e.resolve(t);for(let o=r.depth;;o--){let e,i,s=r.index(o);if(o==r.depth?(e=r.nodeBefore,i=r.nodeAfter):n>0?(e=r.node(o+1),s++,i=r.node(o).maybeChild(s)):(e=r.node(o).maybeChild(s-1),i=r.node(o+1)),e&&!e.isTextblock&&Fh(e,i)&&r.node(o).canReplace(s,s+1))return t;if(0==o)break;t=n<0?r.before(o):r.after(o)}}function Vh(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let o=n.content;for(let i=0;i<n.openStart;i++)o=o.firstChild.content;for(let i=1;i<=(0==n.openStart&&n.size?2:1);i++)for(let e=r.depth;e>=0;e--){let t=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,n=r.index(e)+(t>0?1:0),s=r.node(e),a=!1;if(1==i)a=s.canReplace(n,n,o);else{let e=s.contentMatchAt(n).findWrapping(o.firstChild.type);a=e&&s.canReplaceWith(n,n,e[0])}if(a)return 0==t?r.pos:t<0?r.before(e+1):r.after(e+1)}return null}function Hh(e,t,n=t,r=hd.empty){if(t==n&&!r.size)return null;let o=e.resolve(t),i=e.resolve(n);return jh(o,i,r)?new Mh(t,n,r):new qh(o,i,r).fit()}function jh(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}bh.jsonID("replaceAround",Ah);class qh{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=sd.empty;for(let r=0;r<=e.depth;r++){let t=e.node(r);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=sd.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let o=this.placed,i=n.depth,s=r.depth;for(;i&&s&&1==o.childCount;)o=o.firstChild.content,i--,s--;let a=new hd(o,i,s);return e>-1?new Ah(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new Mh(n.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,r=null;n?(r=Zh(this.unplaced.content,n-1).firstChild,e=r.content):e=this.unplaced.content;let o=e.firstChild;for(let i=this.depth;i>=0;i--){let e,{type:s,match:a}=this.frontier[i],l=null;if(1==t&&(o?a.matchType(o.type)||(l=a.fillBefore(sd.from(o),!1)):r&&s.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:i,parent:r,inject:l};if(2==t&&o&&(e=a.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:i,parent:r,wrap:e};if(r&&a.matchType(r.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Zh(e,t);return!(!r.childCount||r.firstChild.isLeaf)&&(this.unplaced=new hd(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Zh(e,t);if(r.childCount<=1&&t>0){let o=e.size-t<=t+r.size;this.unplaced=new hd(Kh(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new hd(Kh(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let f=0;f<o.length;f++)this.openFrontierNode(o[f]);let i=this.unplaced,s=n?n.content:i.content,a=i.openStart-e,l=0,c=[],{match:u,type:d}=this.frontier[t];if(r){for(let e=0;e<r.childCount;e++)c.push(r.child(e));u=u.matchFragment(r)}let h=s.size+e-(i.content.size-i.openEnd);for(;l<s.childCount;){let e=s.child(l),t=u.matchType(e.type);if(!t)break;l++,(l>1||0==a||e.content.size)&&(u=t,c.push(Uh(e.mark(d.allowedMarks(e.marks)),1==l?a:0,l==s.childCount?h:-1)))}let p=l==s.childCount;p||(h=-1),this.placed=Wh(this.placed,t,sd.from(c)),this.frontier[t].match=u,p&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=s;f<h;f++){let e=m.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),m=e.content}this.unplaced=p?0==e?hd.empty:new hd(Kh(i.content,e-1,1),e-1,h<0?i.openEnd:e-1):new hd(Kh(i.content,e,l),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Jh(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=Jh(e,t,r,n,o);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],o=Jh(e,n,r,t,!0);if(!o||o.childCount)continue e}return{depth:t,fit:i,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Wh(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Wh(this.placed,this.depth,sd.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(sd.empty,!0);e.childCount&&(this.placed=Wh(this.placed,this.frontier.length,e))}}function Kh(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(Kh(e.firstChild.content,t-1,n)))}function Wh(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Wh(e.lastChild.content,t-1,n)))}function Zh(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function Uh(e,t,n){if(t<=0)return e;let r=e.content;return t>1&&(r=r.replaceChild(0,Uh(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(sd.empty,!0)))),e.copy(r)}function Jh(e,t,n,r,o){let i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function Gh(e){return e.spec.defining||e.spec.definingForContent}function Xh(e,t,n,r,o){if(t<n){let o=e.firstChild;e=e.replaceChild(0,o.copy(Xh(o.content,t+1,n,r,o)))}if(t>r){let t=o.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(sd.empty,!0))}return e}function Yh(e,t){let n=[];for(let r=Math.min(e.depth,t.depth);r>=0;r--){let o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}class Qh extends bh{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return wh.fail("No node at attribute step's position");let n=Object.create(null);for(let o in t.attrs)n[o]=t.attrs[o];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return wh.fromReplace(e,this.pos,this.pos+1,new hd(sd.from(r),0,t.isLeaf?0:1))}getMap(){return yh.empty}invert(e){return new Qh(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Qh(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Qh(t.pos,t.attr,t.value)}}bh.jsonID("attr",Qh);class ep extends bh{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return wh.ok(n)}getMap(){return yh.empty}invert(e){return new ep(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ep(t.attr,t.value)}}bh.jsonID("docAttr",ep);let tp=class extends Error{};tp=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(tp.prototype=Object.create(Error.prototype)).constructor=tp,tp.prototype.name="TransformError";class np{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new vh}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new tp(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=hd.empty){let r=Hh(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new hd(sd.from(n),0,0))}delete(e,t){return this.replace(e,t,hd.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let o=e.doc.resolve(t),i=e.doc.resolve(n);if(jh(o,i,r))return e.step(new Mh(t,n,r));let s=Yh(o,e.doc.resolve(n));0==s[s.length-1]&&s.pop();let a=-(o.depth+1);s.unshift(a);for(let h=o.depth,p=o.pos-1;h>0;h--,p--){let e=o.node(h).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;s.indexOf(h)>-1?a=h:o.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],u=r.openStart;for(let h=r.content,p=0;;p++){let e=h.firstChild;if(c.push(e),p==r.openStart)break;h=e.content}for(let h=u-1;h>=0;h--){let e=c[h],t=Gh(e.type);if(t&&!e.sameMarkup(o.node(Math.abs(a)-1)))u=h;else if(t||!e.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let t=(h+u+1)%(r.openStart+1),a=c[t];if(a)for(let c=0;c<s.length;c++){let u=s[(c+l)%s.length],d=!0;u<0&&(d=!1,u=-u);let h=o.node(u-1),p=o.index(u-1);if(h.canReplaceWith(p,p,a.type,a.marks))return e.replace(o.before(u),d?i.after(u):n,new hd(Xh(r.content,0,r.openStart,t),t,r.openEnd))}}let d=e.steps.length;for(let h=s.length-1;h>=0&&(e.replace(t,n,r),!(e.steps.length>d));h--){let e=s[h];e<0||(t=o.before(e),n=i.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let o=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let o=r.depth-1;o>=0;o--){let e=r.index(o);if(r.node(o).canReplaceWith(e,e,n))return r.before(o+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let e=r.indexAfter(o);if(r.node(o).canReplaceWith(e,e,n))return r.after(o+1);if(e<r.node(o).childCount)return null}return null}(e.doc,t,r.type);null!=o&&(t=n=o)}e.replaceRange(t,n,new hd(sd.from(r),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let r=e.doc.resolve(t),o=e.doc.resolve(n),i=Yh(r,o);for(let s=0;s<i.length;s++){let t=i[s],n=s==i.length-1;if(n&&0==t||r.node(t).type.contentMatch.validEnd)return e.delete(r.start(t),o.end(t));if(t>0&&(n||r.node(t-1).canReplace(r.index(t-1),o.indexAfter(t-1))))return e.delete(r.before(t),o.after(t))}for(let s=1;s<=r.depth&&s<=o.depth;s++)if(t-r.start(s)==r.depth-s&&n>r.end(s)&&o.end(s)-n!=o.depth-s&&r.start(s-1)==o.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),o.index(s-1)))return e.delete(r.before(s),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:r,$to:o,depth:i}=t,s=r.before(i+1),a=o.after(i+1),l=s,c=a,u=sd.empty,d=0;for(let f=i,m=!1;f>n;f--)m||r.index(f)>0?(m=!0,u=sd.from(r.node(f).copy(u)),d++):l--;let h=sd.empty,p=0;for(let f=i,m=!1;f>n;f--)m||o.after(f+1)<o.end(f)?(m=!0,h=sd.from(o.node(f).copy(h)),p++):c++;e.step(new Ah(l,c,s,a,new hd(u.append(h),d,p),u.size-d,!0))}(this,e,t),this}join(e,t=1){return function(e,t,n){let r=null,{linebreakReplacement:o}=e.doc.type.schema,i=e.doc.resolve(t-n),s=i.node().type;if(o&&s.inlineContent){let e="pre"==s.whitespace,t=!!s.contentMatch.matchType(o);e&&!t?r=!1:!e&&t&&(r=!0)}let a=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);Lh(e,r.node(),r.before(),a)}s.inlineContent&&Th(e,t+n-1,s,i.node().contentMatchAt(i.index()),null==r);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new Mh(c,l.map(t+n,-1),hd.empty,!0)),!0===r){let t=e.doc.resolve(c);Ih(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return function(e,t,n){let r=sd.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let e=n[s].type.contentMatch.matchFragment(r);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=sd.from(n[s].type.create(n[s].attrs,r))}let o=t.start,i=t.end;e.step(new Ah(o,i,o,i,new hd(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,r=null){return function(e,t,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{let s="function"==typeof o?o(t):o;if(t.isTextblock&&!t.hasMarkup(r,s)&&function(e,t,n){let r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(e.doc,e.mapping.slice(i).map(n),r)){let o=null;if(r.schema.linebreakReplacement){let e="pre"==r.whitespace,t=!!r.contentMatch.matchType(r.schema.linebreakReplacement);e&&!t?o=!1:!e&&t&&(o=!0)}!1===o&&Lh(e,t,n,i),Th(e,e.mapping.slice(i).map(n,1),r,void 0,null===o);let a=e.mapping.slice(i),l=a.map(n,1),c=a.map(n+t.nodeSize,1);return e.step(new Ah(l,c,l+1,c-1,new hd(sd.from(r.create(s,null,t.marks)),0,0),1,!0)),!0===o&&Ih(e,t,n,i),!1}})}(this,e,t,n,r),this}setNodeMarkup(e,t,n=null,r){return function(e,t,n,r,o){let i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let s=n.create(r,null,o||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,s);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new Ah(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new hd(sd.from(s),0,0),1,!0))}(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new Qh(e,t,n)),this}setDocAttribute(e,t){return this.step(new ep(e,t)),this}addNodeMark(e,t){return this.step(new Sh(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof ud)t.isInSet(n.marks)&&this.step(new Eh(e,t));else{let r,o=n.marks,i=[];for(;r=t.isInSet(o);)i.push(new Eh(e,r)),o=r.removeFromSet(o);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e,t=1,n){return function(e,t,n=1,r){let o=e.doc.resolve(t),i=sd.empty,s=sd.empty;for(let a=o.depth,l=o.depth-n,c=n-1;a>l;a--,c--){i=sd.from(o.node(a).copy(i));let e=r&&r[c];s=sd.from(e?e.type.create(e.attrs,s):o.node(a).copy(s))}e.step(new Mh(t,t,new hd(i.append(s),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){return function(e,t,n,r){let o,i,s=[],a=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let u=e.marks;if(!r.isInSet(u)&&c.type.allowsMarkType(r.type)){let c=Math.max(l,t),d=Math.min(l+e.nodeSize,n),h=r.addToSet(u);for(let e=0;e<u.length;e++)u[e].isInSet(h)||(o&&o.to==c&&o.mark.eq(u[e])?o.to=d:s.push(o=new _h(c,d,u[e])));i&&i.to==c?i.to=d:a.push(i=new Ch(c,d,r))}}),s.forEach(t=>e.step(t)),a.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,r){let o=[],i=0;e.doc.nodesBetween(t,n,(e,s)=>{if(!e.isInline)return;i++;let a=null;if(r instanceof Ud){let t,n=e.marks;for(;t=r.isInSet(n);)(a||(a=[])).push(t),n=t.removeFromSet(n)}else r?r.isInSet(e.marks)&&(a=[r]):a=e.marks;if(a&&a.length){let r=Math.min(s+e.nodeSize,n);for(let e=0;e<a.length;e++){let n,l=a[e];for(let e=0;e<o.length;e++){let t=o[e];t.step==i-1&&l.eq(o[e].style)&&(n=t)}n?(n.to=r,n.step=i):o.push({style:l,from:Math.max(s,t),to:r,step:i})}}}),o.forEach(t=>e.step(new _h(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return Th(this,e,t,n),this}}const rp=Object.create(null);class op{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new ip(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=hd.empty){let n=t.content.lastChild,r=null;for(let s=0;s<t.openEnd;s++)r=n,n=n.lastChild;let o=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:a,$to:l}=i[s],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(l.pos),s?hd.empty:t),0==s&&mp(e,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],a=e.mapping.slice(n),l=a.map(i.pos),c=a.map(s.pos);o?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),mp(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new lp(e):fp(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let o=e.depth-1;o>=0;o--){let r=t<0?fp(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):fp(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(r)return r}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new hp(e.node(0))}static atStart(e){return fp(e,e,0,0,1)||new hp(e)}static atEnd(e){return fp(e,e,e.content.size,e.childCount,-1)||new hp(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=rp[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in rp)throw new RangeError("Duplicate use of selection JSON ID "+e);return rp[e]=t,t.prototype.jsonID=e,t}getBookmark(){return lp.between(this.$anchor,this.$head).getBookmark()}}op.prototype.visible=!0;class ip{constructor(e,t){this.$from=e,this.$to=t}}let sp=!1;function ap(e){sp||e.parent.inlineContent||(sp=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class lp extends op{constructor(e,t=e){ap(e),ap(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return op.near(n);let r=e.resolve(t.map(this.anchor));return new lp(r.parent.inlineContent?r:n,n)}replace(e,t=hd.empty){if(super.replace(e,t),t==hd.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof lp&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new cp(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new lp(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if(n&&!r||(n=r>=0?1:-1),!t.parent.inlineContent){let e=op.findFrom(t,n,!0)||op.findFrom(t,-n,!0);if(!e)return op.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r||(e=(op.findFrom(e,-n,!0)||op.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0)&&(e=t),new lp(e,t)}}op.jsonID("text",lp);class cp{constructor(e,t){this.anchor=e,this.head=t}map(e){return new cp(e.map(this.anchor),e.map(this.head))}resolve(e){return lp.between(e.resolve(this.anchor),e.resolve(this.head))}}class up extends op{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),o=e.resolve(r);return n?op.near(o):new up(o)}content(){return new hd(sd.from(this.node),0,0)}eq(e){return e instanceof up&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new dp(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new up(e.resolve(t.anchor))}static create(e,t){return new up(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}up.prototype.visible=!1,op.jsonID("node",up);class dp{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new cp(n,n):new dp(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&up.isSelectable(n)?new up(t):op.near(t)}}class hp extends op{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=hd.empty){if(t==hd.empty){e.delete(0,e.doc.content.size);let t=op.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new hp(e)}map(e){return new hp(e)}eq(e){return e instanceof hp}getBookmark(){return pp}}op.jsonID("all",hp);const pp={map(){return this},resolve:e=>new hp(e)};function fp(e,t,n,r,o,i=!1){if(t.inlineContent)return lp.create(e,n);for(let s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){let r=t.child(s);if(r.isAtom){if(!i&&up.isSelectable(r))return up.create(e,n-(o<0?r.nodeSize:0))}else{let t=fp(e,r,n+o,o<0?r.childCount:0,o,i);if(t)return t}n+=r.nodeSize*o}return null}function mp(e,t,n){let r=e.steps.length-1;if(r<t)return;let o,i=e.steps[r];(i instanceof Mh||i instanceof Ah)&&(e.mapping.maps[r].forEach((e,t,n,r)=>{null==o&&(o=r)}),e.setSelection(op.near(e.doc.resolve(o),n)))}class gp extends np{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return ud.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||ud.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let e=this.doc.resolve(t);o=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.selection.to!=t+e.length||this.setSelection(op.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function yp(e,t){return t&&e?e.bind(t):e}class vp{constructor(e,t,n){this.name=e,this.init=yp(t.init,n),this.apply=yp(t.apply,n)}}const kp=[new vp("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new vp("selection",{init:(e,t)=>e.selection||op.atStart(t.doc),apply:e=>e.selection}),new vp("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new vp("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class bp{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=kp.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new vp(e.key,e.spec.state,e))})}}class wp{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let s=this.config.plugins[i];if(s.spec.appendTransaction){let a=r?r[i].n:0,l=r?r[i].state:this,c=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new wp(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new gp(this)}static create(e){let t=new bp(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new wp(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new bp(this.schema,e.plugins),n=t.fields,r=new wp(t);for(let o=0;o<n.length;o++){let t=n[o].name;r[t]=this.hasOwnProperty(t)?this[t]:n[o].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new bp(e.schema,e.plugins),o=new wp(r);return r.fields.forEach(r=>{if("doc"==r.name)o.doc=Td.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=op.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let i in n){let s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=a.fromJSON.call(s,e,t[i],o))}o[r.name]=r.init(e,o)}}),o}}function xp(e,t,n){for(let r in e){let o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=xp(o,t,{})),n[r]=o}return n}class Cp{constructor(e){this.spec=e,this.props={},e.props&&xp(e.props,this,this.props),this.key=e.key?e.key.key:Sp("plugin")}getState(e){return e[this.key]}}const _p=Object.create(null);function Sp(e){return e in _p?e+"$"+ ++_p[e]:(_p[e]=0,e+"$")}class Ep{constructor(e="key"){this.key=Sp(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Mp=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function Ap(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const Dp=(e,t,n)=>{let r=Ap(e,n);if(!r)return!1;let o=Pp(r);if(!o){let n=r.blockRange(),o=n&&Nh(n);return null!=o&&(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)}let i=o.nodeBefore;if(jp(e,o,t,-1))return!0;if(0==r.parent.content.size&&(Op(i,"end")||up.isSelectable(i)))for(let s=r.depth;;s--){let n=Hh(e.doc,r.before(s),r.after(s),hd.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(Op(i,"end")?op.findFrom(r.doc.resolve(r.mapping.map(o.pos,-1)),-1):up.create(r.doc,o.pos-i.nodeSize)),t(r.scrollIntoView())}return!0}if(1==s||r.node(s-1).childCount>1)break}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0)};function Tp(e,t,n){let r=t.nodeBefore,o=t.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let i=t.nodeAfter,s=t.pos+1;for(;!i.isTextblock;s++){if(i.type.spec.isolating)return!1;let e=i.firstChild;if(!e)return!1;i=e}let a=Hh(e.doc,o,s,hd.empty);if(!a||a.from!=o||a instanceof Mh&&a.slice.size>=s-o)return!1;if(n){let t=e.tr.step(a);t.setSelection(lp.create(t.doc,o)),n(t.scrollIntoView())}return!0}function Op(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const Np=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;i=Pp(r)}let s=i&&i.nodeBefore;return!(!s||!up.isSelectable(s))&&(t&&t(e.tr.setSelection(up.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function Pp(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function zp(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const Ip=(e,t,n)=>{let r=zp(e,n);if(!r)return!1;let o=$p(r);if(!o)return!1;let i=o.nodeAfter;if(jp(e,o,t,1))return!0;if(0==r.parent.content.size&&(Op(i,"start")||up.isSelectable(i))){let n=Hh(e.doc,r.before(),r.after(),hd.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(Op(i,"start")?op.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):up.create(r.doc,r.mapping.map(o.pos))),t(r.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)},Lp=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;i=$p(r)}let s=i&&i.nodeAfter;return!(!s||!up.isSelectable(s))&&(t&&t(e.tr.setSelection(up.create(e.doc,i.pos)).scrollIntoView()),!0)};function $p(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const Rp=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function Fp(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const Bp=(e,t)=>{let n=e.selection,{$from:r,$to:o}=n;if(n instanceof hp||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=Fp(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=e.tr.insert(n,i.createAndFill());s.setSelection(lp.create(s.doc,n+1)),t(s.scrollIntoView())}return!0},Vp=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if($h(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),o=r&&Nh(r);return null!=o&&(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)};const Hp=(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof up&&e.selection.node.isBlock)return!(!n.parentOffset||!$h(e.doc,n.pos)||(t&&t(e.tr.split(n.pos).scrollIntoView()),0));if(!n.depth)return!1;let o,i,s=[],a=!1,l=!1;for(let h=n.depth;;h--){if(n.node(h).isBlock){a=n.end(h)==n.pos+(n.depth-h),l=n.start(h)==n.pos-(n.depth-h),i=Fp(n.node(h-1).contentMatchAt(n.indexAfter(h-1))),s.unshift(a&&i?{type:i}:null),o=h;break}if(1==h)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof lp||e.selection instanceof hp)&&c.deleteSelection();let u=c.mapping.map(n.pos),d=$h(c.doc,u,s.length,s);if(d||(s[0]=i?{type:i}:null,d=$h(c.doc,u,s.length,s)),!d)return!1;if(c.split(u,s.length,s),!a&&l&&n.node(o).type!=i){let e=c.mapping.map(n.before(o)),t=c.doc.resolve(e);i&&n.node(o-1).canReplaceWith(t.index(),t.index()+1,i)&&c.setNodeMarkup(c.mapping.map(n.before(o)),i)}return t&&t(c.scrollIntoView()),!0};function jp(e,t,n,r){let o,i,s=t.nodeBefore,a=t.nodeAfter,l=s.type.spec.isolating||a.type.spec.isolating;if(!l&&function(e,t,n){let r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(i,i+1)||!o.isTextblock&&!Rh(e.doc,t.pos)||(n&&n(e.tr.join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(o=(i=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&i.matchType(o[0]||a.type).validEnd){if(n){let r=t.pos+a.nodeSize,i=sd.empty;for(let e=o.length-1;e>=0;e--)i=sd.from(o[e].create(null,i));i=sd.from(s.copy(i));let l=e.tr.step(new Ah(t.pos-1,r,t.pos,r,new hd(i,1,0),o.length,!0)),c=l.doc.resolve(r+2*o.length);c.nodeAfter&&c.nodeAfter.type==s.type&&Rh(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let u=a.type.spec.isolating||r>0&&l?null:op.findFrom(t,1),d=u&&u.$from.blockRange(u.$to),h=d&&Nh(d);if(null!=h&&h>=t.depth)return n&&n(e.tr.lift(d,h).scrollIntoView()),!0;if(c&&Op(a,"start",!0)&&Op(s,"end")){let r=s,o=[];for(;o.push(r),!r.isTextblock;)r=r.lastChild;let i=a,l=1;for(;!i.isTextblock;i=i.firstChild)l++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=sd.empty;for(let e=o.length-1;e>=0;e--)r=sd.from(o[e].copy(r));n(e.tr.step(new Ah(t.pos-o.length,t.pos+a.nodeSize,t.pos+l,t.pos+a.nodeSize-l,new hd(r,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function qp(e){return function(t,n){let r=t.selection,o=e<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(t.tr.setSelection(lp.create(t.doc,e<0?o.start(i):o.end(i)))),!0)}}const Kp=qp(-1),Wp=qp(1);function Zp(e,t=null){return function(n,r){let o=!1;for(let i=0;i<n.selection.ranges.length&&!o;i++){let{$from:{pos:r},$to:{pos:s}}=n.selection.ranges[i];n.doc.nodesBetween(r,s,(r,i)=>{if(o)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)o=!0;else{let t=n.doc.resolve(i),r=t.index();o=t.parent.canReplaceWith(r,r+1,e)}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];o.setBlockType(i,s,e,t)}r(o.scrollIntoView())}return!0}}function Up(...e){return function(t,n,r){for(let o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}function Jp(e,t=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i);if(!s)return!1;let a=r?n.tr:null;return!!function(e,t,n,r=null){let o=!1,i=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=s.resolve(t.start-2);i=new Ad(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new Ad(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),o=!0}let a=Ph(i,n,r,t);if(!a)return!1;e&&function(e,t,n,r,o){let i=sd.empty;for(let u=n.length-1;u>=0;u--)i=sd.from(n[u].type.create(n[u].attrs,i));e.step(new Ah(t.start-(r?2:0),t.end,t.start,t.end,new hd(i,0,0),n.length,!0));let s=0;for(let u=0;u<n.length;u++)n[u].type==o&&(s=u+1);let a=n.length-s,l=t.start+n.length-(r?2:0),c=t.parent;for(let u=t.startIndex,d=t.endIndex,h=!0;u<d;u++,h=!1)!h&&$h(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(u).nodeSize}(e,t,a,o,n);return!0}(a,s,e,t)&&(r&&r(a.scrollIntoView()),!0)}}function Gp(e){return function(t,n){let{$from:r,$to:o}=t.selection,i=r.blockRange(o,t=>t.childCount>0&&t.firstChild.type==e);return!!i&&(!n||(r.node(i.depth-1).type==e?function(e,t,n,r){let o=e.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new Ah(i-1,s,i,s,new hd(sd.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Ad(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));const a=Nh(r);if(null==a)return!1;o.lift(r,a);let l=o.doc.resolve(o.mapping.map(i,-1)-1);Rh(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos);return t(o.scrollIntoView()),!0}(t,n,e,i):function(e,t,n){let r=e.tr,o=n.parent;for(let p=n.end,f=n.endIndex-1,m=n.startIndex;f>m;f--)p-=o.child(f).nodeSize,r.delete(p-1,p+1);let i=r.doc.resolve(n.start),s=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==o.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?sd.empty:sd.from(o))))return!1;let d=i.pos,h=d+s.nodeSize;return r.step(new Ah(d-(a?1:0),h+(l?1:0),d+1,h-1,new hd((a?sd.empty:sd.from(o.copy(sd.empty))).append(l?sd.empty:sd.from(o.copy(sd.empty))),a?0:1,l?0:1),a?0:1)),t(r.scrollIntoView()),!0}(t,n,i)))}}Up(Mp,Dp,Np),Up(Mp,Ip,Lp),Up(Rp,Bp,Vp,Hp),"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();const Xp=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},Yp=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let Qp=null;const ef=function(e,t,n){let r=Qp||(Qp=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},tf=function(e,t,n,r){return n&&(rf(e,t,n,r,-1)||rf(e,t,n,r,1))},nf=/^(img|br|input|textarea|hr)$/i;function rf(e,t,n,r,o){for(var i;;){if(e==n&&t==r)return!0;if(t==(o<0?0:of(e))){let n=e.parentNode;if(!n||1!=n.nodeType||sf(e)||nf.test(e.nodeName)||"false"==e.contentEditable)return!1;t=Xp(e)+(o<0?0:1),e=n}else{if(1!=e.nodeType)return!1;{let n=e.childNodes[t+(o<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(i=n.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;t+=o}else e=n,t=o<0?of(e):0}}}}function of(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function sf(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const af=function(e){return e.focusNode&&tf(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function lf(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const cf="undefined"!=typeof navigator?navigator:null,uf="undefined"!=typeof document?document:null,df=cf&&cf.userAgent||"",hf=/Edge\/(\d+)/.exec(df),pf=/MSIE \d/.exec(df),ff=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(df),mf=!!(pf||ff||hf),gf=pf?document.documentMode:ff?+ff[1]:hf?+hf[1]:0,yf=!mf&&/gecko\/(\d+)/i.test(df);yf&&(/Firefox\/(\d+)/.exec(df)||[0,0])[1];const vf=!mf&&/Chrome\/(\d+)/.exec(df),kf=!!vf,bf=vf?+vf[1]:0,wf=!mf&&!!cf&&/Apple Computer/.test(cf.vendor),xf=wf&&(/Mobile\/\w+/.test(df)||!!cf&&cf.maxTouchPoints>2),Cf=xf||!!cf&&/Mac/.test(cf.platform),_f=!!cf&&/Win/.test(cf.platform),Sf=/Android \d/.test(df),Ef=!!uf&&"webkitFontSmoothing"in uf.documentElement.style,Mf=Ef?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Af(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Df(e,t){return"number"==typeof e?e:e[t]}function Tf(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function Of(e,t,n){let r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let s=n||e.dom;s;){if(1!=s.nodeType){s=Yp(s);continue}let e=s,n=e==i.body,a=n?Af(i):Tf(e),l=0,c=0;if(t.top<a.top+Df(r,"top")?c=-(a.top-t.top+Df(o,"top")):t.bottom>a.bottom-Df(r,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+Df(o,"top")-a.top:t.bottom-a.bottom+Df(o,"bottom")),t.left<a.left+Df(r,"left")?l=-(a.left-t.left+Df(o,"left")):t.right>a.right-Df(r,"right")&&(l=t.right-a.right+Df(o,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let o=e.scrollLeft-n,i=e.scrollTop-r;t={left:t.left-o,top:t.top-i,right:t.right-o,bottom:t.bottom-i}}let u=n?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(u))break;s="absolute"==u?s.offsetParent:Yp(s)}}function Nf(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=Yp(r));return t}function Pf(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:o,left:i}=e[n];r.scrollTop!=o+t&&(r.scrollTop=o+t),r.scrollLeft!=i&&(r.scrollLeft=i)}}let zf=null;function If(e,t){let n,r,o,i,s=2e8,a=0,l=t.top,c=t.top;for(let u=e.firstChild,d=0;u;u=u.nextSibling,d++){let e;if(1==u.nodeType)e=u.getClientRects();else{if(3!=u.nodeType)continue;e=ef(u).getClientRects()}for(let h=0;h<e.length;h++){let p=e[h];if(p.top<=l&&p.bottom>=c){l=Math.max(p.bottom,l),c=Math.min(p.top,c);let e=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(e<s){n=u,s=e,r=e&&3==n.nodeType?{left:p.right<t.left?p.right:p.left,top:t.top}:t,1==u.nodeType&&e&&(a=d+(t.left>=(p.left+p.right)/2?1:0));continue}}else p.top>t.top&&!o&&p.left<=t.left&&p.right>=t.left&&(o=u,i={left:Math.max(p.left,Math.min(p.right,t.left)),top:p.top});!n&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(a=d+1)}}return!n&&o&&(n=o,r=i,s=0),n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);let n=Bf(r,1);if(n.top!=n.bottom&&Lf(t,n))return{node:e,offset:o+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||s&&1==n.nodeType?{node:e,offset:a}:If(n,r)}function Lf(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function $f(e,t,n){let r=e.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){let n=e.childNodes[i];if(1==n.nodeType){let e=n.getClientRects();for(let r=0;r<e.length;r++){let o=e[r];if(Lf(t,o))return $f(n,t,o)}}if((i=(i+1)%r)==o)break}return e}function Rf(e,t){let n,r=e.dom.ownerDocument,o=0,i=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(of(r.offsetNode),r.offset)}}catch(r){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(of(r.startContainer),r.startOffset)}}}(r,t.left,t.top);i&&({node:n,offset:o}=i);let s,a=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=e.dom.getBoundingClientRect();if(!Lf(t,n))return null;if(a=$f(e.dom,t,n),!a)return null}if(wf)for(let c=a;n&&c;c=Yp(c))c.draggable&&(n=void 0);if(a=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(a,t),n){if(yf&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let e,r=n.childNodes[o];"IMG"==r.nodeName&&(e=r.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&o++}let r;Ef&&o&&1==n.nodeType&&1==(r=n.childNodes[o-1]).nodeType&&"false"==r.contentEditable&&r.getBoundingClientRect().top>=t.top&&o--,n==e.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?s=e.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(s=function(e,t,n,r){let o=-1;for(let i=t,s=!1;i!=e.dom;){let t,n=e.docView.nearestDesc(i,!0);if(!n)return null;if(1==n.dom.nodeType&&(n.node.isBlock&&n.parent||!n.contentDOM)&&((t=n.dom.getBoundingClientRect()).width||t.height)&&(n.node.isBlock&&n.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(n.dom.nodeName)&&(!s&&t.left>r.left||t.top>r.top?o=n.posBefore:(!s&&t.right<r.left||t.bottom<r.top)&&(o=n.posAfter),s=!0),!n.contentDOM&&o<0&&!n.node.isText))return(n.node.isBlock?r.top<(t.top+t.bottom)/2:r.left<(t.left+t.right)/2)?n.posBefore:n.posAfter;i=n.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n,-1)}(e,n,o,t))}null==s&&(s=function(e,t,n){let{node:r,offset:o}=If(t,n),i=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();i=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,o,i)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:s,inside:l?l.posAtStart-l.border:-1}}function Ff(e){return e.top<e.bottom||e.left<e.right}function Bf(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(Ff(e))return e}return Array.prototype.find.call(n,Ff)||e.getBoundingClientRect()}const Vf=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Hf(e,t,n){let{node:r,offset:o,atom:i}=e.docView.domFromPos(t,n<0?-1:1),s=Ef||yf;if(3==r.nodeType){if(!s||!Vf.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let e=o,t=o,i=n<0?1:-1;return n<0&&!o?(t++,i=-1):n>=0&&o==r.nodeValue.length?(e--,i=1):n<0?e--:t++,jf(Bf(ef(r,e,t),i),i<0)}{let e=Bf(ef(r,o,o),n);if(yf&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let t=Bf(ef(r,o-1,o-1),-1);if(t.top==e.top){let n=Bf(ef(r,o,o+1),-1);if(n.top!=e.top)return jf(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&o&&(n<0||o==of(r))){let e=r.childNodes[o-1];if(1==e.nodeType)return qf(e.getBoundingClientRect(),!1)}if(null==i&&o<of(r)){let e=r.childNodes[o];if(1==e.nodeType)return qf(e.getBoundingClientRect(),!0)}return qf(r.getBoundingClientRect(),n>=0)}if(null==i&&o&&(n<0||o==of(r))){let e=r.childNodes[o-1],t=3==e.nodeType?ef(e,of(e)-(s?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return jf(Bf(t,1),!1)}if(null==i&&o<of(r)){let e=r.childNodes[o];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?ef(e,0,s?0:1):1==e.nodeType?e:null:null;if(t)return jf(Bf(t,-1),!0)}return jf(Bf(3==r.nodeType?ef(r):r,-n),n>=0)}function jf(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function qf(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function Kf(e,t,n){let r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}const Wf=/[\u0590-\u08ac]/;let Zf=null,Uf=null,Jf=!1;function Gf(e,t,n){return Zf==t&&Uf==n?Jf:(Zf=t,Uf=n,Jf="up"==n||"down"==n?function(e,t,n){let r=t.selection,o="up"==n?r.$from:r.$to;return Kf(e,t,()=>{let{node:t}=e.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=Hf(e,o.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=ef(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let o=t[e];if(o.bottom>o.top+1&&("up"==n?r.top-o.top>2*(o.bottom-r.top):o.bottom-r.bottom>2*(r.bottom-o.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=e.domSelection();return a?Wf.test(r.parent.textContent)&&a.modify?Kf(e,t,()=>{let{focusNode:t,focusOffset:o,anchorNode:i,anchorOffset:s}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:u,focusOffset:d}=e.domSelectionRange(),h=u&&!c.contains(1==u.nodeType?u:u.parentNode)||t==u&&o==d;try{a.collapse(i,s),t&&(t!=i||o!=s)&&a.extend&&a.extend(t,o)}catch(p){}return null!=l&&(a.caretBidiLevel=l),h}):"left"==n||"backward"==n?i:s:r.pos==r.start()||r.pos==r.end()}(e,t,n))}class Xf{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}let r;if(e==this.dom&&this.contentDOM)r=t>Xp(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let o,i=this.getDesc(r);if(i&&(!t||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==e.nodeType?e:e.parentNode):o==e))return i;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<o)return r.descAt(e-n-r.border);n=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let o=0;n<this.children.length;n++){let t=this.children[n],i=o+t.size;if(i>e||t instanceof om){r=e-o;break}o=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof Yf&&o.side>=0;n--);if(t<=0){let e,r=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?Xp(e.dom)+1:0}}{let e,r=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?Xp(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let i=n,s=0;;s++){let n=this.children[s],a=i+n.size;if(-1==r&&e<=a){let o=i+n.border;if(e>=o&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,o);e=i;for(let t=s;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=Xp(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(a>t||s==this.children.length-1)){t=a;for(let e=s+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){o=Xp(n.dom);break}t+=n.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=a}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let o=Math.min(e,t),i=Math.max(e,t);for(let p=0,f=0;p<this.children.length;p++){let s=this.children[p],a=f+s.size;if(o>f&&i<a)return s.setSelection(e-f-s.border,t-f-s.border,n,r);f=a}let s=this.domFromPos(e,e?-1:1),a=t==e?s:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((yf||wf)&&e==t){let{node:e,offset:t}=s;if(3==e.nodeType){if(u=!(!t||"\n"!=e.nodeValue[t-1]),u&&t==e.nodeValue.length)for(let n,r=e;r;r=r.parentNode){if(n=r.nextSibling){"BR"==n.nodeName&&(s=a={node:n.parentNode,offset:Xp(n)+1});break}let e=r.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];u=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(yf&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||u&&wf)&&tf(s.node,s.offset,c.anchorNode,c.anchorOffset)&&tf(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((l.extend||e==t)&&(!u||!yf)){l.collapse(s.node,s.offset);try{e!=t&&l.extend(a.node,a.offset),d=!0}catch(h){}}if(!d){if(e>t){let e=s;s=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){let r=n+o.border,s=i-o.border;if(e>=r&&t<=s)return this.dirty=e==n||t==i?2:1,void(e!=r||t!=s||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-r,t-r):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Yf extends Xf{constructor(e,t,n,r){let o,i=t.type.toDOM;if("function"==typeof i&&(i=i(n,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:r)),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Qf extends Xf{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class em extends Xf{constructor(e,t,n,r,o){super(e,[],n,r),this.mark=t,this.spec=o}static create(e,t,n,r){let o=r.nodeViews[t.type.name],i=o&&o(t,r,n);return i&&i.dom||(i=ah.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new em(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=em.create(this.parent,this.mark,!0,n),o=this.children,i=this.size;t<i&&(o=ym(o,t,i,n)),e>0&&(o=ym(o,0,e,n));for(let s=0;s<o.length;s++)o[s].parent=r;return r.children=o,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class tm extends Xf{constructor(e,t,n,r,o,i,s,a,l){super(e,[],o,i),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=s}static create(e,t,n,r,o,i){let s,a=o.nodeViews[t.type.name],l=a&&a(t,o,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:i,n,r),c=l&&l.dom,u=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=ah.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:u}=e)}u||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let d=c;return c=hm(c,n,t),l?s=new im(e,t,n,r,c,u||null,d,l,o,i+1):t.isText?new rm(e,t,n,r,c,d,o):new tm(e,t,n,r,c,u||null,d,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>sd.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&pm(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,o=e.composing?this.localCompositionInfo(e,t):null,i=o&&o.pos>-1?o:null,s=o&&o.pos<0,a=new mm(this,i&&i.node,e);!function(e,t,n,r){let o=t.locals(e),i=0;if(0==o.length){for(let n=0;n<e.childCount;n++){let s=e.child(n);r(s,o,t.forChild(i,s),n),i+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d,h,p;for(;s<o.length&&o[s].to==i;){let e=o[s++];e.widget&&(u?(d||(d=[u])).push(e):u=e)}if(u)if(d){d.sort(gm);for(let e=0;e<d.length;e++)n(d[e],c,!!l)}else n(u,c,!!l);if(l)p=-1,h=l,l=null;else{if(!(c<e.childCount))break;p=c,h=e.child(c++)}for(let e=0;e<a.length;e++)a[e].to<=i&&a.splice(e--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);let f=i+h.nodeSize;if(h.isText){let e=f;s<o.length&&o[s].from<e&&(e=o[s].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=h.cut(e-i),h=h.cut(0,e-i),f=e,p=-1)}else for(;s<o.length&&o[s].to<f;)s++;r(h,h.isInline&&!h.isLeaf?a.filter(e=>!e.inline):a.slice(),t.forChild(i,h),p),i=f}}(this.node,this.innerDeco,(t,o,i)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!i&&a.syncToMarks(o==this.node.childCount?ud.none:this.node.child(o).marks,n,e),a.placeWidget(t,e,r)},(t,i,l,c)=>{let u;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,i,l,c)||s&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(u=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(t,i,l,u,e)||a.updateNextNode(t,i,l,e,c,r)||a.addNode(t,i,l,e,r),r+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),sm(this.contentDOM,this.children,e),xf&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof lp)||n<t||r>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let e=o.nodeValue,i=function(e,t,n,r){for(let o=0,i=0;o<e.childCount&&i<=r;){let s=e.child(o++),a=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;o<e.childCount;){let t=e.child(o++);if(i+=t.nodeSize,!t.isText)break;l+=t.text}if(i>=n){if(i>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let e=a<r?l.lastIndexOf(t,r-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return-1}(this.node.content,e,n-t,r-t);return i<0?null:{node:o,pos:i,text:e}}return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let i=new Qf(this,o,t,r);e.input.compositionNodes.push(i),this.children=ym(this.children,n,n+r.length,e,i)}update(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(pm(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=um(this.dom,this.nodeDOM,cm(this.outerDeco,this.node,t),cm(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function nm(e,t,n,r,o){hm(r,t,e);let i=new tm(void 0,e,t,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class rm extends tm{constructor(e,t,n,r,o,i,s){super(e,t,n,r,o,null,i,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),o=document.createTextNode(r.text);return new rm(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class om extends Xf{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class im extends tm{constructor(e,t,n,r,o,i,s,a,l,c){super(e,t,n,r,o,i,s,l,c),this.spec=a}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,n);return o&&this.updateInner(e,t,n,r),o}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function sm(e,t,n){let r=e.firstChild,o=!1;for(let i=0;i<t.length;i++){let s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=r;)r=fm(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(a,r);if(s instanceof em){let t=r?r.previousSibling:e.lastChild;sm(s.contentDOM,s.children,n),r=t?t.nextSibling:e.firstChild}}for(;r;)r=fm(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}const am=function(e){e&&(this.nodeName=e)};am.prototype=Object.create(null);const lm=[new am];function cm(e,t,n){if(0==e.length)return lm;let r=n?lm[0]:new am,o=[r];for(let i=0;i<e.length;i++){let s=e[i].type.attrs;if(s){s.nodeName&&o.push(r=new am(s.nodeName));for(let e in s){let i=s[e];null!=i&&(n&&1==o.length&&o.push(r=new am(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+i:"style"==e?r.style=(r.style?r.style+";":"")+i:"nodeName"!=e&&(r[e]=i))}}}return o}function um(e,t,n,r){if(n==lm&&r==lm)return t;let o=t;for(let i=0;i<r.length;i++){let t=r[i],s=n[i];if(i){let n;s&&s.nodeName==t.nodeName&&o!=e&&(n=o.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(o),s=lm[0]),o=n}dm(o,s||lm[0],t)}return o}function dm(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==o.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<o.length;t++)-1==r.indexOf(o[t])&&e.classList.add(o[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=r.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function hm(e,t,n){return um(e,e,lm,cm(t,n,1!=e.nodeType))}function pm(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function fm(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class mm{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,o=e.childCount,i=new Map,s=[];e:for(;o>0;){let a;for(;;)if(r){let e=n.children[r-1];if(!(e instanceof em)){a=e,r--;break}n=e,r=e.children.length}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,o=this.stack.length>>1,i=Math.min(o,e.length);for(;r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[o])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=em.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,n,r){let o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(let s=this.index,a=Math.min(this.top.children.length,s+5);s<a;s++){let r=this.top.children[s];if(r.matchesNode(e,t,n)&&!this.preMatch.matched.has(r)){i=s;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,r,o){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,r,o,i){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof tm){let l=this.preMatch.matched.get(a);if(null!=l&&l!=o)return!1;let c,u=a.dom,d=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&pm(t,a.outerDeco));if(!d&&a.update(e,t,n,r))return this.destroyBetween(this.index,s),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(c=this.recreateWrapper(a,e,t,n,r,i)))return this.destroyBetween(this.index,s),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(r,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,o,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!pm(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let s=tm.create(this.top,t,n,r,o,i);if(s.contentDOM){s.children=e.children,e.children=[];for(let e of s.children)e.parent=s}return e.destroy(),s}addNode(e,t,n,r,o){let i=tm.create(this.top,e,t,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){let r=new Yf(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof em;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof rm)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((wf||kf)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new om(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function gm(e,t){return e.type.side-t.type.side}function ym(e,t,n,r,o){let i=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,u=a+=l.size;c>=n||u<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,r)),o&&(i.push(o),o=void 0),u>n&&i.push(l.slice(n-c,l.size,r)))}return i}function vm(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a,l,c=r.resolve(s);if(af(n)){for(a=s;o&&!o.node;)o=o.parent;let e=o.node;if(o&&e.isAtom&&up.isSelectable(e)&&o.parent&&(!e.isInline||!function(e,t,n){for(let r=0==t,o=t==of(e);r||o;){if(e==n)return!0;let t=Xp(e);if(!(e=e.parentNode))return!1;r=r&&0==t,o=o&&t==of(e)}}(n.focusNode,n.focusOffset,o.dom))){let e=o.posBefore;l=new up(s==e?c:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=s,o=s;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),o=Math.max(o,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[a,s]=o==e.state.selection.anchor?[o,t]:[t,o],c=r.resolve(s)}else a=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let u=r.resolve(a);if(!l){l=Mm(e,u,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1)}return l}function km(e){return e.editable?e.hasFocus():Dm(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function bm(e,t=!1){let n=e.state.selection;if(Sm(e,n),km(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&kf){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&tf(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection();if(!t)return;let n=e.cursorWrapper.dom,r="IMG"==n.nodeName;r?t.collapse(n.parentNode,Xp(n)+1):t.collapse(n,0);!r&&!e.state.selection.visible&&mf&&gf<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let r,o,{anchor:i,head:s}=n;!wm||n instanceof lp||(n.$from.parent.inlineContent||(r=xm(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=xm(e,n.to))),e.docView.setSelection(i,s,e,t),wm&&(r&&_m(r),o&&_m(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{km(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const wm=wf||kf&&bf<63;function xm(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),o=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(wf&&o&&"false"==o.contentEditable)return Cm(o);if(!(o&&"false"!=o.contentEditable||i&&"false"!=i.contentEditable)){if(o)return Cm(o);if(i)return Cm(i)}}function Cm(e){return e.contentEditable="true",wf&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function _m(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Sm(e,t){if(t instanceof up){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(Em(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else Em(e)}function Em(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function Mm(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||lp.between(t,n,r)}function Am(e){return!(e.editable&&!e.hasFocus())&&Dm(e)}function Dm(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function Tm(e,t){let{$anchor:n,$head:r}=e.selection,o=t>0?n.max(r):n.min(r),i=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return i&&op.findFrom(i,t)}function Om(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Nm(e,t,n){let r=e.state.selection;if(!(r instanceof lp)){if(r instanceof up&&r.node.isInline)return Om(e,new lp(t>0?r.$to:r.$from));{let n=Tm(e.state,t);return!!n&&Om(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=r,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=e.state.doc.resolve(n.pos+o.nodeSize*(t<0?-1:1));return Om(e,new lp(r.$anchor,i))}if(!r.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=Tm(e.state,t);return!!(n&&n instanceof up)&&Om(e,n)}if(!(Cf&&n.indexOf("m")>-1)){let n,o=r.$head,i=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText)return!1;let s=t<0?o.pos-i.nodeSize:o.pos;return!!(i.isAtom||(n=e.docView.descAt(s))&&!n.contentDOM)&&(up.isSelectable(i)?Om(e,new up(t<0?e.state.doc.resolve(o.pos-i.nodeSize):o)):!!Ef&&Om(e,new lp(e.state.doc.resolve(t<0?s:s+i.nodeSize))))}}function Pm(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function zm(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function Im(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,s=!1;yf&&1==n.nodeType&&r<Pm(n)&&zm(n.childNodes[r],-1)&&(s=!0);for(;;)if(r>0){if(1!=n.nodeType)break;{let e=n.childNodes[r-1];if(zm(e,-1))o=n,i=--r;else{if(3!=e.nodeType)break;n=e,r=n.nodeValue.length}}}else{if(Lm(n))break;{let t=n.previousSibling;for(;t&&zm(t,-1);)o=n.parentNode,i=Xp(t),t=t.previousSibling;if(t)n=t,r=Pm(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}}s?$m(e,n,r):o&&$m(e,o,i)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,s=Pm(n);for(;;)if(r<s){if(1!=n.nodeType)break;if(!zm(n.childNodes[r],1))break;o=n,i=++r}else{if(Lm(n))break;{let t=n.nextSibling;for(;t&&zm(t,1);)o=t.parentNode,i=Xp(t)+1,t=t.nextSibling;if(t)n=t,r=0,s=Pm(n);else{if(n=n.parentNode,n==e.dom)break;r=s=0}}}o&&$m(e,o,i)}(e)}function Lm(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function $m(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!sf(e);)t=Xp(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!sf(e);)t=Xp(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(af(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:o}=e;setTimeout(()=>{e.state==o&&bm(e)},50)}function Rm(e,t){let n=e.state.doc.resolve(t);if(!kf&&!_f&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function Fm(e,t,n){let r=e.state.selection;if(r instanceof lp&&!r.empty||n.indexOf("s")>-1)return!1;if(Cf&&n.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=Tm(e.state,t);if(n&&n instanceof up)return Om(e,n)}if(!o.parent.inlineContent){let n=t<0?o:i,s=r instanceof hp?op.near(n,t):op.findFrom(n,t);return!!s&&Om(e,s)}return!1}function Bm(e,t){if(!(e.state.selection instanceof lp))return!0;let{$head:n,$anchor:r,empty:o}=e.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=e.state.tr;return t<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),e.dispatch(r),!0}return!1}function Vm(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function Hm(e,t){let n=t.keyCode,r=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||Cf&&72==n&&"c"==r)return Bm(e,-1)||Im(e,-1);if(46==n&&!t.shiftKey||Cf&&68==n&&"c"==r)return Bm(e,1)||Im(e,1);if(13==n||27==n)return!0;if(37==n||Cf&&66==n&&"c"==r){let t=37==n?"ltr"==Rm(e,e.state.selection.from)?-1:1:-1;return Nm(e,t,r)||Im(e,t)}if(39==n||Cf&&70==n&&"c"==r){let t=39==n?"ltr"==Rm(e,e.state.selection.from)?1:-1:1;return Nm(e,t,r)||Im(e,t)}return 38==n||Cf&&80==n&&"c"==r?Fm(e,-1,r)||Im(e,-1):40==n||Cf&&78==n&&"c"==r?function(e){if(!wf||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;Vm(e,n,"true"),setTimeout(()=>Vm(e,n,"false"),20)}return!1}(e)||Fm(e,1,r)||Im(e,1):r==(Cf?"m":"c")&&(66==n||73==n||89==n||90==n)}function jm(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:o,openEnd:i}=t;for(;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let s=e.someProp("clipboardSerializer")||ah.fromSchema(e.state.schema),a=Qm(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c,u=l.firstChild,d=0;for(;u&&1==u.nodeType&&(c=Xm[u.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=a.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),d++}u=l.firstChild}return u&&1==u.nodeType&&u.setAttribute("data-pm-slice",`${o} ${i}${d?` -${d}`:""} ${JSON.stringify(n)}`),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function qm(e,t,n,r,o){let i,s,a=o.parent.type.spec.code;if(!n&&!t)return null;let l=!!t&&(r||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||r,e)}),a)return s=new hd(sd.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0),e.someProp("transformPasted",t=>{s=t(s,e,!0)}),s;let n=e.someProp("clipboardTextParser",n=>n(t,o,r,e));if(n)s=n;else{let n=o.marks(),{schema:r}=e.state,s=ah.fromSchema(r);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(s.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),i=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,r=Qm().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&Xm[o[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(r.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;eg||(eg=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return eg.createHTML(e)}(e),n)for(let i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),Ef&&function(e){let t=e.querySelectorAll(kf?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"Â "==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(!s){let t=e.someProp("clipboardParser")||e.someProp("domParser")||Xd.fromSchema(e.state.schema);s=t.parseSlice(i,{preserveWhitespace:!(!l&&!u),context:o,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||Km.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(u)s=function(e,t){if(!e.size)return e;let n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(uA){return e}let{content:o,openStart:i,openEnd:s}=e;for(let a=n.length-2;a>=0;a-=2){let e=r.nodes[n[a]];if(!e||e.hasRequiredAttrs())break;o=sd.from(e.create(n[a+1],o)),i++,s++}return new hd(o,i,s)}(Gm(s,+u[1],+u[2]),u[4]);else if(s=hd.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r,o=t.node(n).contentMatchAt(t.index(n)),i=[];if(e.forEach(e=>{if(!i)return;let t,n=o.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&r.length&&Zm(n,r,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=Um(i[i.length-1],r.length));let t=Wm(e,n);i.push(t),o=o.matchType(t.type),r=n}}),i)return sd.from(i)}return e}(s.content,o),!0),s.openStart||s.openEnd){let e=0,t=0;for(let n=s.content.firstChild;e<s.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=s.content.lastChild;t<s.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);s=Gm(s,e,t)}return e.someProp("transformPasted",t=>{s=t(s,e,l)}),s}const Km=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Wm(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,sd.from(e));return e}function Zm(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){let i=Zm(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(sd.from(Wm(n,e,o+1))))}}function Um(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,Um(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(sd.empty,!0);return e.copy(n.append(r))}function Jm(e,t,n,r,o,i){let s=t<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(i=0),o<r-1&&(a=Jm(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(sd.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function Gm(e,t,n){return t<e.openStart&&(e=new hd(Jm(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new hd(Jm(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const Xm={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ym=null;function Qm(){return Ym||(Ym=document.implementation.createHTMLDocument("title"))}let eg=null;const tg={},ng={},rg={touchstart:!0,touchmove:!0};class og{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ig(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function sg(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>ag(e,t))})}function ag(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function lg(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function cg(e){return{left:e.clientX,top:e.clientY}}function ug(e,t,n,r,o){if(-1==r)return!1;let i=e.state.doc.resolve(r);for(let s=i.depth+1;s>0;s--)if(e.someProp(t,t=>s>i.depth?t(e,n,i.nodeAfter,i.before(s),o,!0):t(e,n,i.node(s),i.before(s),o,!1)))return!0;return!1}function dg(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);r.setMeta("pointer",!0),e.dispatch(r)}function hg(e,t,n,r,o){return ug(e,"handleClickOn",t,n,r)||e.someProp("handleClick",n=>n(e,t,r))||(o?function(e,t){if(-1==t)return!1;let n,r,o=e.state.selection;o instanceof up&&(n=o.node);let i=e.state.doc.resolve(t);for(let s=i.depth+1;s>0;s--){let e=s>i.depth?i.nodeAfter:i.node(s);if(up.isSelectable(e)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(dg(e,up.create(e.state.doc,r)),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&up.isSelectable(r))&&(dg(e,new up(n)),!0)}(e,n))}function pg(e,t,n,r){return ug(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}function fg(e,t,n,r){return ug(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(dg(e,lp.create(r,0,r.content.size)),!0);let o=r.resolve(t);for(let i=o.depth+1;i>0;i--){let t=i>o.depth?o.nodeAfter:o.node(i),n=o.before(i);if(t.inlineContent)dg(e,lp.create(r,n+1,n+1+t.content.size));else{if(!up.isSelectable(t))continue;dg(e,up.create(r,n))}return!0}}(e,n,r)}function mg(e){return Cg(e)}ng.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!vg(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!Sf||!kf||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!xf||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||Hm(e,n)?n.preventDefault():ig(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,lf(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},ng.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},ng.keypress=(e,t)=>{let n=t;if(vg(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||Cf&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let r=e.state.selection;if(!(r instanceof lp&&r.$from.sameParent(r.$to))){let t=String.fromCharCode(n.charCode),o=()=>e.state.tr.insertText(t).scrollIntoView();/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,r.$from.pos,r.$to.pos,t,o))||e.dispatch(o()),n.preventDefault()}};const gg=Cf?"metaKey":"ctrlKey";tg.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let r=mg(e),o=Date.now(),i="singleClick";o-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(n,e.input.lastClick)&&!n[gg]&&e.input.lastClick.button==n.button&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i,button:n.button};let s=e.posAtCoords(cg(n));s&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new yg(e,s,n,!!r)):("doubleClick"==i?pg:fg)(e,s.pos,s.inside,n)?n.preventDefault():ig(e,"pointer"))};class yg{constructor(e,t,n,r){let o,i;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[gg],this.allowDefault=n.shiftKey,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{let n=e.state.doc.resolve(t.pos);o=n.parent,i=n.depth?n.before():0}const s=r?null:n.target,a=s?e.docView.nearestDesc(s,!0):null;this.target=a&&1==a.nodeDOM.nodeType?a.nodeDOM:null;let{selection:l}=e.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof up&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!yf||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ig(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>bm(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(cg(e))),this.updateAllowDefault(e),this.allowDefault||!t?ig(this.view,"pointer"):hg(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||wf&&this.mightDrag&&!this.mightDrag.node.isAtom||kf&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(dg(this.view,op.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):ig(this.view,"pointer")}move(e){this.updateAllowDefault(e),ig(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function vg(e,t){return!!e.composing||!!(wf&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}tg.touchstart=e=>{e.input.lastTouch=Date.now(),mg(e),ig(e,"pointer")},tg.touchmove=e=>{e.input.lastTouch=Date.now(),ig(e,"pointer")},tg.contextmenu=e=>mg(e);const kg=Sf?5e3:-1;function bg(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>Cg(e),t))}function wg(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function xg(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=of(e=e.childNodes[t-1])}else{if(!e.parentNode||sf(e))return null;t=Xp(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||sf(e))return null;t=Xp(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return r}}return n||r}function Cg(e,t=!1){if(!(Sf&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),wg(e),t||e.docView&&e.docView.dirty){let n=vm(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):!e.markCursor&&!t||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}ng.compositionstart=ng.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof lp&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),Cg(e,!0),e.markCursor=null;else if(Cg(e,!t.selection.empty),yf&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}bg(e,kg)},ng.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,bg(e,20))};const _g=mf&&gf<15||xf&&Mf<604;function Sg(e,t,n,r,o){let i=qm(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,o,i||hd.empty)))return!0;if(!i)return!1;let s=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),a=s?e.state.tr.replaceSelectionWith(s,r):e.state.tr.replaceSelection(i);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Eg(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}tg.copy=ng.cut=(e,t)=>{let n=t,r=e.state.selection,o="cut"==n.type;if(r.empty)return;let i=_g?null:n.clipboardData,s=r.content(),{dom:a,text:l}=jm(e,s);i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,a),o&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},ng.paste=(e,t)=>{let n=t;if(e.composing&&!Sf)return;let r=_g?null:n.clipboardData,o=e.input.shiftKey&&45!=e.input.lastKeyCode;r&&Sg(e,Eg(r),r.getData("text/html"),o,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Sg(e,r.value,null,o,t):Sg(e,r.textContent,r.innerHTML,o,t)},50)}(e,n)};class Mg{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const Ag=Cf?"altKey":"ctrlKey";function Dg(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[Ag]}tg.dragstart=(e,t)=>{let n=t,r=e.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o,i=e.state.selection,s=i.empty?null:e.posAtCoords(cg(n));if(s&&s.pos>=i.from&&s.pos<=(i instanceof up?i.to-1:i.to));else if(r&&r.mightDrag)o=up.create(e.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(o=up.create(e.state.doc,t.posBefore))}let a=(o||e.state.selection).content(),{dom:l,text:c,slice:u}=jm(e,a);(!n.dataTransfer.files.length||!kf||bf>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(_g?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",_g||n.dataTransfer.setData("text/plain",c),e.dragging=new Mg(u,Dg(e,n),o)},tg.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},ng.dragover=ng.dragenter=(e,t)=>t.preventDefault(),ng.drop=(e,t)=>{let n=t,r=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let o=e.posAtCoords(cg(n));if(!o)return;let i=e.state.doc.resolve(o.pos),s=r&&r.slice;s?e.someProp("transformPasted",t=>{s=t(s,e,!1)}):s=qm(e,Eg(n.dataTransfer),_g?null:n.dataTransfer.getData("text/html"),!1,i);let a=!(!r||!Dg(e,n));if(e.someProp("handleDrop",t=>t(e,n,s||hd.empty,a)))return void n.preventDefault();if(!s)return;n.preventDefault();let l=s?Vh(e.state.doc,i.pos,s):i.pos;null==l&&(l=i.pos);let c=e.state.tr;if(a){let{node:e}=r;e?e.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(h))return;let p=c.doc.resolve(u);if(d&&up.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new up(p));else{let t=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((e,n,r,o)=>t=o),c.setSelection(Mm(e,p,c.doc.resolve(t)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))},tg.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&bm(e)},20))},tg.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},tg.beforeinput=(e,t)=>{if(kf&&Sf&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,lf(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let os in ng)tg[os]=ng[os];function Tg(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class Og{constructor(e,t){this.toDOM=e,this.spec=t||Lg,this.side=this.spec.side||0}map(e,t,n,r){let{pos:o,deleted:i}=e.mapResult(t.from+r,this.side<0?-1:1);return i?null:new zg(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Og&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Tg(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ng{constructor(e,t){this.attrs=e,this.spec=t||Lg}map(e,t,n,r){let o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new zg(o,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Ng&&Tg(this.attrs,e.attrs)&&Tg(this.spec,e.spec)}static is(e){return e.type instanceof Ng}destroy(){}}class Pg{constructor(e,t){this.attrs=e,this.spec=t||Lg}map(e,t,n,r){let o=e.mapResult(t.from+r,1);if(o.deleted)return null;let i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new zg(o.pos-n,i.pos-n,this)}valid(e,t){let n,{index:r,offset:o}=e.content.findIndex(t.from);return o==t.from&&!(n=e.child(r)).isText&&o+n.nodeSize==t.to}eq(e){return this==e||e instanceof Pg&&Tg(this.attrs,e.attrs)&&Tg(this.spec,e.spec)}destroy(){}}class zg{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new zg(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new zg(e,e,new Og(t,n))}static inline(e,t,n,r){return new zg(e,t,new Ng(n,r))}static node(e,t,n,r){return new zg(e,t,new Pg(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ng}get widget(){return this.type instanceof Og}}const Ig=[],Lg={};class $g{constructor(e,t){this.local=e.length?e:Ig,this.children=t.length?t:Ig}static create(e,t){return t.length?jg(t,e,0,Lg):Rg}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,o){for(let i=0;i<this.local.length;i++){let s=this.local[i];s.from<=t&&s.to>=e&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let s=this.children[i]+1;this.children[i+2].findInner(e-s,t-s,n,r+s,o)}}map(e,t,n){return this==Rg||0==e.maps.length?this:this.mapInner(e,t,0,0,n||Lg)}mapInner(e,t,n,r,o){let i;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(e,n,r);a&&a.type.valid(t,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,o,i,s){let a=e.slice();for(let c=0,u=i;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,r,o)=>{let i=o-r-(n-t);for(let s=0;s<a.length;s+=3){let r=a[s+1];if(r<0||t>r+u-e)continue;let o=a[s]+u-e;n>=o?a[s+1]=t<=o?-2:-1:t>=u&&i&&(a[s]+=i,a[s+1]+=i)}e+=i}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let t=n.map(e[c]+i),u=t-o;if(u<0||u>=r.content.size){l=!0;continue}let d=n.map(e[c+1]+i,-1)-o,{index:h,offset:p}=r.content.findIndex(u),f=r.maybeChild(h);if(f&&p==u&&p+f.nodeSize==d){let r=a[c+2].mapInner(n,f,t+1,e[c]+i+1,s);r!=Rg?(a[c]=u,a[c+1]=d,a[c+2]=r):(a[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,r,o,i,s){function a(e,t){for(let i=0;i<e.local.length;i++){let a=e.local[i].map(r,o,t);a?n.push(a):s.onRemove&&s.onRemove(e.local[i].spec)}for(let n=0;n<e.children.length;n+=3)a(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+i+1);return n}(a,e,t,n,o,i,s),c=jg(l,r,0,s);t=c.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new $g(t.sort(qg),a)}(this.children,i||[],e,t,n,r,o):i?new $g(i.sort(qg),Ig):Rg}add(e,t){return t.length?this==Rg?$g.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,o=0;e.forEach((e,i)=>{let s,a=i+n;if(s=Vg(t,e,a)){for(r||(r=this.children.slice());o<r.length&&r[o]<i;)o+=3;r[o]==i?r[o+2]=r[o+2].addInner(e,s,a+1):r.splice(o,0,i,i+e.nodeSize,jg(s,e,a+1,Lg)),o+=3}});let i=Bg(o?Hg(t):t,-n);for(let s=0;s<i.length;s++)i[s].type.valid(e,i[s])||i.splice(s--,1);return new $g(i.length?this.local.concat(i).sort(qg):this.local,r||this.children)}remove(e){return 0==e.length||this==Rg?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let o=0;o<n.length;o+=3){let r,i=n[o]+t,s=n[o+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>i&&t.to<s&&(e[n]=null,(r||(r=[])).push(t));if(!r)continue;n==this.children&&(n=this.children.slice());let a=n[o+2].removeInner(r,i+1);a!=Rg?n[o+2]=a:(n.splice(o,3),o-=3)}if(r.length)for(let o,i=0;i<e.length;i++)if(o=e[i])for(let e=0;e<r.length;e++)r[e].eq(o,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1));return n==this.children&&r==this.local?this:r.length||n.length?new $g(r,n):Rg}forChild(e,t){if(this==Rg)return this;if(t.isLeaf)return $g.empty;let n,r;for(let s=0;s<this.children.length;s+=3)if(this.children[s]>=e){this.children[s]==e&&(n=this.children[s+2]);break}let o=e+1,i=o+t.content.size;for(let s=0;s<this.local.length;s++){let e=this.local[s];if(e.from<i&&e.to>o&&e.type instanceof Ng){let t=Math.max(o,e.from)-o,n=Math.min(i,e.to)-o;t<n&&(r||(r=[])).push(e.copy(t,n))}}if(r){let e=new $g(r.sort(qg),Ig);return n?new Fg([e,n]):e}return n||Rg}eq(e){if(this==e)return!0;if(!(e instanceof $g)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Kg(this.localsInner(e))}localsInner(e){if(this==Rg)return Ig;if(e.inlineContent||!this.local.some(Ng.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Ng||t.push(this.local[n]);return t}forEachSet(e){e(this)}}$g.empty=new $g([],[]),$g.removeOverlap=Kg;const Rg=$g.empty;class Fg{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,Lg));return Fg.from(n)}forChild(e,t){if(t.isLeaf)return $g.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(e,t);o!=Rg&&(o instanceof Fg?n=n.concat(o.members):n.push(o))}return Fg.from(n)}eq(e){if(!(e instanceof Fg)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<o.length;e++)t.push(o[e])}else t=o}return t?Kg(n?t:t.sort(qg)):Ig}static from(e){switch(e.length){case 0:return Rg;case 1:return e[0];default:return new Fg(e.every(e=>e instanceof $g)?e:e.reduce((e,t)=>e.concat(t instanceof $g?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Bg(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let o=e[r];n.push(new zg(o.from+t,o.to+t,o.type))}return n}function Vg(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,o=null;for(let i,s=0;s<e.length;s++)(i=e[s])&&i.from>n&&i.to<r&&((o||(o=[])).push(i),e[s]=null);return o}function Hg(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function jg(e,t,n,r){let o=[],i=!1;t.forEach((t,s)=>{let a=Vg(e,t,s+n);if(a){i=!0;let e=jg(a,t,n+s+1,r);e!=Rg&&o.push(s,s+t.nodeSize,e)}});let s=Bg(i?Hg(e):e,-n).sort(qg);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new $g(s,o):Rg}function qg(e,t){return e.from-t.from||e.to-t.to}function Kg(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let o=n+1;o<t.length;o++){let i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),Wg(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),Wg(t,o+1,i.copy(r.to,i.to)))}}return t}function Wg(e,t,n){for(;t<e.length&&qg(n,e[t])>0;)t++;e.splice(t,0,n)}function Zg(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=Rg&&t.push(r)}),e.cursorWrapper&&t.push($g.create(e.state.doc,[e.cursorWrapper.deco])),Fg.from(t)}const Ug={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Jg=mf&&gf<=11;class Gg{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Xg{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Gg,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);mf&&gf<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),Jg&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Ug)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Am(this.view)){if(this.suppressingSelectionUpdates)return bm(this.view);if(mf&&gf<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&tf(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let o=e.focusNode;o;o=Yp(o))n.add(o);for(let o=e.anchorNode;o;o=Yp(o))if(n.has(o)){t=o;break}let r=t&&this.view.docView.nearestDesc(t);return r&&r.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Am(e)&&!this.ignoreSelectionChange(n),o=-1,i=-1,s=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],a);e&&(o=o<0?e.from:Math.min(e.from,o),i=i<0?e.to:Math.max(e.to,i),e.typeOver&&(s=!0))}if(yf&&a.length){let t=a.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of t){let t=r.parentNode;!t||"LI"!=t.nodeName||n&&ty(e,n)==t||r.remove()}}}let l=null;o<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&af(n)&&(l=vm(e))&&l.eq(op.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,bm(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||r)&&(o>-1&&(e.docView.markDirty(o,i),function(e){if(Yg.has(e))return;if(Yg.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=yf,Qg)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Qg=!0}}(e)),this.handleDOMChange(o,i,s,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||bm(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,o=e.nextSibling;if(mf&&gf<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:i}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(r=n),(!i||Array.prototype.indexOf.call(e.addedNodes,i)<0)&&(o=i)}let i=r&&r.parentNode==e.target?Xp(r)+1:0,s=n.localPosFromDOM(e.target,i,-1),a=o&&o.parentNode==e.target?Xp(o):e.target.childNodes.length;return{from:s,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Yg=new WeakMap,Qg=!1;function ey(e,t){let n=t.startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return tf(s.node,s.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function ty(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function ny(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(wf&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||wf&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const ry=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function oy(e,t,n,r,o){let i=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=vm(e,t);if(n&&!e.state.selection.eq(n)){if(kf&&Sf&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,lf(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),i&&r.setMeta("composition",i),e.dispatch(r)}return}let s=e.state.doc.resolve(t),a=s.sharedDepth(n);t=s.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l,c,u=e.state.selection,d=function(e,t,n){let r,{node:o,fromOffset:i,toOffset:s,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),u=c.anchorNode;if(u&&e.dom.contains(1==u.nodeType?u:u.parentNode)&&(r=[{node:u,offset:c.anchorOffset}],af(c)||r.push({node:c.focusNode,offset:c.focusOffset})),kf&&8===e.input.lastKeyCode)for(let g=s;g>i;g--){let e=o.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){s=g;break}if(!t||t.size)break}let d=e.state.doc,h=e.someProp("domParser")||Xd.fromSchema(e.state.schema),p=d.resolve(a),f=null,m=h.parse(o,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:r,ruleFromNode:ny,context:p});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),f={anchor:e+a,head:t+a}}return{doc:m,sel:f,from:a,to:l}}(e,t,n),h=e.state.doc,p=h.slice(d.from,d.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,n,r,o){let i=e.findDiffStart(t,n);if(null==i)return null;let{a:s,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==o){r-=s+Math.max(0,i-Math.min(s,a))-i}if(s<i&&e.size<t.size){let e=r<=i&&r>=s?i-r:0;i-=e,i&&i<t.size&&ay(t.textBetween(i-1,i+1))&&(i+=e?1:-1),a=i+(a-s),s=i}else if(a<i){let t=r<=i&&r>=a?i-r:0;i-=t,i&&i<e.size&&ay(e.textBetween(i-1,i+1))&&(i+=t?1:-1),s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}(p.content,d.doc.content,d.from,l,c);if(f&&e.input.domChangeCount++,(xf&&e.input.lastIOSEnter>Date.now()-225||Sf)&&o.some(e=>1==e.nodeType&&!ry.test(e.nodeName))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",t=>t(e,lf(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!f){if(!(r&&u instanceof lp&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||d.sel&&d.sel.anchor!=d.sel.head){if(d.sel){let t=iy(e,e.state.doc,d.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);i&&n.setMeta("composition",i),e.dispatch(n)}}return}f={start:u.from,endA:u.to,endB:u.to}}e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof lp&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),mf&&gf<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>d.from&&" Â "==d.doc.textBetween(f.start-d.from-1,f.start-d.from+1)&&(f.start--,f.endA--,f.endB--);let m=d.doc.resolveNoCache(f.start-d.from),g=d.doc.resolveNoCache(f.endB-d.from),y=h.resolve(f.start),v=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=f.endA;if((xf&&e.input.lastIOSEnter>Date.now()-225&&(!v||o.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!v&&m.pos<d.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&m.pos<g.pos&&!/\S/.test(d.doc.textBetween(m.pos,g.pos,"","")))&&e.someProp("handleKeyDown",t=>t(e,lf(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,n,r,o){if(n-t<=o.pos-r.pos||sy(r,!0,!1)<o.pos)return!1;let i=e.resolve(t);if(!r.parent.isTextblock){let e=i.nodeAfter;return null!=e&&n==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=e.resolve(sy(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||sy(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(h,f.start,f.endA,m,g)&&e.someProp("handleKeyDown",t=>t(e,lf(8,"Backspace"))))return void(Sf&&kf&&e.domObserver.suppressSelectionUpdates());kf&&f.endB==f.start&&(e.input.lastChromeDelete=Date.now()),Sf&&!v&&m.start()!=g.start()&&0==g.parentOffset&&m.depth==g.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==f.endA&&(f.endB-=2,g=d.doc.resolveNoCache(f.endB-d.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,lf(13,"Enter"))})},20));let k,b=f.start,w=f.endA,x=t=>{let n=t||e.state.tr.replace(b,w,d.doc.slice(f.start-d.from,f.endB-d.from));if(d.sel){let t=iy(e,n.doc,d.sel);t&&!(kf&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==b||t.head==n.mapping.map(w)-1)||mf&&t.empty&&t.head==b)&&n.setSelection(t)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(v)if(m.pos==g.pos){mf&&gf<=11&&0==m.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>bm(e),20));let t=x(e.state.tr.delete(b,w)),n=h.resolve(f.start).marksAcross(h.resolve(f.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(f.endA==f.endB&&(k=function(e,t){let n,r,o,i=e.firstChild.marks,s=t.firstChild.marks,a=i,l=s;for(let u=0;u<s.length;u++)a=s[u].removeFromSet(a);for(let u=0;u<i.length;u++)l=i[u].removeFromSet(l);if(1==a.length&&0==l.length)r=a[0],n="add",o=e=>e.mark(r.addToSet(e.marks));else{if(0!=a.length||1!=l.length)return null;r=l[0],n="remove",o=e=>e.mark(r.removeFromSet(e.marks))}let c=[];for(let u=0;u<t.childCount;u++)c.push(o(t.child(u)));if(sd.from(c).eq(e))return{mark:r,type:n}}(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,f.endA-y.start())))){let t=x(e.state.tr);"add"==k.type?t.addMark(b,w,k.mark):t.removeMark(b,w,k.mark),e.dispatch(t)}else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let t=m.parent.textBetween(m.parentOffset,g.parentOffset),n=()=>x(e.state.tr.insertText(t,b,w));e.someProp("handleTextInput",r=>r(e,b,w,t,n))||e.dispatch(n())}else e.dispatch(x());else e.dispatch(x())}function iy(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:Mm(e,t.resolve(n.anchor),t.resolve(n.head))}function sy(e,t,n){let r=e.depth,o=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,o++}return o}function ay(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class ly{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new og,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(py),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=dy(this),uy(this),this.nodeViews=hy(this),this.docView=nm(this.state.doc,cy(this),Zg(this),this.dom,this),this.domObserver=new Xg(this,(e,t,n,r)=>oy(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in tg){let n=tg[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!lg(e,t)||ag(e,t)||!e.editable&&t.type in ng||n(e,t)},rg[t]?{passive:!0}:void 0)}wf&&e.dom.addEventListener("input",()=>null),sg(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&sg(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(py),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let r=this.state,o=!1,i=!1;e.storedMarks&&this.composing&&(wg(this),i=!0),this.state=e;let s=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(s||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=hy(this);(function(e,t){let n=0,r=0;for(let o in e){if(e[o]!=t[o])return!0;n++}for(let o in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,o=!0)}(s||t.handleDOMEvents!=this._props.handleDOMEvents)&&sg(this),this.editable=dy(this),uy(this);let a=Zg(this),l=cy(this),c=r.plugins==e.plugins||r.doc.eq(e.doc)?e.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",u=o||!this.docView.matchesNode(e.doc,l,a);!u&&e.selection.eq(r.selection)||(i=!0);let d="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top);for(let i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){let r=e.root.elementFromPoint(i,s);if(!r||r==e.dom||!e.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=o-20){t=r,n=a.top;break}}return{refDOM:t,refTop:n,stack:Nf(e.dom)}}(this);if(i){this.domObserver.stop();let t=u&&(mf||kf)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(r.selection,e.selection);if(u){let n=kf?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=xg(this)),!o&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=nm(e.doc,l,a,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return tf(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?bm(this,t):(Sm(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():d&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;Pf(n,0==r?0:r-t)}(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof up){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&Of(this,t.getBoundingClientRect(),e)}else Of(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new Mg(e.slice,e.move,r<0?void 0:up.create(this.state.doc,r))}someProp(e,t){let n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(let i=0;i<this.directPlugins.length;i++){let r=this.directPlugins[i].props[e];if(null!=r&&(n=t?t(r):r))return n}let o=this.state.plugins;if(o)for(let i=0;i<o.length;i++){let r=o[i].props[e];if(null!=r&&(n=t?t(r):r))return n}}hasFocus(){if(mf){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(zf)return e.focus(zf);let t=Nf(e);e.focus(null==zf?{get preventScroll(){return zf={preventScroll:!0},!0}}:void 0),zf||(zf=!1,Pf(t,0))}(this.dom),bm(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return Rf(this,e)}coordsAtPos(e,t=1){return Hf(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return Gf(this,t||this.state,e)}pasteHTML(e,t){return Sg(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Sg(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return jm(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Zg(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Qp=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){ag(e,t)||!tg[t.type]||!e.editable&&t.type in ng||tg[t.type](e,t)}(this,e)}domSelectionRange(){let e=this.domSelection();return e?wf&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return ey(e,n)}let n;function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?ey(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function cy(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[zg.node(0,e.state.doc.content.size,t)]}function uy(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:zg.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function dy(e){return!e.someProp("editable",t=>!1===t(e.state))}function hy(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function py(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}ly.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var fy={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},my={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},gy="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),yy="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),vy=0;vy<10;vy++)fy[48+vy]=fy[96+vy]=String(vy);for(vy=1;vy<=24;vy++)fy[vy+111]="F"+vy;for(vy=65;vy<=90;vy++)fy[vy]=String.fromCharCode(vy+32),my[vy]=String.fromCharCode(vy);for(var ky in fy)my.hasOwnProperty(ky)||(my[ky]=fy[ky]);const by="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),wy="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function xy(e){let t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(let a=0;a<i.length-1;a++){let e=i[a];if(/^(cmd|meta|m)$/i.test(e))o=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);by?o=!0:n=!0}}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function Cy(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function _y(e){let t=function(e){let t=Object.create(null);for(let n in e)t[xy(n)]=e[n];return t}(e);return function(e,n){let r,o=function(e){var t=!(gy&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||yy&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?my:fy)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=t[Cy(o,n)];if(i&&i(e.state,e.dispatch,e))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=t[Cy(o,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(wy&&n.ctrlKey&&n.altKey)&&(r=fy[n.keyCode])&&r!=o){let o=t[Cy(r,n)];if(o&&o(e.state,e.dispatch,e))return!0}}return!1}}var Sy=Object.defineProperty,Ey=(e,t)=>{for(var n in t)Sy(e,n,{get:t[n],enumerable:!0})};function My(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}}}var Ay=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{const n=t(...e)(i);return o.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(o),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s=[],a=!!e,l=e||o.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{const r=this.buildProps(l,t),o=n(...e)(r);return s.push(o),c}])),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(l),s.every(e=>!0===e))};return c}createCan(e){const{rawCommands:t,state:n}=this,r=!1,o=e||n.tr,i=this.buildProps(o,r);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,r)}}buildProps(e,t=!0){const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s={tr:e,editor:r,view:i,state:My({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(s)]))}};return s}},Dy={};Ey(Dy,{blur:()=>Ty,clearContent:()=>Oy,clearNodes:()=>Ny,command:()=>Py,createParagraphNear:()=>zy,cut:()=>Iy,deleteCurrentNode:()=>Ly,deleteNode:()=>Ry,deleteRange:()=>Fy,deleteSelection:()=>By,enter:()=>Vy,exitCode:()=>Hy,extendMarkRange:()=>Jy,first:()=>Gy,focus:()=>tv,forEach:()=>nv,insertContent:()=>rv,insertContentAt:()=>av,joinBackward:()=>uv,joinDown:()=>cv,joinForward:()=>dv,joinItemBackward:()=>hv,joinItemForward:()=>pv,joinTextblockBackward:()=>fv,joinTextblockForward:()=>mv,joinUp:()=>lv,keyboardShortcut:()=>yv,lift:()=>kv,liftEmptyBlock:()=>bv,liftListItem:()=>wv,newlineInCode:()=>xv,resetAttributes:()=>Sv,scrollIntoView:()=>Ev,selectAll:()=>Mv,selectNodeBackward:()=>Av,selectNodeForward:()=>Dv,selectParentNode:()=>Tv,selectTextblockEnd:()=>Ov,selectTextblockStart:()=>Nv,setContent:()=>zv,setMark:()=>uk,setMeta:()=>dk,setNode:()=>hk,setNodeSelection:()=>pk,setTextSelection:()=>fk,sinkListItem:()=>mk,splitBlock:()=>yk,splitListItem:()=>vk,toggleList:()=>wk,toggleMark:()=>xk,toggleNode:()=>Ck,toggleWrap:()=>_k,undoInputRule:()=>Sk,unsetAllMarks:()=>Ek,unsetMark:()=>Mk,updateAttributes:()=>Ak,wrapIn:()=>Dk,wrapInList:()=>Tk});var Ty=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null==(n=null==window?void 0:window.getSelection())||n.removeAllRanges())}),!0),Oy=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),Ny=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:o}=r;return!n||(o.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;const{doc:r,mapping:o}=t,i=r.resolve(o.map(n)),s=r.resolve(o.map(n+e.nodeSize)),a=i.blockRange(s);if(!a)return;const l=Nh(a);if(e.type.isTextblock){const{defaultType:e}=i.parent.contentMatchAt(i.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)})}),!0)},Py=e=>t=>e(t),zy=()=>({state:e,dispatch:t})=>Bp(e,t),Iy=(e,t)=>({editor:n,tr:r})=>{const{state:o}=n,i=o.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const s=r.mapping.map(t);return r.insert(s,i.content),r.setSelection(new lp(r.doc.resolve(Math.max(s-1,0)))),!0},Ly=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1){if(o.node(i).type===r.type){if(t){const t=o.before(i),n=o.after(i);e.delete(t,n).scrollIntoView()}return!0}}return!1};function $y(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var Ry=e=>({tr:t,state:n,dispatch:r})=>{const o=$y(e,n.schema),i=t.selection.$anchor;for(let e=i.depth;e>0;e-=1){if(i.node(e).type===o){if(r){const n=i.before(e),r=i.after(e);t.delete(n,r).scrollIntoView()}return!0}}return!1},Fy=e=>({tr:t,dispatch:n})=>{const{from:r,to:o}=e;return n&&t.delete(r,o),!0},By=()=>({state:e,dispatch:t})=>Mp(e,t),Vy=()=>({commands:e})=>e.keyboardShortcut("Enter"),Hy=()=>({state:e,dispatch:t})=>((e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),s=Fp(o.contentMatchAt(i));if(!s||!o.canReplaceWith(i,i,s))return!1;if(t){let r=n.after(),o=e.tr.replaceWith(r,r,s.createAndFill());o.setSelection(op.near(o.doc.resolve(r),1)),t(o.scrollIntoView())}return!0})(e,t);function jy(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function qy(e,t,n={strict:!0}){const r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:jy(t[r])?t[r].test(e[r]):t[r]===e[r])}function Ky(e,t,n={}){return e.find(e=>e.type===t&&qy(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function Wy(e,t,n={}){return!!Ky(e,t,n)}function Zy(e,t,n){var r;if(!e||!t)return;let o=e.parent.childAfter(e.parentOffset);if(o.node&&o.node.marks.some(e=>e.type===t)||(o=e.parent.childBefore(e.parentOffset)),!o.node||!o.node.marks.some(e=>e.type===t))return;n=n||(null==(r=o.node.marks[0])?void 0:r.attrs);if(!Ky([...o.node.marks],t,n))return;let i=o.index,s=e.start()+o.offset,a=i+1,l=s+o.node.nodeSize;for(;i>0&&Wy([...e.parent.child(i-1).marks],t,n);)i-=1,s-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&Wy([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function Uy(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var Jy=(e,t={})=>({tr:n,state:r,dispatch:o})=>{const i=Uy(e,r.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:u}=a;if(o){const e=Zy(l,i,t);if(e&&e.from<=c&&e.to>=u){const t=lp.create(s,e.from,e.to);n.setSelection(t)}}return!0},Gy=e=>t=>{const n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1};function Xy(e){return e instanceof lp}function Yy(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Qy(e,t=null){if(!t)return null;const n=op.atStart(e),r=op.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;const o=n.from,i=r.to;return"all"===t?lp.create(e,Yy(0,o,i),Yy(e.content.size,o,i)):lp.create(e,Yy(t,o,i),Yy(t,o,i))}function ev(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var tv=(e=null,t={})=>({editor:n,view:r,tr:o,dispatch:i})=>{t={scrollIntoView:!0,...t};const s=()=>{(ev()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(i&&null===e&&!Xy(n.state.selection))return s(),!0;const a=Qy(o.doc,e)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},nv=(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),rv=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),ov=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&ov(r)}return e};function iv(e){if("undefined"==typeof window)throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${e}</body>`,n=(new window.DOMParser).parseFromString(t,"text/html").body;return ov(n)}function sv(e,t,n){if(e instanceof Td||e instanceof sd)return e;n={slice:!0,parseOptions:{},...n};const r="string"==typeof e;if("object"==typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return sd.fromArray(e.map(e=>t.nodeFromJSON(e)));const r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),sv("",t,n)}if(r){if(n.errorOnInvalidContent){let r=!1,o="";const i=new Jd({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,o="string"==typeof e?e:e.outerHTML,null)}]}})});if(n.slice?Xd.fromSchema(i).parseSlice(iv(e),n.parseOptions):Xd.fromSchema(i).parse(iv(e),n.parseOptions),n.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const r=Xd.fromSchema(t);return n.slice?r.parseSlice(iv(e),n.parseOptions).content:r.parse(iv(e),n.parseOptions)}return sv("",t,n)}var av=(e,t,n)=>({tr:r,dispatch:o,editor:i})=>{var s;if(o){let o;const a=e=>{i.emit("contentError",{editor:i,error:e,disableCollaboration:()=>{"collaboration"in i.storage&&"object"==typeof i.storage.collaboration&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},l={preserveWhitespace:"full",...(n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n}).parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{sv(t,i.schema,{parseOptions:l,errorOnInvalidContent:!0})}catch(uA){a(uA)}try{o=sv(t,i.schema,{parseOptions:l,errorOnInvalidContent:null!=(s=n.errorOnInvalidContent)?s:i.options.enableContentCheck})}catch(uA){return a(uA),!1}let{from:c,to:u}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},d=!0,h=!0;if(("type"in o?[o]:o).forEach(e=>{e.check(),d=!!d&&(e.isText&&0===e.marks.length),h=!!h&&e.isBlock}),c===u&&h){const{parent:e}=r.doc.resolve(c);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(c-=1,u+=1)}let p;if(d){if(Array.isArray(t))p=t.map(e=>e.text||"").join("");else if(t instanceof sd){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),p=e}else p="object"==typeof t&&t&&t.text?t.text:t;r.insertText(p,c,u)}else{p=o;const e=r.doc.resolve(c),t=e.node(),n=0===e.parentOffset,i=t.isText||t.isTextblock,s=t.content.size>0;n&&i&&s&&(c=Math.max(0,c-1)),r.replaceWith(c,u,p)}n.updateSelection&&function(e,t,n){const r=e.steps.length-1;if(r<t)return;const o=e.steps[r];if(!(o instanceof Mh||o instanceof Ah))return;const i=e.mapping.maps[r];let s=0;i.forEach((e,t,n,r)=>{0===s&&(s=r)}),e.setSelection(op.near(e.doc.resolve(s),n))}(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:p}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:p})}return!0},lv=()=>({state:e,dispatch:t})=>((e,t)=>{let n,r=e.selection,o=r instanceof up;if(o){if(r.node.isTextblock||!Rh(e.doc,r.from))return!1;n=r.from}else if(n=Bh(e.doc,r.from,-1),null==n)return!1;if(t){let r=e.tr.join(n);o&&r.setSelection(up.create(r.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(r.scrollIntoView())}return!0})(e,t),cv=()=>({state:e,dispatch:t})=>((e,t)=>{let n,r=e.selection;if(r instanceof up){if(r.node.isTextblock||!Rh(e.doc,r.to))return!1;n=r.to}else if(n=Bh(e.doc,r.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(e,t),uv=()=>({state:e,dispatch:t})=>Dp(e,t),dv=()=>({state:e,dispatch:t})=>Ip(e,t),hv=()=>({state:e,dispatch:t,tr:n})=>{try{const r=Bh(e.doc,e.selection.$from.pos,-1);return null!=r&&(n.join(r,2),t&&t(n),!0)}catch{return!1}},pv=()=>({state:e,dispatch:t,tr:n})=>{try{const r=Bh(e.doc,e.selection.$from.pos,1);return null!=r&&(n.join(r,2),t&&t(n),!0)}catch{return!1}},fv=()=>({state:e,dispatch:t})=>((e,t,n)=>{let r=Ap(e,n);if(!r)return!1;let o=Pp(r);return!!o&&Tp(e,o,t)})(e,t),mv=()=>({state:e,dispatch:t})=>((e,t,n)=>{let r=zp(e,n);if(!r)return!1;let o=$p(r);return!!o&&Tp(e,o,t)})(e,t);function gv(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}var yv=e=>({editor:t,view:n,tr:r,dispatch:o})=>{const i=function(e){const t=e.split(/-(?!$)/);let n,r,o,i,s=t[t.length-1];"Space"===s&&(s=" ");for(let a=0;a<t.length-1;a+=1){const e=t[a];if(/^(cmd|meta|m)$/i.test(e))i=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))r=!0;else if(/^s(hift)?$/i.test(e))o=!0;else{if(!/^mod$/i.test(e))throw new Error(`Unrecognized modifier name: ${e}`);ev()||gv()?i=!0:r=!0}}return n&&(s=`Alt-${s}`),r&&(s=`Ctrl-${s}`),i&&(s=`Meta-${s}`),o&&(s=`Shift-${s}`),s}(e).split(/-(?!$)/),s=i.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{const t=e.map(r.mapping);t&&o&&r.maybeStep(t)}),!0};function vv(e,t,n={}){const{from:r,to:o,empty:i}=e.selection,s=t?$y(t,e.schema):null,a=[];e.doc.nodesBetween(r,o,(e,t)=>{if(e.isText)return;const n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);a.push({node:e,from:n,to:i})});const l=o-r,c=a.filter(e=>!s||s.name===e.node.type.name).filter(e=>qy(e.node.attrs,n,{strict:!1}));if(i)return!!c.length;return c.reduce((e,t)=>e+t.to-t.from,0)>=l}var kv=(e,t={})=>({state:n,dispatch:r})=>!!vv(n,$y(e,n.schema),t)&&((e,t)=>{let{$from:n,$to:r}=e.selection,o=n.blockRange(r),i=o&&Nh(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)})(n,r),bv=()=>({state:e,dispatch:t})=>Vp(e,t),wv=e=>({state:t,dispatch:n})=>Gp($y(e,t.schema))(t,n),xv=()=>({state:e,dispatch:t})=>Rp(e,t);function Cv(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function _v(e,t){const n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}var Sv=(e,t)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=Cv("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=$y(e,r.schema)),"mark"===a&&(s=Uy(e,r.schema)),o&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{i&&i===e.type&&n.setNodeMarkup(r,void 0,_v(e.attrs,t)),s&&e.marks.length&&e.marks.forEach(o=>{s===o.type&&n.addMark(r,r+e.nodeSize,s.create(_v(o.attrs,t)))})})}),!0)},Ev=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Mv=()=>({tr:e,dispatch:t})=>{if(t){const t=new hp(e.doc);e.setSelection(t)}return!0},Av=()=>({state:e,dispatch:t})=>Np(e,t),Dv=()=>({state:e,dispatch:t})=>Lp(e,t),Tv=()=>({state:e,dispatch:t})=>((e,t)=>{let n,{$from:r,to:o}=e.selection,i=r.sharedDepth(o);return 0!=i&&(n=r.before(i),t&&t(e.tr.setSelection(up.create(e.doc,n))),!0)})(e,t),Ov=()=>({state:e,dispatch:t})=>Wp(e,t),Nv=()=>({state:e,dispatch:t})=>Kp(e,t);function Pv(e,t,n={},r={}){return sv(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var zv=(e,{errorOnInvalidContent:t,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:o,tr:i,dispatch:s,commands:a})=>{const{doc:l}=i;if("full"!==r.preserveWhitespace){const a=Pv(e,o.schema,r,{errorOnInvalidContent:null!=t?t:o.options.enableContentCheck});return s&&i.replaceWith(0,l.content.size,a).setMeta("preventUpdate",!n),!0}return s&&i.setMeta("preventUpdate",!n),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:r,errorOnInvalidContent:null!=t?t:o.options.enableContentCheck})};function Iv(e,t){const n=Uy(t,e.schema),{from:r,to:o,empty:i}=e.selection,s=[];i?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,o,e=>{s.push(...e.marks)});const a=s.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function Lv(e,t){const n=new np(e);return t.forEach(e=>{e.steps.forEach(e=>{n.step(e)})}),n}function $v(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}(t.$from,e)}function Rv(e,t,n){if(void 0===e.config[t]&&e.parent)return Rv(e.parent,t,n);if("function"==typeof e.config[t]){return e.config[t].bind({...n,parent:e.parent?Rv(e.parent,t,n):null})}return e.config[t]}function Fv(e){return e.map(e=>{const t=Rv(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...Fv(t())]:e}).flat(10)}function Bv(e,t){const n=ah.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function Vv(e){return"function"==typeof e}function Hv(e,t=void 0,...n){return Vv(e)?t?e.bind(t)(...n):e(...n):e}function jv(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function qv(e){const t=[],{nodeExtensions:n,markExtensions:r}=jv(e),o=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{const n=Rv(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:o});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...i,...r}})})})})}),o.forEach(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Rv(e,"addAttributes",n);if(!r)return;const o=r();Object.entries(o).forEach(([n,r])=>{const o={...i,...r};"function"==typeof(null==o?void 0:o.default)&&(o.default=o.default()),(null==o?void 0:o.isRequired)&&void 0===(null==o?void 0:o.default)&&delete o.default,t.push({type:e.name,name:n,attribute:o})})}),t}function Kv(...e){return e.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([e,t])=>{if(n[e])if("class"===e){const r=t?String(t).split(" "):[],o=n[e]?n[e].split(" "):[],i=r.filter(e=>!o.includes(e));n[e]=[...o,...i].join(" ")}else if("style"===e){const r=t?t.split(";").map(e=>e.trim()).filter(Boolean):[],o=n[e]?n[e].split(";").map(e=>e.trim()).filter(Boolean):[],i=new Map;o.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),r.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),n[e]=Array.from(i.entries()).map(([e,t])=>`${e}: ${t}`).join("; ")}else n[e]=t;else n[e]=t}),n},{})}function Wv(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>Kv(e,t),{})}function Zv(e,t){return"style"in e?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;const o=t.reduce((e,t)=>{const r=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!=typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null==r?e:{...e,[t.name]:r}},{});return{...r,...o}}}}function Uv(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>("attrs"!==e||!function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function Jv(e){return e.sort((e,t)=>{const n=Rv(e,"priority")||100,r=Rv(t,"priority")||100;return n>r?-1:n<r?1:0})}function Gv(e){const t=Jv(Fv(e)),n=function(e){const t=e.filter((t,n)=>e.indexOf(t)!==n);return Array.from(new Set(t))}(t.map(e=>e.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),t}function Xv(e,t,n){const{from:r,to:o}=t,{blockSeparator:i="\n\n",textSerializers:s={}}=n||{};let a="";return e.nodesBetween(r,o,(e,n,l,c)=>{var u;e.isBlock&&n>r&&(a+=i);const d=null==s?void 0:s[e.type.name];if(d)return l&&(a+=d({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null==(u=null==e?void 0:e.text)?void 0:u.slice(Math.max(r,n)-n,o-n))}),a}function Yv(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function Qv(e,t){const n=Cv("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=$y(t,e.schema),{from:r,to:o}=e.selection,i=[];e.doc.nodesBetween(r,o,e=>{i.push(e)});const s=i.reverse().find(e=>e.type.name===n.name);return s?{...s.attrs}:{}}(e,t):"mark"===n?Iv(e,t):{}}function ek(e){const t=function(e,t=JSON.stringify){const n={};return e.filter(e=>{const r=t(e);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(e);return 1===t.length?t:t.filter((e,n)=>{const r=t.filter((e,t)=>t!==n);return!r.some(t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to)})}function tk(e){const{mapping:t,steps:n}=e,r=[];return t.maps.forEach((e,o)=>{const i=[];if(e.ranges.length)e.forEach((e,t)=>{i.push({from:e,to:t})});else{const{from:e,to:t}=n[o];if(void 0===e||void 0===t)return;i.push({from:e,to:t})}i.forEach(({from:e,to:n})=>{const i=t.slice(o).map(e,-1),s=t.slice(o).map(n),a=t.invert().map(i,-1),l=t.invert().map(s);r.push({oldRange:{from:a,to:l},newRange:{from:i,to:s}})})}),ek(r)}function nk(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(t=>{const o=Zy(n.resolve(e),t.type);o&&r.push({mark:t,...o})}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==(null==e?void 0:e.nodeSize)&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function rk(e,t){return t.nodes[e]||t.marks[e]||null}function ok(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{const r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function ik(e,t,n={}){const{empty:r,ranges:o}=e.selection,i=t?Uy(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!i||i.name===e.type.name).find(e=>qy(e.attrs,n,{strict:!1}));let s=0;const a=[];if(o.forEach(({$from:t,$to:n})=>{const r=t.pos,o=n.pos;e.doc.nodesBetween(r,o,(e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);s+=i-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:i})))})}),0===s)return!1;const l=a.filter(e=>!i||i.name===e.mark.type.name).filter(e=>qy(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!i||e.mark.type!==i&&e.mark.type.excludes(i)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=s}function sk(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}function ak(e,t){const{nodeExtensions:n}=jv(t),r=n.find(t=>t.name===e);if(!r)return!1;const o=Hv(Rv(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"==typeof o&&o.split(" ").includes("list")}function lk(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!=(r=e.text)?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(lk(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function ck(e){return e instanceof up}var uk=(e,t={})=>({tr:n,state:r,dispatch:o})=>{const{selection:i}=n,{empty:s,ranges:a}=i,l=Uy(e,r.schema);if(o)if(s){const e=Iv(r,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach(e=>{const o=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(o,i,(e,r)=>{const s=Math.max(r,o),a=Math.min(r+e.nodeSize,i);e.marks.find(e=>e.type===l)?e.marks.forEach(e=>{l===e.type&&n.addMark(s,a,l.create({...e.attrs,...t}))}):n.addMark(s,a,l.create(t))})});return function(e,t,n){var r;const{selection:o}=t;let i=null;if(Xy(o)&&(i=o.$cursor),i){const t=null!=(r=e.storedMarks)?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(t)||!t.some(e=>e.type.excludes(n)))}const{ranges:s}=o;return s.some(({$from:t,$to:r})=>{let o=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(o)return!1;if(e.isInline){const t=!r||r.type.allowsMarkType(n),i=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));o=t&&i}return!o}),o})}(r,n,l)},dk=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),hk=(e,t={})=>({state:n,dispatch:r,chain:o})=>{const i=$y(e,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),i.isTextblock?o().command(({commands:e})=>!!Zp(i,{...s,...t})(n)||e.clearNodes()).command(({state:e})=>Zp(i,{...s,...t})(e,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},pk=e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,r=Yy(e,0,n.content.size),o=up.create(n,r);t.setSelection(o)}return!0},fk=e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,{from:r,to:o}="number"==typeof e?{from:e,to:e}:e,i=lp.atStart(n).from,s=lp.atEnd(n).to,a=Yy(r,i,s),l=Yy(o,i,s),c=lp.create(n,a,l);t.setSelection(c)}return!0},mk=e=>({state:t,dispatch:n})=>{const r=$y(e,t.schema);return(o=r,function(e,t){let{$from:n,$to:r}=e.selection,i=n.blockRange(r,e=>e.childCount>0&&e.firstChild.type==o);if(!i)return!1;let s=i.startIndex;if(0==s)return!1;let a=i.parent,l=a.child(s-1);if(l.type!=o)return!1;if(t){let n=l.lastChild&&l.lastChild.type==a.type,r=sd.from(n?o.create():null),s=new hd(sd.from(o.create(null,sd.from(a.type.create(null,r)))),n?3:1,0),c=i.start,u=i.end;t(e.tr.step(new Ah(c-(n?3:1),u,c,u,s,1,!0)).scrollIntoView())}return!0})(t,n);var o};function gk(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}var yk=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:o})=>{const{selection:i,doc:s}=t,{$from:a,$to:l}=i,c=ok(o.extensionManager.attributes,a.node().type.name,a.node().attrs);if(i instanceof up&&i.node.isBlock)return!(!a.parentOffset||!$h(s,a.pos))&&(r&&(e&&gk(n,o.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const u=l.parentOffset===l.parent.content.size,d=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=u&&d?[{type:d,attrs:c}]:void 0,p=$h(t.doc,t.mapping.map(a.pos),1,h);if(h||p||!$h(t.doc,t.mapping.map(a.pos),1,d?[{type:d}]:void 0)||(p=!0,h=d?[{type:d,attrs:c}]:void 0),r){if(p&&(i instanceof lp&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,h),d&&!u&&!a.parentOffset&&a.parent.type!==d)){const e=t.mapping.map(a.before()),n=t.doc.resolve(e);a.node(-1).canReplaceWith(n.index(),n.index()+1,d)&&t.setNodeMarkup(t.mapping.map(a.before()),d)}e&&gk(n,o.extensionManager.splittableMarks),t.scrollIntoView()}return p},vk=(e,t={})=>({tr:n,state:r,dispatch:o,editor:i})=>{var s;const a=$y(e,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=i.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(o){let e=sd.empty;const r=l.index(-1)?1:l.index(-2)?2:3;for(let t=l.depth-r;t>=l.depth-3;t-=1)e=sd.from(l.node(t).copy(e));const o=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,i={...ok(h,l.node().type.name,l.node().attrs),...t},c=(null==(s=a.contentMatch.defaultType)?void 0:s.createAndFill(i))||void 0;e=e.append(sd.from(a.createAndFill(null,c)||void 0));const u=l.before(l.depth-(r-1));n.replace(u,l.after(-o),new hd(e,4-r,0));let d=-1;n.doc.nodesBetween(u,n.doc.content.size,(e,t)=>{if(d>-1)return!1;e.isTextblock&&0===e.content.size&&(d=t+1)}),d>-1&&n.setSelection(lp.near(n.doc.resolve(d))),n.scrollIntoView()}return!0}const p=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,f={...ok(h,d.type.name,d.attrs),...t},m={...ok(h,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,c.pos);const g=p?[{type:a,attrs:f},{type:p,attrs:m}]:[{type:a,attrs:f}];if(!$h(n.doc,l.pos,2))return!1;if(o){const{selection:e,storedMarks:t}=r,{splittableMarks:s}=i.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(n.split(l.pos,2,g).scrollIntoView(),!a||!o)return!0;const c=a.filter(e=>s.includes(e.type.name));n.ensureMarks(c)}return!0},kk=(e,t)=>{const n=$v(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const o=e.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!Rh(e.doc,n.pos)||(e.join(n.pos),!0)},bk=(e,t)=>{const n=$v(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const o=e.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!Rh(e.doc,r)||(e.join(r),!0)},wk=(e,t,n,r={})=>({editor:o,tr:i,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=o.extensionManager,p=$y(e,s.schema),f=$y(t,s.schema),{selection:m,storedMarks:g}=s,{$from:y,$to:v}=m,k=y.blockRange(v),b=g||m.$to.parentOffset&&m.$from.marks();if(!k)return!1;const w=$v(e=>ak(e.type.name,d))(m);if(k.depth>=1&&w&&k.depth-w.depth<=1){if(w.node.type===p)return c.liftListItem(f);if(ak(w.node.type.name,d)&&p.validContent(w.node.content)&&a)return l().command(()=>(i.setNodeMarkup(w.pos,p),!0)).command(()=>kk(i,p)).command(()=>bk(i,p)).run()}return n&&b&&a?l().command(()=>{const e=u().wrapInList(p,r),t=b.filter(e=>h.includes(e.type.name));return i.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(p,r).command(()=>kk(i,p)).command(()=>bk(i,p)).run():l().command(()=>!!u().wrapInList(p,r)||c.clearNodes()).wrapInList(p,r).command(()=>kk(i,p)).command(()=>bk(i,p)).run()},xk=(e,t={},n={})=>({state:r,commands:o})=>{const{extendEmptyMarkRange:i=!1}=n,s=Uy(e,r.schema);return ik(r,s,t)?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,t)},Ck=(e,t,n={})=>({state:r,commands:o})=>{const i=$y(e,r.schema),s=$y(t,r.schema),a=vv(r,i,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?o.setNode(s,l):o.setNode(i,{...l,...n})},_k=(e,t={})=>({state:n,commands:r})=>{const o=$y(e,n.schema);return vv(n,o,t)?r.lift(o):r.wrapIn(o,t)},Sk=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const o=n[r];let i;if(o.spec.isInputRules&&(i=o.getState(e))){if(t){const t=e.tr,n=i.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(i.text){const n=t.doc.resolve(i.from).marks();t.replaceWith(i.from,i.to,e.schema.text(i.text,n))}else t.delete(i.from,i.to)}return!0}}return!1},Ek=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:o}=n;return r||t&&o.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0},Mk=(e,t={})=>({tr:n,state:r,dispatch:o})=>{var i;const{extendEmptyMarkRange:s=!1}=t,{selection:a}=n,l=Uy(e,r.schema),{$from:c,empty:u,ranges:d}=a;if(!o)return!0;if(u&&s){let{from:e,to:t}=a;const r=null==(i=c.marks().find(e=>e.type===l))?void 0:i.attrs,o=Zy(c,l,r);o&&(e=o.from,t=o.to),n.removeMark(e,t,l)}else d.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},Ak=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=Cv("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=$y(e,r.schema)),"mark"===a&&(s=Uy(e,r.schema)),o&&n.selection.ranges.forEach(e=>{const o=e.$from.pos,a=e.$to.pos;let l,c,u,d;n.selection.empty?r.doc.nodesBetween(o,a,(e,t)=>{i&&i===e.type&&(u=Math.max(t,o),d=Math.min(t+e.nodeSize,a),l=t,c=e)}):r.doc.nodesBetween(o,a,(e,r)=>{r<o&&i&&i===e.type&&(u=Math.max(r,o),d=Math.min(r+e.nodeSize,a),l=r,c=e),r>=o&&r<=a&&(i&&i===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),s&&e.marks.length&&e.marks.forEach(i=>{if(s===i.type){const l=Math.max(r,o),c=Math.min(r+e.nodeSize,a);n.addMark(l,c,s.create({...i.attrs,...t}))}}))}),c&&(void 0!==l&&n.setNodeMarkup(l,void 0,{...c.attrs,...t}),s&&c.marks.length&&c.marks.forEach(e=>{s===e.type&&n.addMark(u,d,s.create({...e.attrs,...t}))}))}),!0)},Dk=(e,t={})=>({state:n,dispatch:r})=>function(e,t=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i),a=s&&Ph(s,e,t);return!!a&&(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0)}}($y(e,n.schema),t)(n,r),Tk=(e,t={})=>({state:n,dispatch:r})=>Jp($y(e,n.schema),t)(n,r),Ok=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){const n=(...r)=>{this.off(e,n),t.apply(this,r)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}},Nk=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=null==(t=e.undoable)||t}};function Pk(e){var t;const{editor:n,from:r,to:o,text:i,rules:s,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(t=c.nodeBefore||c.nodeAfter)?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let u=!1;const d=((e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,o,i)=>{var s,a;const l=(null==(a=(s=e.type.spec).toText)?void 0:a.call(s,{node:e,pos:t,parent:o,index:i}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,r-t))}),n})(c)+i;return s.forEach(e=>{if(u)return;const t=((e,t)=>{if(jy(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(d,e.find);if(!t)return;const s=l.state.tr,c=My({state:l.state,transaction:s}),h={from:r-(t[0].length-i.length),to:o},{commands:p,chain:f,can:m}=new Ay({editor:n,state:c});null!==e.handler({state:c,range:h,match:t,commands:p,chain:f,can:m})&&s.steps.length&&(e.undoable&&s.setMeta(a,{transform:s,from:r,to:o,text:i}),l.dispatch(s),u=!0)}),u}function zk(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function Ik(e,t){const n={...e};return zk(e)&&zk(t)&&Object.keys(t).forEach(r=>{zk(t[r])&&zk(e[r])?n[r]=Ik(e[r],t[r]):n[r]=t[r]}),n}var Lk=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...Hv(Rv(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Hv(Rv(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Ik(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},$k=class e extends Lk{constructor(){super(...arguments),this.type="mark"}static create(t={}){const n="function"==typeof t?t():t;return new e(n)}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;const i=o.find(e=>(null==e?void 0:e.type.name)===t.name);return i&&n.removeStoredMark(i),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){const t="function"==typeof e?e():e;return super.extend(t)}};var Rk=class{constructor(e){this.find=e.find,this.handler=e.handler}};function Fk(e){const{editor:t,state:n,from:r,to:o,rule:i,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:u}=new Ay({editor:t,state:n}),d=[];n.doc.nodesBetween(r,o,(e,t)=>{var h,p,f,m,g;if((null==(p=null==(h=e.type)?void 0:h.spec)?void 0:p.code)||!(e.isText||e.isTextblock||e.isInline))return;const y=null!=(g=null!=(m=null==(f=e.content)?void 0:f.size)?m:e.nodeSize)?g:0,v=Math.max(r,t),k=Math.min(o,t+y);if(v>=k)return;((e,t,n)=>{if(jy(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]})(e.isText?e.text||"":e.textBetween(v-t,k-t,void 0,"ï¿¼"),i.find,s).forEach(e=>{if(void 0===e.index)return;const t=v+e.index+1,r=t+e[0].length,o={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},h=i.handler({state:n,range:o,match:e,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(h)})});return d.every(e=>null!==e)}var Bk=null;function Vk(e){const{editor:t,rules:n}=e;let r,o=null,i=!1,s=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}const l=({state:e,from:n,to:o,rule:i,pasteEvt:s})=>{const l=e.tr,c=My({state:e,transaction:l});if(Fk({editor:t,state:c,from:Math.max(n-1,0),to:o.b-1,rule:i,pasteEvent:s,dropEvent:r})&&l.steps.length){try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}return a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,l}};return n.map(e=>new Cp({view(e){const n=n=>{var r;o=(null==(r=e.dom.parentElement)?void 0:r.contains(n.target))?e.dom.parentElement:null,o&&(Bk=t)},r=()=>{Bk&&(Bk=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(s=o===e.dom.parentElement,r=t,!s){const e=Bk;(null==e?void 0:e.isEditable)&&setTimeout(()=>{const t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;const r=null==(n=t.clipboardData)?void 0:n.getData("text/html");return a=t,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{const o=t[0],c="paste"===o.getMeta("uiEvent")&&!i,u="drop"===o.getMeta("uiEvent")&&!s,d=o.getMeta("applyPasteRules"),h=!!d;if(!c&&!u&&!h)return;if(h){let{text:t}=d;"string"==typeof t||(t=Bv(sd.from(t),r.schema));const{from:n}=d,o=n+t.length,i=(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(t=n.clipboardData)||t.setData("text/html",e),n})(t);return l({rule:e,state:r,from:n,to:{b:o},pasteEvt:i})}const p=n.doc.content.findDiffStart(r.doc.content),f=n.doc.content.findDiffEnd(r.doc.content);return"number"==typeof p&&f&&p!==f.b?l({rule:e,state:r,from:p,to:f,pasteEvt:a}):void 0}}))}var Hk=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=Gv(e),this.schema=function(e,t){var n;const r=qv(e),{nodeExtensions:o,markExtensions:i}=jv(e),s=null==(n=o.find(e=>Rv(e,"topNode")))?void 0:n.name,a=Object.fromEntries(o.map(n=>{const o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=Uv({...e.reduce((e,t)=>{const r=Rv(t,"extendNodeSchema",i);return{...e,...r?r(n):{}}},{}),content:Hv(Rv(n,"content",i)),marks:Hv(Rv(n,"marks",i)),group:Hv(Rv(n,"group",i)),inline:Hv(Rv(n,"inline",i)),atom:Hv(Rv(n,"atom",i)),selectable:Hv(Rv(n,"selectable",i)),draggable:Hv(Rv(n,"draggable",i)),code:Hv(Rv(n,"code",i)),whitespace:Hv(Rv(n,"whitespace",i)),linebreakReplacement:Hv(Rv(n,"linebreakReplacement",i)),defining:Hv(Rv(n,"defining",i)),isolating:Hv(Rv(n,"isolating",i)),attrs:Object.fromEntries(o.map(e=>{var t,n;return[e.name,{default:null==(t=null==e?void 0:e.attribute)?void 0:t.default,validate:null==(n=null==e?void 0:e.attribute)?void 0:n.validate}]}))}),a=Hv(Rv(n,"parseHTML",i));a&&(s.parseDOM=a.map(e=>Zv(e,o)));const l=Rv(n,"renderHTML",i);l&&(s.toDOM=e=>l({node:e,HTMLAttributes:Wv(e,o)}));const c=Rv(n,"renderText",i);return c&&(s.toText=c),[n.name,s]})),l=Object.fromEntries(i.map(n=>{const o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=Uv({...e.reduce((e,t)=>{const r=Rv(t,"extendMarkSchema",i);return{...e,...r?r(n):{}}},{}),inclusive:Hv(Rv(n,"inclusive",i)),excludes:Hv(Rv(n,"excludes",i)),group:Hv(Rv(n,"group",i)),spanning:Hv(Rv(n,"spanning",i)),code:Hv(Rv(n,"code",i)),attrs:Object.fromEntries(o.map(e=>{var t,n;return[e.name,{default:null==(t=null==e?void 0:e.attribute)?void 0:t.default,validate:null==(n=null==e?void 0:e.attribute)?void 0:n.validate}]}))}),a=Hv(Rv(n,"parseHTML",i));a&&(s.parseDOM=a.map(e=>Zv(e,o)));const l=Rv(n,"renderHTML",i);return l&&(s.toDOM=e=>l({mark:e,HTMLAttributes:Wv(e,o)})),[n.name,s]}));return new Jd({topNode:s,nodes:a,marks:l})}(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const n=Rv(t,"addCommands",{name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:rk(t.name,this.schema)});return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this;return Jv([...this.extensions].reverse()).flatMap(t=>{const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:rk(t.name,this.schema)},r=[],o=Rv(t,"addKeyboardShortcuts",n);let i={};if("mark"===t.type&&Rv(t,"exitable",n)&&(i.ArrowRight=()=>$k.handleExit({editor:e,mark:t})),o){const t=Object.fromEntries(Object.entries(o()).map(([t,n])=>[t,()=>n({editor:e})]));i={...i,...t}}const s=new Cp({props:{handleKeyDown:_y(i)}});r.push(s);const a=Rv(t,"addInputRules",n);if(sk(t,e.options.enableInputRules)&&a){const t=a();if(t&&t.length){const n=function(e){const{editor:t,rules:n}=e,r=new Cp({state:{init:()=>null,apply(e,o,i){const s=e.getMeta(r);if(s)return s;const a=e.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:e}=a;"string"==typeof e||(e=Bv(sd.from(e),i.schema));const{from:o}=a,s=o+e.length;Pk({editor:t,from:o,to:s,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:o}},props:{handleTextInput:(e,o,i,s)=>Pk({editor:t,from:o,to:i,text:s,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{const{$cursor:o}=e.state.selection;o&&Pk({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,o){if("Enter"!==o.key)return!1;const{$cursor:i}=e.state.selection;return!!i&&Pk({editor:t,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:t}),o=Array.isArray(n)?n:[n];r.push(...o)}}const l=Rv(t,"addPasteRules",n);if(sk(t,e.options.enablePasteRules)&&l){const t=l();if(t&&t.length){const n=Vk({editor:e,rules:t});r.push(...n)}}const c=Rv(t,"addProseMirrorPlugins",n);if(c){const e=c();r.push(...e)}return r})}get attributes(){return qv(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=jv(this.extensions);return Object.fromEntries(t.filter(e=>!!Rv(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:$y(t.name,this.schema)},o=Rv(t,"addNodeView",r);if(!o)return[];return[t.name,(r,i,s,a,l)=>{const c=Wv(r,n);return o()({node:r,view:i,getPos:s,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]}))}get markViews(){const{editor:e}=this,{markExtensions:t}=jv(this.extensions);return Object.fromEntries(t.filter(e=>!!Rv(e,"addMarkView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:Uy(t.name,this.schema)},o=Rv(t,"addMarkView",r);if(!o)return[];return[t.name,(r,i,s)=>{const a=Wv(r,n);return o()({mark:r,view:i,inline:s,editor:e,extension:t,HTMLAttributes:a,updateAttributes:t=>{!function(e,t,n={}){const{state:r}=t,{doc:o,tr:i}=r,s=e;o.descendants((t,r)=>{const o=i.mapping.map(r),a=i.mapping.map(r)+t.nodeSize;let l=null;if(t.marks.forEach(e=>{if(e!==s)return!1;l=e}),!l)return;let c=!1;if(Object.keys(n).forEach(e=>{n[e]!==l.attrs[e]&&(c=!0)}),c){const t=e.type.create({...e.attrs,...n});i.removeMark(o,a,e.type),i.addMark(o,a,t)}}),i.docChanged&&t.view.dispatch(i)}(r,e,t)}})}]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(e=>[e.name,e.storage])),e.forEach(e=>{var t;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:rk(e.name,this.schema)};if("mark"===e.type){(null==(t=Hv(Rv(e,"keepOnSplit",n)))||t)&&this.splittableMarks.push(e.name)}const r=Rv(e,"onBeforeCreate",n),o=Rv(e,"onCreate",n),i=Rv(e,"onUpdate",n),s=Rv(e,"onSelectionUpdate",n),a=Rv(e,"onTransaction",n),l=Rv(e,"onFocus",n),c=Rv(e,"onBlur",n),u=Rv(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),s&&this.editor.on("selectionUpdate",s),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),u&&this.editor.on("destroy",u)})}};Hk.resolve=Gv,Hk.sort=Jv,Hk.flatten=Fv;var jk={};Ey(jk,{ClipboardTextSerializer:()=>Kk,Commands:()=>Wk,Delete:()=>Zk,Drop:()=>Uk,Editable:()=>Jk,FocusEvents:()=>Xk,Keymap:()=>Yk,Paste:()=>Qk,Tabindex:()=>eb,focusEventsPluginKey:()=>Gk});var qk=class e extends Lk{constructor(){super(...arguments),this.type="extension"}static create(t={}){const n="function"==typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"==typeof e?e():e;return super.extend(t)}},Kk=qk.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new Cp({key:new Ep("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:o}=t,{ranges:i}=o,s=Math.min(...i.map(e=>e.$from.pos)),a=Math.max(...i.map(e=>e.$to.pos)),l=Yv(n);return Xv(r,{from:s,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),Wk=qk.create({name:"commands",addCommands:()=>({...Dy})}),Zk=qk.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var n,r,o;const i=()=>{var n,r,o,i;if(null!=(i=null==(o=null==(r=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:r.filterTransaction)?void 0:o.call(r,e))?i:e.getMeta("y-sync$"))return;const s=Lv(e.before,[e,...t]);tk(s).forEach(t=>{s.mapping.mapResult(t.oldRange.from).deletedAfter&&s.mapping.mapResult(t.oldRange.to).deletedBefore&&s.before.nodesBetween(t.oldRange.from,t.oldRange.to,(n,r)=>{const o=r+n.nodeSize-2,i=t.oldRange.from<=r&&o<=t.oldRange.to;this.editor.emit("delete",{type:"node",node:n,from:r,to:o,newFrom:s.mapping.map(r),newTo:s.mapping.map(o),deletedRange:t.oldRange,newRange:t.newRange,partial:!i,editor:this.editor,transaction:e,combinedTransform:s})})});const a=s.mapping;s.steps.forEach((t,n)=>{var r,o;if(t instanceof _h){const i=a.slice(n).map(t.from,-1),l=a.slice(n).map(t.to),c=a.invert().map(i,-1),u=a.invert().map(l),d=null==(r=s.doc.nodeAt(i-1))?void 0:r.marks.some(e=>e.eq(t.mark)),h=null==(o=s.doc.nodeAt(l))?void 0:o.marks.some(e=>e.eq(t.mark));this.editor.emit("delete",{type:"mark",mark:t.mark,from:t.from,to:t.to,deletedRange:{from:c,to:u},newRange:{from:i,to:l},partial:Boolean(h||d),editor:this.editor,transaction:e,combinedTransform:s})}})};null==(o=null==(r=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:r.async)||o?setTimeout(i,0):i()}}),Uk=qk.create({name:"drop",addProseMirrorPlugins(){return[new Cp({key:new Ep("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),Jk=qk.create({name:"editable",addProseMirrorPlugins(){return[new Cp({key:new Ep("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Gk=new Ep("focusEvents"),Xk=qk.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new Cp({key:Gk,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Yk=qk.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{const{selection:n,doc:r}=t,{empty:o,$anchor:i}=n,{pos:s,parent:a}=i,l=i.parent.isTextblock&&s>0?t.doc.resolve(s-1):i,c=l.parent.type.spec.isolating,u=i.pos-i.parentOffset,d=c&&1===l.parent.childCount?u===i.pos:op.atStart(r).from===s;return!(!o||!a.type.isTextblock||a.textContent.length||!d||d&&"paragraph"===i.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},o={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ev()||gv()?o:r},addProseMirrorPlugins(){return[new Cp({key:new Ep("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;const r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),o=e.some(e=>e.getMeta("preventClearDocument"));if(!r||o)return;const{empty:i,from:s,to:a}=t.selection,l=op.atStart(t.doc).from,c=op.atEnd(t.doc).to;if(i||!(s===l&&a===c))return;if(!lk(n.doc))return;const u=n.tr,d=My({state:n,transaction:u}),{commands:h}=new Ay({editor:this.editor,state:d});return h.clearNodes(),u.steps.length?u:void 0}})]}}),Qk=qk.create({name:"paste",addProseMirrorPlugins(){return[new Cp({key:new Ep("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),eb=qk.create({name:"tabindex",addProseMirrorPlugins(){return[new Cp({key:new Ep("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),tb=class e{constructor(e,t,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!=(e=this.actualDepth)?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You canât set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new e(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new e(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new e(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const o=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,s=this.pos+r+(i?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!o&&a.depth<=this.depth)return;const l=new e(a,this.editor,o,o?n:null);o&&(l.actualDepth=this.depth+1),t.push(new e(a,this.editor,o,o?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(t).length>0){const e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];if(e[o]!==t[o])break}}else n=r;r=r.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let r=[];if(!this.children||0===this.children.length)return r;const o=Object.keys(t);return this.children.forEach(i=>{if(!(n&&r.length>0)){if(i.node.type.name===e){o.every(e=>t[e]===i.node.attrs[e])&&r.push(i)}n&&r.length>0||(r=r.concat(i.querySelectorAll(e,t,n)))}}),r}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}};var nb=class extends Ok{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:"undefined"!=typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:e,slice:t,moved:n})=>this.options.onDrop(e,t,n)),this.on("paste",({event:e,slice:t})=>this.options.onPaste(e,t)),this.on("delete",this.options.onDelete);const t=this.createDoc(),n=Qy(t,this.options.autofocus);this.editorState=wp.create({doc:t,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if("undefined"==typeof document)throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;(null==e?void 0:e.editor)&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{"function"==typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&"undefined"!=typeof document&&(this.css=function(e,t){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style",""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}',this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if("state"===t)return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const n=Vv(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(e=>{const t="string"==typeof e?`${e}$`:e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[Jk,Kk.configure({blockSeparator:null==(t=null==(e=this.options.coreExtensionOptions)?void 0:e.clipboardTextSerializer)?void 0:t.blockSeparator}),Wk,Xk,Yk,eb,Uk,Qk,Zk].filter(e=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new Hk(n,this)}createCommandManager(){this.commandManager=new Ay({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=Pv(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(uA){if(!(uA instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(uA.message)))throw uA;this.emit("contentError",{editor:this,error:uA,disableCollaboration:()=>{"collaboration"in this.storage&&"object"==typeof this.storage.collaboration&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),e=Pv(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new ly(e,{...this.options.editorProps,attributes:{role:"textbox",...null==(t=this.options.editorProps)?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null==(t=this.capturedTransaction)?void 0:t.step(e)}):void(this.capturedTransaction=e);const{state:t,transactions:n}=this.state.applyTransaction(e),r=!this.state.selection.eq(t.selection),o=n.includes(e),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!o)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=n.findLast(e=>e.getMeta("focus")||e.getMeta("blur")),a=null==s?void 0:s.getMeta("focus"),l=null==s?void 0:s.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),e.getMeta("preventUpdate")||!n.some(e=>e.docChanged)||i.doc.eq(t.doc)||this.emit("update",{editor:this,transaction:e,appendedTransactions:n.slice(1)})}getAttributes(e){return Qv(this.state,e)}isActive(e,t){const n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return vv(e,null,n)||ik(e,null,n);const r=Cv(t,e.schema);return"node"===r?vv(e,t,n):"mark"===r&&ik(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Bv(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return function(e,t){return Xv(e,{from:0,to:e.content.size},t)}(this.state.doc,{blockSeparator:t,textSerializers:{...Yv(this.schema),...n}})}get isEmpty(){return lk(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return null==(t=null==(e=this.editorView)?void 0:e.isDestroyed)||t}$node(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new tb(t,this)}get $doc(){return this.$pos(0)}};function rb(e){return new Nk({find:e.find,handler:({state:t,range:n,match:r})=>{const o=Hv(e.getAttributes,void 0,r);if(!1===o||null===o)return null;const{tr:i}=t,s=r[r.length-1],a=r[0];if(s){const r=a.search(/\S/),l=n.from+a.indexOf(s),c=l+s.length;if(nk(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>l).length)return null;c<n.to&&i.delete(c,n.to),l>n.from&&i.delete(n.from+r,l);const u=n.from+r+s.length;i.addMark(n.from+r,u,e.type.create(o||{})),i.removeStoredMark(e.type)}},undoable:e.undoable})}function ob(e){return new Nk({find:e.find,handler:({state:t,range:n,match:r})=>{const o=t.doc.resolve(n.from),i=Hv(e.getAttributes,void 0,r)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,i)},undoable:e.undoable})}function ib(e){return new Nk({find:e.find,handler:({state:t,range:n,match:r,chain:o})=>{const i=Hv(e.getAttributes,void 0,r)||{},s=t.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),l=a&&Ph(a,e.type,i);if(!l)return null;if(s.wrap(a,l),e.keepMarks&&e.editor){const{selection:n,storedMarks:r}=t,{splittableMarks:o}=e.editor.extensionManager,i=r||n.$to.parentOffset&&n.$from.marks();if(i){const e=i.filter(e=>o.includes(e.type.name));s.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";o().updateAttributes(t,i).run()}const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===e.type&&Rh(s.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,c))&&s.join(n.from-1)},undoable:e.undoable})}function sb(e){if(!(null==e?void 0:e.trim()))return{};const t={},n=[],r=e.replace(/["']([^"']*)["']/g,e=>(n.push(e),`__QUOTED_${n.length-1}__`)),o=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){const e=o.map(e=>e.trim().slice(1));t.class=e.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(t.id=i[1]);Array.from(r.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(([,e,r])=>{var o;const i=parseInt((null==(o=r.match(/__QUOTED_(\d+)__/))?void 0:o[1])||"0",10),s=n[i];s&&(t[e]=s.slice(1,-1))});const s=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();if(s){s.split(/\s+/).filter(Boolean).forEach(e=>{e.match(/^[a-zA-Z][\w-]*$/)&&(t[e]=!0)})}return t}function ab(e){if(!e||0===Object.keys(e).length)return"";const t=[];if(e.class){String(e.class).split(/\s+/).filter(Boolean).forEach(e=>t.push(`.${e}`))}return e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([e,n])=>{"class"!==e&&"id"!==e&&(!0===n?t.push(e):!1!==n&&null!=n&&t.push(`${e}="${String(n)}"`))}),t.join(" ")}function lb(e){const{nodeName:t,name:n,parseAttributes:r=sb,serializeAttributes:o=ab,defaultAttributes:i={},requiredAttributes:s=[],allowedAttributes:a}=e,l=n||t;return{parseMarkdown:(e,n)=>{const r={...i,...e.attributes};return n.createNode(t,r,[])},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp(`^:::${l}(?:\\s|$)`,"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,o){const i=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),a=e.match(i);if(!a)return;const c=a[1]||"",u=r(c);return s.find(e=>!(e in u))?void 0:{type:t,raw:a[0],attributes:u}}},renderMarkdown:e=>{const t=(e=>{if(!a)return e;const t={};return a.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),n=o(t);return`:::${l}${n?` {${n}}`:""} :::`}}}function cb(e){const{nodeName:t,name:n,getContent:r,parseAttributes:o=sb,serializeAttributes:i=ab,defaultAttributes:s={},content:a="block",allowedAttributes:l}=e,c=n||t;return{parseMarkdown:(e,n)=>{let o;if(r){const t=r(e);o="string"==typeof t?[{type:"text",text:t}]:t}else o="block"===a?n.parseChildren(e.tokens||[]):n.parseInline(e.tokens||[]);const i={...s,...e.attributes};return n.createNode(t,i,o)},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp(`^:::${c}`,"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,r){var i;const s=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),l=e.match(s);if(!l)return;const[u,d=""]=l,h=o(d);let p=1;const f=u.length;let m="";const g=/^:::([\w-]*)(\s.*)?/gm,y=e.slice(f);for(g.lastIndex=0;;){const n=g.exec(y);if(null===n)break;const o=n.index,s=n[1];if(!(null==(i=n[2])?void 0:i.endsWith(":::")))if(s)p+=1;else if(p-=1,0===p){const i=y.slice(0,o);m=i.trim();const s=e.slice(0,f+o+n[0].length);let l=[];if(m)if("block"===a)for(l=r.blockTokens(i),l.forEach(e=>{!e.text||e.tokens&&0!==e.tokens.length||(e.tokens=r.inlineTokens(e.text))});l.length>0;){const e=l[l.length-1];if("paragraph"!==e.type||e.text&&""!==e.text.trim())break;l.pop()}else l=r.inlineTokens(m);return{type:t,raw:s,attributes:h,content:m,tokens:l}}}}},renderMarkdown:(e,t)=>{const n=(e=>{if(!l)return e;const t={};return l.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),r=i(n),o=r?` {${r}}`:"",s=t.renderChildren(e.content||[],"\n\n");return`:::${c}${o}\n\n${s}\n\n:::`}}}function ub(e){if(!e.trim())return{};const t={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(e);for(;null!==r;){const[,o,i,s]=r;t[o]=i||s,r=n.exec(e)}return t}function db(e){return Object.entries(e).filter(([,e])=>null!=e).map(([e,t])=>`${e}="${t}"`).join(" ")}function hb(e){const{nodeName:t,name:n,getContent:r,parseAttributes:o=ub,serializeAttributes:i=db,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=e,c=n||t,u=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(e,n)=>{const o={...s,...e.attributes};if(a)return n.createNode(t,o);const i=r?r(e):e.content||"";return i?n.createNode(t,o,[n.createTextNode(i)]):n.createNode(t,o,[])},markdownTokenizer:{name:t,level:"inline",start(e){const t=a?new RegExp(`\\[${u}\\s*[^\\]]*\\]`):new RegExp(`\\[${u}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${u}\\]`),n=e.match(t),r=null==n?void 0:n.index;return void 0!==r?r:-1},tokenize(e,n,r){const i=a?new RegExp(`^\\[${u}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${u}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${u}\\]`),s=e.match(i);if(!s)return;let l="",c="";if(a){const[,e]=s;c=e}else{const[,e,t]=s;c=e,l=t||""}const d=o(c.trim());return{type:t,raw:s[0],content:l.trim(),attributes:d}}},renderMarkdown:e=>{let t="";r?t=r(e):e.content&&e.content.length>0&&(t=e.content.filter(e=>"text"===e.type).map(e=>e.text).join(""));const n=(e=>{if(!l)return e;const t={};return l.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),o=i(n),s=o?` ${o}`:"";return a?`[${c}${s}]`:`[${c}${s}]${t}[/${c}]`}}}function pb(e,t,n){var r,o,i,s;const a=e.split("\n"),l=[];let c="",u=0;const d=t.baseIndentSize||2;for(;u<a.length;){const e=a[u],h=e.match(t.itemPattern);if(!h){if(l.length>0)break;if(""===e.trim()){u+=1;continue}return}const p=t.extractItemData(h),{indentLevel:f,mainContent:m}=p;c=`${c}${e}\n`;const g=[m];for(u+=1;u<a.length;){const e=a[u];if(""===e.trim()){const t=a.slice(u+1).findIndex(e=>""!==e.trim());if(-1===t)break;if(((null==(o=null==(r=a[u+1+t].match(/^(\s*)/))?void 0:r[1])?void 0:o.length)||0)>f){g.push(e),c=`${c}${e}\n`,u+=1;continue}break}if(!(((null==(s=null==(i=e.match(/^(\s*)/))?void 0:i[1])?void 0:s.length)||0)>f))break;g.push(e),c=`${c}${e}\n`,u+=1}let y;const v=g.slice(1);if(v.length>0){const e=v.map(e=>e.slice(f+d)).join("\n");e.trim()&&(y=t.customNestedParser?t.customNestedParser(e):n.blockTokens(e))}const k=t.createToken(p,y);l.push(k)}if(0!==l.length)return{items:l,raw:c.trim()}}function fb(e,t,n,r){if(!e||!Array.isArray(e.content))return"";const o="function"==typeof n?n(r):n,[i,...s]=e.content,a=[`${o}${t.renderChildren([i])}`];return s&&s.length>0&&s.forEach(e=>{const n=t.renderChildren([e]);if(n){const e=n.split("\n").map(e=>e?t.indent(e):"").join("\n");a.push(e)}}),a.join("\n")}Ey({},{createAtomBlockMarkdownSpec:()=>lb,createBlockMarkdownSpec:()=>cb,createInlineMarkdownSpec:()=>hb,parseAttributes:()=>sb,parseIndentedBlocks:()=>pb,renderNestedMarkdownContent:()=>fb,serializeAttributes:()=>ab});var mb=class e extends Lk{constructor(){super(...arguments),this.type="node"}static create(t={}){const n="function"==typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"==typeof e?e():e;return super.extend(t)}};function gb(e){return new Rk({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:o})=>{const i=Hv(e.getAttributes,void 0,r,o);if(!1===i||null===i)return null;const{tr:s}=t,a=r[r.length-1],l=r[0];let c=n.to;if(a){const r=l.search(/\S/),o=n.from+l.indexOf(a),u=o+a.length;if(nk(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>o).length)return null;u<n.to&&s.delete(u,n.to),o>n.from&&s.delete(n.from+r,o),c=n.from+r+a.length,s.addMark(n.from+r,c,e.type.create(i||{})),s.removeStoredMark(e.type)}}})}var yb=(e,t)=>{if("slot"===e)return 0;if(e instanceof Function)return e(t);const{children:n,...r}=null!=t?t:{};if("svg"===e)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,r,n]},vb=/^\s*>\s$/,kb=mb.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return yb("blockquote",{...Kv(this.options.HTMLAttributes,e),children:yb("slot",{})})},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const n=[];e.content.forEach(e=>{const r=t.renderChildren(e).split("\n").map(e=>`> ${e}`).join("\n");n.push(r)});return n.flatMap(e=>[e,"> "]).slice(0,-1).join("\n")},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[ib({find:vb,type:this.type})]}}),bb=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,wb=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,xb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Cb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,_b=$k.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return yb("strong",{...Kv(this.options.HTMLAttributes,e),children:yb("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[rb({find:bb,type:this.type}),rb({find:xb,type:this.type})]},addPasteRules(){return[gb({find:wb,type:this.type}),gb({find:Cb,type:this.type})]}}),Sb=/(^|[^`])`([^`]+)`(?!`)$/,Eb=/(^|[^`])`([^`]+)`(?!`)/g,Mb=$k.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",Kv(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[rb({find:Sb,type:this.type})]},addPasteRules(){return[gb({find:Eb,type:this.type})]}}),Ab=/^```([a-z]+)?[\s\n]$/,Db=/^~~~([a-z]+)?[\s\n]$/,Tb=mb.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options;if(!n)return null;const r=[...(null==(t=e.firstElementChild)?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return r||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",Kv(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var n;return!1===(null==(n=e.raw)?void 0:n.startsWith("```"))&&"indented"!==e.codeBlockStyle?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var n;let r="";const o=(null==(n=e.attrs)?void 0:n.language)||"";if(e.content){r=[`\`\`\`${o}`,t.renderChildren(e.content),"```"].join("\n")}else r=`\`\`\`${o}\n\n\`\`\``;return r},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const n=null!=(t=this.options.tabSize)?t:4,{state:r}=e,{selection:o}=r,{$from:i,empty:s}=o;if(i.parent.type!==this.type)return!1;const a=" ".repeat(n);return s?e.commands.insertContent(a):e.commands.command(({tr:e})=>{const{from:t,to:n}=o,i=r.doc.textBetween(t,n,"\n","\n").split("\n").map(e=>a+e).join("\n");return e.replaceWith(t,n,r.schema.text(i)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const n=null!=(t=this.options.tabSize)?t:4,{state:r}=e,{selection:o}=r,{$from:i,empty:s}=o;return i.parent.type===this.type&&(s?e.commands.command(({tr:e})=>{var t;const{pos:o}=i,s=i.start(),a=i.end(),l=r.doc.textBetween(s,a,"\n","\n").split("\n");let c=0,u=0;const d=o-s;for(let n=0;n<l.length;n+=1){if(u+l[n].length>=d){c=n;break}u+=l[n].length+1}const h=(null==(t=l[c].match(/^ */))?void 0:t[0])||"",p=Math.min(h.length,n);if(0===p)return!0;let f=s;for(let n=0;n<c;n+=1)f+=l[n].length+1;e.delete(f,f+p);return o-f<=p&&e.setSelection(lp.create(e.doc,f)),!0}):e.commands.command(({tr:e})=>{const{from:t,to:i}=o,s=r.doc.textBetween(t,i,"\n","\n").split("\n").map(e=>{var t;const r=(null==(t=e.match(/^ */))?void 0:t[0])||"",o=Math.min(r.length,n);return e.slice(o)}).join("\n");return e.replaceWith(t,i,r.schema.text(s)),!0}))},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith("\n\n");return!(!i||!s)&&e.chain().command(({tr:e})=>(e.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:o,empty:i}=n;if(!i||o.parent.type!==this.type)return!1;if(!(o.parentOffset===o.parent.nodeSize-2))return!1;const s=o.after();if(void 0===s)return!1;return r.nodeAt(s)?e.commands.command(({tr:e})=>(e.setSelection(op.near(r.resolve(s))),!0)):e.commands.exitCode()}}},addInputRules(){return[ob({find:Ab,type:this.type,getAttributes:e=>({language:e[1]})}),ob({find:Db,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Cp({key:new Ep("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=null==o?void 0:o.mode;if(!n||!i)return!1;const{tr:s,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return s.replaceSelectionWith(this.type.create({language:i},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(lp.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),Ob=mb.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n\n"):""}),Nb=mb.create({name:"hardBreak",markdownTokenName:"br",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",Kv(this.options.HTMLAttributes,e)]},renderText:()=>"\n",renderMarkdown:(e,t)=>t.indent("\n"),parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:e,storedMarks:o}=n;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:s}=r.extensionManager,a=o||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{if(t&&a&&i){const t=a.filter(e=>s.includes(e.type.name));e.ensureMarks(t)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Pb=mb.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Kv(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var n;const r=(null==(n=e.attrs)?void 0:n.level)?parseInt(e.attrs.level,10):1,o="#".repeat(r);return e.content?`${o} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>ob({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),zb=mb.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{},nextNodeType:"paragraph"}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",Kv(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!function(e,t){const{selection:n}=e,{$from:r}=n;if(n instanceof up){const e=r.index();return r.parent.canReplaceWith(e,e+1,t)}let o=r.depth;for(;o>=0;){const e=r.index(o);if(r.node(o).contentMatchAt(e).matchType(t))return!0;o-=1}return!1}(t,t.schema.nodes[this.name]))return!1;const{selection:n}=t,{$to:r}=n,o=e();return ck(n)?o.insertContentAt(r.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({state:e,tr:t,dispatch:n})=>{if(n){const{$to:n}=t.selection,r=n.end();if(n.nodeAfter)n.nodeAfter.isTextblock?t.setSelection(lp.create(t.doc,n.pos+1)):n.nodeAfter.isBlock?t.setSelection(up.create(t.doc,n.pos)):t.setSelection(lp.create(t.doc,n.pos));else{const o=e.schema.nodes[this.options.nextNodeType]||n.parent.type.contentMatch.defaultType,i=null==o?void 0:o.create();i&&(t.insert(r,i),t.setSelection(lp.create(t.doc,r+1)))}t.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(e={find:/^(?:---|â-|___\s|\*\*\*\s)$/,type:this.type},new Nk({find:e.find,handler:({state:t,range:n,match:r})=>{const o=Hv(e.getAttributes,void 0,r)||{},{tr:i}=t,s=n.from;let a=n.to;const l=e.type.create(o);if(r[1]){let e=s+r[0].lastIndexOf(r[1]);e>a?e=a:a=e+r[1].length;const t=r[0][r[0].length-1];i.insertText(t,s+r[0].length-1),i.replaceWith(e,a,l)}else if(r[0]){const t=e.type.isInline?s:s-1;i.insert(t,e.type.create(o)).delete(i.mapping.map(s),i.mapping.map(a))}i.scrollIntoView()},undoable:e.undoable}))];var e}}),Ib=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Lb=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,$b=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Rb=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Fb=$k.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",Kv(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[rb({find:Ib,type:this.type}),rb({find:$b,type:this.type})]},addPasteRules(){return[gb({find:Lb,type:this.type}),gb({find:Rb,type:this.type})]}});const Bb="numeric",Vb="ascii",Hb="alpha",jb="asciinumeric",qb="alphanumeric",Kb="domain",Wb="emoji",Zb="scheme",Ub="slashscheme",Jb="whitespace";function Gb(e,t){return e in t||(t[e]=[]),t[e]}function Xb(e,t,n){t[Bb]&&(t[jb]=!0,t[qb]=!0),t[Vb]&&(t[jb]=!0,t[Hb]=!0),t[jb]&&(t[qb]=!0),t[Hb]&&(t[qb]=!0),t[qb]&&(t[Kb]=!0),t[Wb]&&(t[Kb]=!0);for(const r in t){const t=Gb(r,n);t.indexOf(e)<0&&t.push(e)}}function Yb(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Yb.groups={},Yb.prototype={accepts(){return!!this.t},go(e){const t=this,n=t.j[e];if(n)return n;for(let r=0;r<t.jr.length;r++){const n=t.jr[r][0],o=t.jr[r][1];if(o&&n.test(e))return o}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,n,r){for(let o=0;o<e.length;o++)this.tt(e[o],t,n,r)},tr(e,t,n,r){let o;return r=r||Yb.groups,t&&t.j?o=t:(o=new Yb(t),n&&r&&Xb(t,n,r)),this.jr.push([e,o]),o},ts(e,t,n,r){let o=this;const i=e.length;if(!i)return o;for(let s=0;s<i-1;s++)o=o.tt(e[s]);return o.tt(e[i-1],t,n,r)},tt(e,t,n,r){r=r||Yb.groups;const o=this;if(t&&t.j)return o.j[e]=t,t;const i=t;let s,a=o.go(e);if(a?(s=new Yb,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Yb,i){if(r)if(s.t&&"string"==typeof s.t){const e=Object.assign(function(e,t){const n={};for(const r in t)t[r].indexOf(e)>=0&&(n[r]=!0);return n}(s.t,r),n);Xb(i,e,r)}else n&&Xb(i,n,r);s.t=i}return o.j[e]=s,s}};const Qb=(e,t,n,r,o)=>e.ta(t,n,r,o),ew=(e,t,n,r,o)=>e.tr(t,n,r,o),tw=(e,t,n,r,o)=>e.ts(t,n,r,o),nw=(e,t,n,r,o)=>e.tt(t,n,r,o),rw="WORD",ow="UWORD",iw="ASCIINUMERICAL",sw="ALPHANUMERICAL",aw="LOCALHOST",lw="TLD",cw="UTLD",uw="SCHEME",dw="SLASH_SCHEME",hw="NUM",pw="WS",fw="NL",mw="OPENBRACE",gw="CLOSEBRACE",yw="OPENBRACKET",vw="CLOSEBRACKET",kw="OPENPAREN",bw="CLOSEPAREN",ww="OPENANGLEBRACKET",xw="CLOSEANGLEBRACKET",Cw="FULLWIDTHLEFTPAREN",_w="FULLWIDTHRIGHTPAREN",Sw="LEFTCORNERBRACKET",Ew="RIGHTCORNERBRACKET",Mw="LEFTWHITECORNERBRACKET",Aw="RIGHTWHITECORNERBRACKET",Dw="FULLWIDTHLESSTHAN",Tw="FULLWIDTHGREATERTHAN",Ow="AMPERSAND",Nw="APOSTROPHE",Pw="ASTERISK",zw="AT",Iw="BACKSLASH",Lw="BACKTICK",$w="CARET",Rw="COLON",Fw="COMMA",Bw="DOLLAR",Vw="DOT",Hw="EQUALS",jw="EXCLAMATION",qw="HYPHEN",Kw="PERCENT",Ww="PIPE",Zw="PLUS",Uw="POUND",Jw="QUERY",Gw="QUOTE",Xw="FULLWIDTHMIDDLEDOT",Yw="SEMI",Qw="SLASH",ex="TILDE",tx="UNDERSCORE",nx="EMOJI",rx="SYM";var ox=Object.freeze({__proto__:null,ALPHANUMERICAL:sw,AMPERSAND:Ow,APOSTROPHE:Nw,ASCIINUMERICAL:iw,ASTERISK:Pw,AT:zw,BACKSLASH:Iw,BACKTICK:Lw,CARET:$w,CLOSEANGLEBRACKET:xw,CLOSEBRACE:gw,CLOSEBRACKET:vw,CLOSEPAREN:bw,COLON:Rw,COMMA:Fw,DOLLAR:Bw,DOT:Vw,EMOJI:nx,EQUALS:Hw,EXCLAMATION:jw,FULLWIDTHGREATERTHAN:Tw,FULLWIDTHLEFTPAREN:Cw,FULLWIDTHLESSTHAN:Dw,FULLWIDTHMIDDLEDOT:Xw,FULLWIDTHRIGHTPAREN:_w,HYPHEN:qw,LEFTCORNERBRACKET:Sw,LEFTWHITECORNERBRACKET:Mw,LOCALHOST:aw,NL:fw,NUM:hw,OPENANGLEBRACKET:ww,OPENBRACE:mw,OPENBRACKET:yw,OPENPAREN:kw,PERCENT:Kw,PIPE:Ww,PLUS:Zw,POUND:Uw,QUERY:Jw,QUOTE:Gw,RIGHTCORNERBRACKET:Ew,RIGHTWHITECORNERBRACKET:Aw,SCHEME:uw,SEMI:Yw,SLASH:Qw,SLASH_SCHEME:dw,SYM:rx,TILDE:ex,TLD:lw,UNDERSCORE:tx,UTLD:cw,UWORD:ow,WORD:rw,WS:pw});const ix=/[a-z]/,sx=new RegExp("\\p{L}","u"),ax=new RegExp("\\p{Emoji}","u"),lx=/\d/,cx=/\s/;let ux=null,dx=null;function hx(e,t){const n=function(e){const t=[],n=e.length;let r=0;for(;r<n;){let o,i=e.charCodeAt(r),s=i<55296||i>56319||r+1===n||(o=e.charCodeAt(r+1))<56320||o>57343?e[r]:e.slice(r,r+2);t.push(s),r+=s.length}return t}(t.replace(/[A-Z]/g,e=>e.toLowerCase())),r=n.length,o=[];let i=0,s=0;for(;s<r;){let a=e,l=null,c=0,u=null,d=-1,h=-1;for(;s<r&&(l=a.go(n[s]));)a=l,a.accepts()?(d=0,h=0,u=a):d>=0&&(d+=n[s].length,h++),c+=n[s].length,i+=n[s].length,s++;i-=d,s-=h,c-=d,o.push({t:u.t,v:t.slice(i-c,i),s:i-c,e:i})}return o}function px(e,t,n,r,o){let i;const s=t.length;for(let a=0;a<s-1;a++){const n=t[a];e.j[n]?i=e.j[n]:(i=new Yb(r),i.jr=o.slice(),e.j[n]=i),e=i}return i=new Yb(n),i.jr=o.slice(),e.j[t[s-1]]=i,i}function fx(e){const t=[],n=[];let r=0;for(;r<e.length;){let o=0;for(;"0123456789".indexOf(e[r+o])>=0;)o++;if(o>0){t.push(n.join(""));for(let t=parseInt(e.substring(r,r+o),10);t>0;t--)n.pop();r+=o}else n.push(e[r]),r++}return t}const mx={defaultProtocol:"http",events:null,format:yx,formatHref:yx,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function gx(e,t=null){let n=Object.assign({},mx);e&&(n=Object.assign(n,e instanceof gx?e.o:e));const r=n.ignoreTags,o=[];for(let i=0;i<r.length;i++)o.push(r[i].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=o}function yx(e){return e}function vx(e,t){this.t="token",this.v=e,this.tk=t}function kx(e,t){class n extends vx{constructor(t,n){super(t,n),this.t=e}}for(const r in t)n.prototype[r]=t[r];return n.t=e,n}gx.prototype={o:mx,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,n){const r=null!=t;let o=this.o[e];return o?("object"==typeof o?(o=n.t in o?o[n.t]:mx[e],"function"==typeof o&&r&&(o=o(t,n))):"function"==typeof o&&r&&(o=o(t,n.t,n)),o):o},getObj(e,t,n){let r=this.o[e];return"function"==typeof r&&null!=t&&(r=r(t,n.t,n)),r},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}},vx.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),n=e.get("truncate",t,this),r=e.get("format",t,this);return n&&r.length>n?r.substring(0,n)+"â¦":r},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=mx.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,n=this.toHref(e.get("defaultProtocol")),r=e.get("formatHref",n,this),o=e.get("tagName",n,t),i=this.toFormattedString(e),s={},a=e.get("className",n,t),l=e.get("target",n,t),c=e.get("rel",n,t),u=e.getObj("attributes",n,t),d=e.getObj("events",n,t);return s.href=r,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),u&&Object.assign(s,u),{tagName:o,attributes:s,content:i,eventListeners:d}}};const bx=kx("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),wx=kx("text"),xx=kx("nl"),Cx=kx("url",{isLink:!0,toHref(e=mx.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==aw&&e[1].t===Rw}}),_x=e=>new Yb(e);function Sx(e,t,n){const r=n[0].s,o=n[n.length-1].e;return new e(t.slice(r,o),n)}const Ex="undefined"!=typeof console&&console&&console.warn||(()=>{}),Mx={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Ax(e,t=!1){if(Mx.initialized&&Ex(`linkifyjs: already initialized - will not register custom scheme "${e}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');Mx.customSchemes.push([e,t])}function Dx(){Mx.scanner=function(e=[]){const t={};Yb.groups=t;const n=new Yb;null==ux&&(ux=fx("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mÃ¶gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==dx&&(dx=fx("ÎµÎ»1Ï2Ð±Ð³1ÐµÐ»3Ð´ÐµÑÐ¸4ÐµÑ2ÐºÐ°ÑÐ¾Ð»Ð¸Ðº6Ð¾Ð¼3Ð¼ÐºÐ´2Ð¾Ð½1ÑÐºÐ²Ð°6Ð¾Ð½Ð»Ð°Ð¹Ð½5ÑÐ³3ÑÑÑ2Ñ2ÑÐ°Ð¹Ñ3ÑÐ±3ÑÐºÑ3ÒÐ°Ð·3Õ°Õ¡Õµ3××©×¨××5×§××3Ø§Ø¨ÙØ¸Ø¨Ù5Ø±Ø§ÙÙÙ5ÙØ§Ø±Ø¯Ù4Ø¨Ø­Ø±ÙÙ5Ø¬Ø²Ø§Ø¦Ø±5Ø³Ø¹ÙØ¯ÙØ©6Ø¹ÙÙØ§Ù5ÙØºØ±Ø¨5ÙØ§Ø±Ø§Øª5ÛØ±Ø§Ù5Ø¨Ø§Ø±Øª2Ø²Ø§Ø±4ÙØªÙ3Ú¾Ø§Ø±Øª5ØªÙÙØ³4Ø³ÙØ¯Ø§Ù3Ø±ÙØ©5Ø´Ø¨ÙØ©4Ø¹Ø±Ø§Ù2Ø¨2ÙØ§Ù4ÙÙØ³Ø·ÙÙ6ÙØ·Ø±3ÙØ§Ø«ÙÙÙÙ6ÙÙ3ÙØµØ±2ÙÙØ³ÙØ§5ÙØ±ÙØªØ§ÙÙØ§7ÙØ¹4ÙÙØ±Ø§Ù5Ù¾Ø§Ú©Ø³ØªØ§Ù7ÚØ§Ø±Øª4à¤à¥à¤®3à¤¨à¥à¤3à¤­à¤¾à¤°à¤¤0à¤®à¥3à¥à¤¤5à¤¸à¤à¤à¤ à¤¨5à¦¬à¦¾à¦à¦²à¦¾5à¦­à¦¾à¦°à¦¤2à§°à¦¤4à¨­à¨¾à¨°à¨¤4àª­àª¾àª°àª¤4à¬­à¬¾à¬°à¬¤4à®à®¨à¯à®¤à®¿à®¯à®¾6à®²à®à¯à®à¯6à®à®¿à®à¯à®à®ªà¯à®ªà¯à®°à¯11à°­à°¾à°°à°¤à±5à²­à²¾à²°à²¤4à´­à´¾à´°à´¤à´5à¶½à¶à¶à·4à¸à¸­à¸¡3à¹à¸à¸¢3àº¥àº²àº§3áá2ã¿ããª3ã¢ãã¾ã³4ã¯ã©ã¦ã4ã°ã¼ã°ã«4ã³ã 2ã¹ãã¢3ã»ã¼ã«3ãã¡ãã·ã§ã³6ãã¤ã³ã4ä¸ç2ä¸­ä¿¡1å½1å1æç½3äºé©¬é3ä¼ä¸2ä½å±±2ä¿¡æ¯2å¥åº·2å«å¦2å¬å¸1ç2å°æ¹¾1ç£2åå1åº1æ 2åé0å¤§éåº5å¨çº¿2å¤§æ¿2å¤©ä¸»æ3å¨±ä¹2å®¶é»2å¹¿ä¸2å¾®å2æå2æç±ä½ 3ææº2æè2æ¿å¡1åº2æ°å å¡2é»2æ¶å°2æ¸ç±2æºæ2æ·¡é©¬é¡3æ¸¸æ2æ¾³é2ç¹ç2ç§»å¨2ç»ç»æºæ4ç½å1åº1ç«1ç»2èé2è°·æ­2è´­ç©2éè²©2éå¢2é»è¨çç§4é£å©æµ¦3é£å2é¤å2é¦æ ¼éæ3æ¸¯2ë·ë·1ì»´2ì¼ì±2íêµ­2")),nw(n,"'",Nw),nw(n,"{",mw),nw(n,"}",gw),nw(n,"[",yw),nw(n,"]",vw),nw(n,"(",kw),nw(n,")",bw),nw(n,"<",ww),nw(n,">",xw),nw(n,"ï¼",Cw),nw(n,"ï¼",_w),nw(n,"ã",Sw),nw(n,"ã",Ew),nw(n,"ã",Mw),nw(n,"ã",Aw),nw(n,"ï¼",Dw),nw(n,"ï¼",Tw),nw(n,"&",Ow),nw(n,"*",Pw),nw(n,"@",zw),nw(n,"`",Lw),nw(n,"^",$w),nw(n,":",Rw),nw(n,",",Fw),nw(n,"$",Bw),nw(n,".",Vw),nw(n,"=",Hw),nw(n,"!",jw),nw(n,"-",qw),nw(n,"%",Kw),nw(n,"|",Ww),nw(n,"+",Zw),nw(n,"#",Uw),nw(n,"?",Jw),nw(n,'"',Gw),nw(n,"/",Qw),nw(n,";",Yw),nw(n,"~",ex),nw(n,"_",tx),nw(n,"\\",Iw),nw(n,"ã»",Xw);const r=ew(n,lx,hw,{[Bb]:!0});ew(r,lx,r);const o=ew(r,ix,iw,{[jb]:!0}),i=ew(r,sx,sw,{[qb]:!0}),s=ew(n,ix,rw,{[Vb]:!0});ew(s,lx,o),ew(s,ix,s),ew(o,lx,o),ew(o,ix,o);const a=ew(n,sx,ow,{[Hb]:!0});ew(a,ix),ew(a,lx,i),ew(a,sx,a),ew(i,lx,i),ew(i,ix),ew(i,sx,i);const l=nw(n,"\n",fw,{[Jb]:!0}),c=nw(n,"\r",pw,{[Jb]:!0}),u=ew(n,cx,pw,{[Jb]:!0});nw(n,"ï¿¼",u),nw(c,"\n",l),nw(c,"ï¿¼",u),ew(c,cx,u),nw(u,"\r"),nw(u,"\n"),ew(u,cx,u),nw(u,"ï¿¼",u);const d=ew(n,ax,nx,{[Wb]:!0});nw(d,"#"),ew(d,ax,d),nw(d,"ï¸",d);const h=nw(d,"â");nw(h,"#"),ew(h,ax,d);const p=[[ix,s],[lx,o]],f=[[ix,null],[sx,a],[lx,i]];for(let m=0;m<ux.length;m++)px(n,ux[m],lw,rw,p);for(let m=0;m<dx.length;m++)px(n,dx[m],cw,ow,f);Xb(lw,{tld:!0,ascii:!0},t),Xb(cw,{utld:!0,alpha:!0},t),px(n,"file",uw,rw,p),px(n,"mailto",uw,rw,p),px(n,"http",dw,rw,p),px(n,"https",dw,rw,p),px(n,"ftp",dw,rw,p),px(n,"ftps",dw,rw,p),Xb(uw,{scheme:!0,ascii:!0},t),Xb(dw,{slashscheme:!0,ascii:!0},t),e=e.sort((e,t)=>e[0]>t[0]?1:-1);for(let m=0;m<e.length;m++){const t=e[m][0],r=e[m][1]?{[Zb]:!0}:{[Ub]:!0};t.indexOf("-")>=0?r[Kb]=!0:ix.test(t)?lx.test(t)?r[jb]=!0:r[Vb]=!0:r[Bb]=!0,tw(n,t,t,r)}return tw(n,"localhost",aw,{ascii:!0}),n.jd=new Yb(rx),{start:n,tokens:Object.assign({groups:t},ox)}}(Mx.customSchemes);for(let e=0;e<Mx.tokenQueue.length;e++)Mx.tokenQueue[e][1]({scanner:Mx.scanner});Mx.parser=function({groups:e}){const t=e.domain.concat([Ow,Pw,zw,Iw,Lw,$w,Bw,Hw,qw,hw,Kw,Ww,Zw,Uw,Qw,rx,ex,tx]),n=[Nw,Rw,Fw,Vw,jw,Kw,Jw,Gw,Yw,ww,xw,mw,gw,vw,yw,kw,bw,Cw,_w,Sw,Ew,Mw,Aw,Dw,Tw],r=[Ow,Nw,Pw,Iw,Lw,$w,Bw,Hw,qw,mw,gw,Kw,Ww,Zw,Uw,Jw,Qw,rx,ex,tx],o=_x(),i=nw(o,ex);Qb(i,r,i),Qb(i,e.domain,i);const s=_x(),a=_x(),l=_x();Qb(o,e.domain,s),Qb(o,e.scheme,a),Qb(o,e.slashscheme,l),Qb(s,r,i),Qb(s,e.domain,s);const c=nw(s,zw);nw(i,zw,c),nw(a,zw,c),nw(l,zw,c);const u=nw(i,Vw);Qb(u,r,i),Qb(u,e.domain,i);const d=_x();Qb(c,e.domain,d),Qb(d,e.domain,d);const h=nw(d,Vw);Qb(h,e.domain,d);const p=_x(bx);Qb(h,e.tld,p),Qb(h,e.utld,p),nw(c,aw,p);const f=nw(d,qw);nw(f,qw,f),Qb(f,e.domain,d),Qb(p,e.domain,d),nw(p,Vw,h),nw(p,qw,f);const m=nw(p,Rw);Qb(m,e.numeric,bx);const g=nw(s,qw),y=nw(s,Vw);nw(g,qw,g),Qb(g,e.domain,s),Qb(y,r,i),Qb(y,e.domain,s);const v=_x(Cx);Qb(y,e.tld,v),Qb(y,e.utld,v),Qb(v,e.domain,s),Qb(v,r,i),nw(v,Vw,y),nw(v,qw,g),nw(v,zw,c);const k=nw(v,Rw),b=_x(Cx);Qb(k,e.numeric,b);const w=_x(Cx),x=_x();Qb(w,t,w),Qb(w,n,x),Qb(x,t,w),Qb(x,n,x),nw(v,Qw,w),nw(b,Qw,w);const C=nw(a,Rw),_=nw(l,Rw),S=nw(_,Qw),E=nw(S,Qw);Qb(a,e.domain,s),nw(a,Vw,y),nw(a,qw,g),Qb(l,e.domain,s),nw(l,Vw,y),nw(l,qw,g),Qb(C,e.domain,w),nw(C,Qw,w),nw(C,Jw,w),Qb(E,e.domain,w),Qb(E,t,w),nw(E,Qw,w);const M=[[mw,gw],[yw,vw],[kw,bw],[ww,xw],[Cw,_w],[Sw,Ew],[Mw,Aw],[Dw,Tw]];for(let A=0;A<M.length;A++){const[e,r]=M[A],o=nw(w,e);nw(x,e,o),nw(o,r,w);const i=_x(Cx);Qb(o,t,i);const s=_x();Qb(o,n),Qb(i,t,i),Qb(i,n,s),Qb(s,t,i),Qb(s,n,s),nw(i,r,w),nw(s,r,w)}return nw(o,aw,v),nw(o,fw,xx),{start:o,tokens:ox}}(Mx.scanner.tokens);for(let e=0;e<Mx.pluginQueue.length;e++)Mx.pluginQueue[e][1]({scanner:Mx.scanner,parser:Mx.parser});return Mx.initialized=!0,Mx}function Tx(e){return Mx.initialized||Dx(),function(e,t,n){let r=n.length,o=0,i=[],s=[];for(;o<r;){let a=e,l=null,c=null,u=0,d=null,h=-1;for(;o<r&&!(l=a.go(n[o].t));)s.push(n[o++]);for(;o<r&&(c=l||a.go(n[o].t));)l=null,a=c,a.accepts()?(h=0,d=a):h>=0&&h++,o++,u++;if(h<0)o-=u,o<r&&(s.push(n[o]),o++);else{s.length>0&&(i.push(Sx(wx,t,s)),s=[]),o-=h,u-=h;const e=d.t,r=n.slice(o-u,o);i.push(Sx(e,t,r))}}return s.length>0&&i.push(Sx(wx,t,s)),i}(Mx.parser.start,e,hx(Mx.scanner.start,e))}function Ox(e,t=null,n=null){if(t&&"object"==typeof t){if(n)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);n=t,t=null}const r=new gx(n),o=Tx(e),i=[];for(let s=0;s<o.length;s++){const e=o[s];!e.isLink||t&&e.t!==t||!r.check(e)||i.push(e.toFormattedObject(r))}return i}Tx.scan=hx;var Nx="[\0- Â áá â-\u2029âã]",Px=new RegExp(Nx),zx=new RegExp(`${Nx}$`),Ix=new RegExp(Nx,"g");function Lx(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(e=>{const t="string"==typeof e?e:e.scheme;t&&n.push(t)}),!e||e.replace(Ix,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var $x=$k.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{"string"!=typeof e?Ax(e.scheme,e.optionalSlashes):Ax(e)})},onDestroy(){Yb.groups={},Mx.scanner=null,Mx.parser=null,Mx.tokenQueue=[],Mx.pluginQueue=[],Mx.customSchemes=[],Mx.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!Lx(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}),addAttributes(){return{href:{default:null,parseHTML:e=>e.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!(!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!Lx(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:e=>!!Lx(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Kv(this.options.HTMLAttributes,e),0]:["a",Kv(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var n;const r=(null==(n=e.attrs)?void 0:n.href)||"";return`[${t.renderChildren(e)}](${r})`},addCommands(){return{setLink:e=>({chain:t})=>{const{href:n}=e;return!!this.options.isAllowedUri(n,{defaultValidate:e=>!!Lx(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&t().setMark(this.name,e).setMeta("preventAutolink",!0).run()},toggleLink:e=>({chain:t})=>{const{href:n}=e||{};return!(n&&!this.options.isAllowedUri(n,{defaultValidate:e=>!!Lx(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[gb({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:r}=this.options,o=Ox(e).filter(e=>e.isLink&&this.options.isAllowedUri(e.value,{defaultValidate:e=>!!Lx(e,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(e=>{this.options.shouldAutoLink(e.value)&&t.push({text:e.value,data:{href:e.href},index:e.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:null==(t=e.data)?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;var r;return this.options.autolink&&e.push((r={type:this.type,defaultProtocol:this.options.defaultProtocol,validate:e=>this.options.isAllowedUri(e,{defaultValidate:e=>!!Lx(e,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink},new Cp({key:new Ep("autolink"),appendTransaction:(e,t,n)=>{const o=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),i=e.some(e=>e.getMeta("preventAutolink"));if(!o||i)return;const{tr:s}=n;return tk(Lv(t.doc,[...e])).forEach(({newRange:e})=>{const t=function(e,t,n){const r=[];return e.nodesBetween(t.from,t.to,(e,t)=>{n(e)&&r.push({node:e,pos:t})}),r}(n.doc,e,e=>e.isTextblock);let o,i;if(t.length>1)o=t[0],i=n.doc.textBetween(o.pos,o.pos+o.node.nodeSize,void 0," ");else if(t.length){const r=n.doc.textBetween(e.from,e.to," "," ");if(!zx.test(r))return;o=t[0],i=n.doc.textBetween(o.pos,e.to,void 0," ")}if(o&&i){const e=i.split(Px).filter(Boolean);if(e.length<=0)return!1;const t=e[e.length-1],l=o.pos+i.lastIndexOf(t);if(!t)return!1;const c=Tx(t).map(e=>e.toObject(r.defaultProtocol));if(!(1===(a=c).length?a[0].isLink:3===a.length&&a[1].isLink&&["()","[]"].includes(a[0].value+a[2].value)))return!1;c.filter(e=>e.isLink).map(e=>({...e,from:l+e.start+1,to:l+e.end+1})).filter(e=>!n.schema.marks.code||!n.doc.rangeHasMark(e.from,e.to,n.schema.marks.code)).filter(e=>r.validate(e.value)).filter(e=>r.shouldAutoLink(e.value)).forEach(e=>{nk(e.from,e.to,n.doc).some(e=>e.mark.type===r.type)||s.addMark(e.from,e.to,r.type.create({href:e.href}))})}var a}),s.steps.length?s:void 0}}))),!0===this.options.openOnClick&&e.push(function(e){return new Cp({key:new Ep("handleClickLink"),props:{handleClick:(t,n,r)=>{var o,i;if(0!==r.button)return!1;if(!t.editable)return!1;let s=null;if(r.target instanceof HTMLAnchorElement)s=r.target;else{let e=r.target;const t=[];for(;"DIV"!==e.nodeName;)t.push(e),e=e.parentNode;s=t.find(e=>"A"===e.nodeName)}if(!s)return!1;const a=Qv(t.state,e.type.name),l=null!=(o=null==s?void 0:s.href)?o:a.href,c=null!=(i=null==s?void 0:s.target)?i:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),!(!s||!l||(window.open(l,c),0))}}})}({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(function(e){return new Cp({key:new Ep("handlePasteLink"),props:{handlePaste:(t,n,r)=>{const{shouldAutoLink:o}=e,{state:i}=t,{selection:s}=i,{empty:a}=s;if(a)return!1;let l="";r.content.forEach(e=>{l+=e.textContent});const c=Ox(l,{defaultProtocol:e.defaultProtocol}).find(e=>e.isLink&&e.value===l);return!(!l||!c||void 0!==o&&!o(c.href))&&e.editor.commands.setMark(e.type,{href:c.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),Rx=Object.defineProperty,Fx="textStyle",Bx=/^\s*([-+*])\s$/,Vx=mb.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",Kv(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>"list"!==e.type||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(Fx)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=ib({find:Bx,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=ib({find:Bx,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Fx),editor:this.editor})),[e]}}),Hx=mb.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",Kv(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if("list_item"!==e.type)return[];let n=[];if(e.tokens&&e.tokens.length>0){if(e.tokens.some(e=>"paragraph"===e.type))n=t.parseChildren(e.tokens);else{const r=e.tokens[0];if(r&&"text"===r.type&&r.tokens&&r.tokens.length>0){if(n=[{type:"paragraph",content:t.parseInline(r.tokens)}],e.tokens.length>1){const r=e.tokens.slice(1),o=t.parseChildren(r);n.push(...o)}}else n=t.parseChildren(e.tokens)}}return 0===n.length&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(e,t,n)=>fb(e,t,e=>"bulletList"===e.parentType?"- ":"orderedList"===e.parentType?`${e.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});((e,t)=>{for(var n in t)Rx(e,n,{get:t[n],enumerable:!0})})({},{findListItemPos:()=>jx,getNextListDepth:()=>qx,handleBackspace:()=>Ux,handleDelete:()=>Xx,hasListBefore:()=>Kx,hasListItemAfter:()=>Yx,hasListItemBefore:()=>Wx,listItemHasSubList:()=>Zx,nextListIsDeeper:()=>Jx,nextListIsHigher:()=>Gx});var jx=(e,t)=>{const{$from:n}=t.selection,r=$y(e,t.schema);let o=null,i=n.depth,s=n.pos,a=null;for(;i>0&&null===a;)o=n.node(i),o.type===r?a=i:(i-=1,s-=1);return null===a?null:{$pos:t.doc.resolve(s),depth:a}},qx=(e,t)=>{const n=jx(e,t);if(!n)return!1;const[,r]=((e,t,n,r=20)=>{const o=e.doc.resolve(n);let i=r,s=null;for(;i>0&&null===s;){const e=o.node(i);(null==e?void 0:e.type.name)===t?s=e:i-=1}return[s,i]})(t,e,n.$pos.pos+4);return r},Kx=(e,t,n)=>{const{$anchor:r}=e.selection,o=Math.max(0,r.pos-2),i=e.doc.resolve(o).node();return!(!i||!n.includes(i.type.name))},Wx=(e,t)=>{var n;const{$anchor:r}=t.selection,o=t.doc.resolve(r.pos-2);return 0!==o.index()&&(null==(n=o.nodeBefore)?void 0:n.type.name)===e},Zx=(e,t,n)=>{if(!n)return!1;const r=$y(e,t.schema);let o=!1;return n.descendants(e=>{e.type===r&&(o=!0)}),o},Ux=(e,t,n)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!vv(e.state,t)&&Kx(e.state,t,n)){const{$anchor:n}=e.state.selection,r=e.state.doc.resolve(n.before()-1),o=[];r.node().descendants((e,n)=>{e.type.name===t&&o.push({node:e,pos:n})});const i=o.at(-1);if(!i)return!1;const s=e.state.doc.resolve(r.start()+i.pos+1);return e.chain().cut({from:n.start()-1,to:n.end()+1},s.end()).joinForward().run()}if(!vv(e.state,t))return!1;if(!(e=>{const{$from:t,$to:n}=e.selection;return!(t.parentOffset>0||t.pos!==n.pos)})(e.state))return!1;const r=jx(t,e.state);if(!r)return!1;const o=e.state.doc.resolve(r.$pos.pos-2).node(r.depth),i=Zx(t,e.state,o);return Wx(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},Jx=(e,t)=>{const n=qx(e,t),r=jx(e,t);return!(!r||!n)&&n>r.depth},Gx=(e,t)=>{const n=qx(e,t),r=jx(e,t);return!(!r||!n)&&n<r.depth},Xx=(e,t)=>{if(!vv(e.state,t))return!1;if(!((e,t)=>{const{$from:n,$to:r,$anchor:o}=e.selection;if(t){const n=$v(e=>e.type.name===t)(e.selection);if(!n)return!1;const r=e.doc.resolve(n.pos+1);return o.pos+1===r.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)})(e.state,t))return!1;const{selection:n}=e.state,{$from:r,$to:o}=n;return!(!n.empty&&r.sameParent(o))&&(Jx(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():Gx(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward())},Yx=(e,t)=>{var n;const{$anchor:r}=t.selection,o=t.doc.resolve(r.pos-r.parentOffset-2);return o.index()!==o.parent.childCount-1&&(null==(n=o.nodeAfter)?void 0:n.type.name)===e},Qx=qk.create({name:"listKeymap",addOptions:()=>({listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}),addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n})=>{void 0!==e.state.schema.nodes[n]&&Xx(e,n)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n})=>{void 0!==e.state.schema.nodes[n]&&Xx(e,n)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{void 0!==e.state.schema.nodes[n]&&Ux(e,n,r)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{void 0!==e.state.schema.nodes[n]&&Ux(e,n,r)&&(t=!0)}),t}}}}),eC=/^(\s*)(\d+)\.\s+(.*)$/,tC=/^\s/;function nC(e,t,n){var r;const o=[];let i=0;for(;i<e.length;){const s=e[i];if(s.indent===t){const a=s.content.split("\n"),l=(null==(r=a[0])?void 0:r.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:n.inlineTokens(l)});const u=a.slice(1).join("\n").trim();if(u){const e=n.blockTokens(u);c.push(...e)}let d=i+1;const h=[];for(;d<e.length&&e[d].indent>t;)h.push(e[d]),d+=1;if(h.length>0){const e=Math.min(...h.map(e=>e.indent)),t=nC(h,e,n);c.push({type:"list",ordered:!0,start:h[0].number,items:t,raw:h.map(e=>e.raw).join("\n")})}o.push({type:"list_item",raw:s.raw,tokens:c}),i=d}else i+=1}return o}var rC="textStyle",oC=/^(\d+)\.\s$/,iC=mb.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return 1===t?["ol",Kv(this.options.HTMLAttributes,n),0]:["ol",Kv(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if("list"!==e.type||!e.ordered)return[];const n=e.start||1,r=e.items?function(e,t){return e.map(e=>{if("list_item"!==e.type)return t.parseChildren([e])[0];const n=[];return e.tokens&&e.tokens.length>0&&e.tokens.forEach(e=>{if("paragraph"===e.type||"list"===e.type||"blockquote"===e.type||"code"===e.type)n.push(...t.parseChildren([e]));else if("text"===e.type&&e.tokens){const r=t.parseChildren([e]);n.push({type:"paragraph",content:r})}else{const r=t.parseChildren([e]);r.length>0&&n.push(...r)}}),{type:"listItem",content:n}})}(e.items,t):[];return 1!==n?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),n=null==t?void 0:t.index;return void 0!==n?n:-1},tokenize:(e,t,n)=>{var r;const o=e.split("\n"),[i,s]=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const o=e[n],i=o.match(eC);if(!i)break;const[,s,a,l]=i,c=s.length;let u=l,d=n+1;const h=[o];for(;d<e.length;){const t=e[d];if(t.match(eC))break;if(""===t.trim())h.push(t),u+="\n",d+=1;else{if(!t.match(tC))break;h.push(t),u+=`\n${t.slice(c+2)}`,d+=1}}t.push({indent:c,number:parseInt(a,10),content:u.trim(),raw:h.join("\n")}),r=d,n=d}return[t,r]}(o);if(0===i.length)return;const a=nC(i,0,n);if(0===a.length)return;return{type:"list",ordered:!0,start:(null==(r=i[0])?void 0:r.number)||1,items:a,raw:o.slice(0,s).join("\n")}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(rC)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=ib({find:oC,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=ib({find:oC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(rC)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),sC=/^\s*(\[([( |x])?\])\s$/,aC=mb.create({name:"taskItem",addOptions:()=>({nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}),content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:()=>({checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return""===t||"true"===t},renderHTML:e=>({"data-checked":e.checked})}}),parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",Kv(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const n=[];if(e.tokens&&e.tokens.length>0?n.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?n.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):n.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const r=t.parseChildren(e.nestedTokens);n.push(...r)}return t.createNode("taskItem",{checked:e.checked||!1},n)},renderMarkdown:(e,t)=>{var n;return fb(e,t,`- [${(null==(n=e.attrs)?void 0:n.checked)?"x":" "}] `)},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:n,editor:r})=>{const o=document.createElement("li"),i=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=e=>{var t,n;a.ariaLabel=(null==(n=null==(t=this.options.a11y)?void 0:t.checkboxLabel)?void 0:n.call(t,e,a.checked))||`Task item checkbox for ${e.textContent||"empty task item"}`};return c(e),i.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",e=>e.preventDefault()),a.addEventListener("change",t=>{if(!r.isEditable&&!this.options.onReadOnlyChecked)return void(a.checked=!a.checked);const{checked:o}=t.target;r.isEditable&&"function"==typeof n&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:e})=>{const t=n();if("number"!=typeof t)return!1;const r=e.doc.nodeAt(t);return e.setNodeMarkup(t,void 0,{...null==r?void 0:r.attrs,checked:o}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,o)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([e,t])=>{o.setAttribute(e,t)}),o.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,i.append(a,s),o.append(i,l),Object.entries(t).forEach(([e,t])=>{o.setAttribute(e,t)}),{dom:o,contentDOM:l,update:e=>e.type===this.type&&(o.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,c(e),!0)}}},addInputRules(){return[ib({find:sC,type:this.type,getAttributes:e=>({checked:"x"===e[e.length-1]})})]}}),lC=mb.create({name:"taskList",addOptions:()=>({itemTypeName:"taskItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",Kv(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const n=null==(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))?void 0:t.index;return void 0!==n?n:-1},tokenize(e,t,n){const r=e=>{const t=pb(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:e=>({indentLevel:e[1].length,mainContent:e[4],checked:"x"===e[3].toLowerCase()}),createToken:(e,t)=>({type:"taskItem",raw:"",mainContent:e.mainContent,indentLevel:e.indentLevel,checked:e.checked,text:e.mainContent,tokens:n.inlineTokens(e.mainContent),nestedTokens:t}),customNestedParser:r},n);return t?[{type:"taskList",raw:t.raw,items:t.items}]:n.blockTokens(e)},o=pb(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:e=>({indentLevel:e[1].length,mainContent:e[4],checked:"x"===e[3].toLowerCase()}),createToken:(e,t)=>({type:"taskItem",raw:"",mainContent:e.mainContent,indentLevel:e.indentLevel,checked:e.checked,text:e.mainContent,tokens:n.inlineTokens(e.mainContent),nestedTokens:t}),customNestedParser:r},n);if(o)return{type:"taskList",raw:o.raw,items:o.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});qk.create({name:"listKit",addExtensions(){const e=[];return!1!==this.options.bulletList&&e.push(Vx.configure(this.options.bulletList)),!1!==this.options.listItem&&e.push(Hx.configure(this.options.listItem)),!1!==this.options.listKeymap&&e.push(Qx.configure(this.options.listKeymap)),!1!==this.options.orderedList&&e.push(iC.configure(this.options.orderedList)),!1!==this.options.taskItem&&e.push(aC.configure(this.options.taskItem)),!1!==this.options.taskList&&e.push(lC.configure(this.options.taskList)),e}});var cC=mb.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",Kv(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{const n=e.tokens||[];return 1===n.length&&"image"===n[0].type?t.parseChildren([n[0]]):t.createNode("paragraph",void 0,t.parseInline(n))},renderMarkdown:(e,t)=>e&&Array.isArray(e.content)?t.renderChildren(e.content):"",addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),uC=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,dC=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,hC=$k.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",Kv(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[rb({find:uC,type:this.type})]},addPasteRules(){return[gb({find:dC,type:this.type})]}}),pC=mb.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),fC=$k.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("underline")&&{}}],renderHTML({HTMLAttributes:e}){return["u",Kv(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown:(e,t)=>`++${t.renderChildren(e)}++`,markdownTokenizer:{name:"underline",level:"inline",start:e=>e.indexOf("++"),tokenize(e,t,n){const r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!r)return;const o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function mC(e={}){return new Cp({view:t=>new gC(t,e)})}class gC{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,r=this.editorView.dom,o=r.getBoundingClientRect(),i=o.width/r.offsetWidth,s=o.height/r.offsetHeight;if(n){let n=t.nodeBefore,r=t.nodeAfter;if(n||r){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let o=t.getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let a=this.width/2*s;e={left:o.left,right:o.right,top:i-a,bottom:i+a}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*i;e={left:t.left-n,right:t.left+n,top:t.top,bottom:t.bottom}}let a,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)a=-pageXOffset,l=-pageYOffset;else{let e=c.getBoundingClientRect(),t=e.width/c.offsetWidth,n=e.height/c.offsetHeight;a=e.left-c.scrollLeft*t,l=e.top-c.scrollTop*n}this.element.style.left=(e.left-a)/i+"px",this.element.style.top=(e.top-l)/s+"px",this.element.style.width=(e.right-e.left)/i+"px",this.element.style.height=(e.bottom-e.top)/s+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,t,e):r;if(t&&!o){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=Vh(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class yC extends op{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return yC.valid(n)?new yC(n):op.near(n)}content(){return hd.empty}eq(e){return e instanceof yC&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new yC(e.resolve(t.pos))}getBookmark(){return new vC(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0!=n)for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||kC(e.type))return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||kC(e.type))return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&yC.valid(e))return e;let r=e.pos,o=null;for(let n=e.depth;;n--){let i=e.node(n);if(t>0?e.indexAfter(n)<i.childCount:e.index(n)>0){o=i.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let s=e.doc.resolve(r);if(yC.valid(s))return s}for(;;){let i=t>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!up.isSelectable(o)){e=e.doc.resolve(r+o.nodeSize*t),n=!1;continue e}break}o=i,r+=t;let s=e.doc.resolve(r);if(yC.valid(s))return s}return null}}}yC.prototype.visible=!1,yC.findFrom=yC.findGapCursorFrom,op.jsonID("gapcursor",yC);class vC{constructor(e){this.pos=e}map(e){return new vC(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return yC.valid(t)?new yC(t):op.near(t)}}function kC(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}const bC=_y({ArrowLeft:wC("horiz",-1),ArrowRight:wC("horiz",1),ArrowUp:wC("vert",-1),ArrowDown:wC("vert",1)});function wC(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){let i=e.selection,s=t>0?i.$to:i.$from,a=i.empty;if(i instanceof lp){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}let l=yC.findGapCursorFrom(s,t,a);return!!l&&(r&&r(e.tr.setSelection(new yC(l))),!0)}}function xC(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!yC.valid(r))return!1;let o=e.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&up.isSelectable(e.state.doc.nodeAt(o.inside)))&&(e.dispatch(e.state.tr.setSelection(new yC(r))),!0)}function CC(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof yC))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let o=sd.empty;for(let s=r.length-1;s>=0;s--)o=sd.from(r[s].createAndFill(null,o));let i=e.state.tr.replace(n.pos,n.pos,new hd(o,0,0));return i.setSelection(lp.near(i.doc.resolve(n.pos+1))),e.dispatch(i),!1}function _C(e){if(!(e.selection instanceof yC))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",$g.create(e.doc,[zg.widget(e.selection.head,t,{key:"gapcursor"})])}var SC=200,EC=function(){};EC.prototype.append=function(e){return e.length?(e=EC.from(e),!this.length&&e||e.length<SC&&this.leafAppend(e)||this.length<SC&&e.leafPrepend(this)||this.appendInner(e)):this},EC.prototype.prepend=function(e){return e.length?EC.from(e).append(this):this},EC.prototype.appendInner=function(e){return new AC(this,e)},EC.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?EC.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},EC.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},EC.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},EC.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},EC.from=function(e){return e instanceof EC?e:e&&e.length?new MC(e):EC.empty};var MC=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=SC)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=SC)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(EC);EC.empty=new MC([]);var AC=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(EC);class DC{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,r,o=this.items.length;for(;;o--){if(this.items.get(o-1).selection){--o;break}}t&&(n=this.remapping(o,this.items.length),r=n.maps.length);let i,s,a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(o,t+1),r=n.maps.length),r--,void c.push(e);if(n){c.push(new TC(e.map));let t,o=e.step.map(n.slice(r));o&&a.maybeStep(o).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new TC(t,void 0,void 0,l.length+c.length))),r--,t&&n.appendMap(t,r)}else a.maybeStep(e.step);return e.selection?(i=n?e.selection.map(n.slice(r)):e.selection,s=new DC(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:s,transform:a,selection:i}}addTransform(e,t,n,r){let o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),u=new TC(e.mapping.maps[c],l,t);(n=a&&a.merge(u))&&(u=n,c?o.pop():s=s.slice(0,s.length-1)),o.push(u),t&&(i++,t=void 0),r||(a=u)}let l=i-n.depth;return l>NC&&(s=function(e,t){let n;return e.forEach((e,r)=>{if(e.selection&&0==t--)return n=r,!1}),e.slice(n)}(s,l),i-=l),new DC(s.append(o),i)}remapping(e,t){let n=new vh;return this.items.forEach((t,r)=>{let o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)},e,t),n}addMaps(e){return 0==this.eventCount?this:new DC(this.items.append(e.map(e=>new TC(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,s=this.eventCount;this.items.forEach(e=>{e.selection&&s--},r);let a=t;this.items.forEach(t=>{let r=o.getMirror(--a);if(null==r)return;i=Math.min(i,r);let l=o.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(o.slice(a+1,r));c&&s++,n.push(new TC(l,i,c))}else n.push(new TC(l))},r);let l=[];for(let d=t;d<i;d++)l.push(new TC(o.maps[d]));let c=this.items.slice(0,r).append(l).append(n),u=new DC(c,s);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((i,s)=>{if(s>=e)r.push(i),i.selection&&o++;else if(i.step){let e=i.step.map(t.slice(n)),s=e&&e.getMap();if(n--,s&&t.appendMap(s,n),e){let a=i.selection&&i.selection.map(t.slice(n));a&&o++;let l,c=new TC(s.invert(),e,a),u=r.length-1;(l=r.length&&r[u].merge(c))?r[u]=l:r.push(c)}}else i.map&&n--},this.items.length,0),new DC(EC.from(r.reverse()),o)}}DC.empty=new DC(EC.empty,0);class TC{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new TC(t.getMap().invert(),t,this.selection)}}}class OC{constructor(e,t,n,r,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}const NC=20;function PC(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,o)=>t.push(r,o));return t}function zC(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}let IC=!1,LC=null;function $C(e){let t=e.plugins;if(LC!=t){IC=!1,LC=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){IC=!0;break}}return IC}const RC=new Ep("history"),FC=new Ep("closeHistory");function BC(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Cp({key:RC,state:{init:()=>new OC(DC.empty,DC.empty,null,0,-1),apply:(t,n,r)=>function(e,t,n,r){let o,i=n.getMeta(RC);if(i)return i.historyState;n.getMeta(FC)&&(e=new OC(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(RC))return s.getMeta(RC).redo?new OC(e.done.addTransform(n,void 0,r,$C(t)),e.undone,PC(n.mapping.maps),e.prevTime,e.prevComposition):new OC(e.done,e.undone.addTransform(n,void 0,r,$C(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new OC(e.done.rebased(n,o),e.undone.rebased(n,o),zC(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new OC(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),zC(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let o=n.getMeta("composition"),i=0==e.prevTime||!s&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),a=s?zC(e.prevRanges,n.mapping):PC(n.mapping.maps);return new OC(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,$C(t)),DC.empty,a,n.time,null==o?e.prevComposition:o)}}(n,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?HC:"historyRedo"==n?jC:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function VC(e,t){return(n,r)=>{let o=RC.getState(n);if(!o||0==(e?o.undone:o.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=$C(t),o=RC.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),a=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),o,r),l=new OC(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(s).setMeta(RC,{redo:n,historyState:l})}(o,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}const HC=VC(!1,!0),jC=VC(!0,!0);qk.create({name:"characterCount",addOptions:()=>({limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(e=>""!==e).length}),addStorage:()=>({characters:()=>0,words:()=>0}),onBeforeCreate(){this.storage.characters=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc;if("textSize"===((null==e?void 0:e.mode)||this.options.mode)){const e=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(e)}return t.nodeSize},this.storage.words=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let e=!1;return[new Cp({key:new Ep("characterCount"),appendTransaction:(t,n,r)=>{if(e)return;const o=this.options.limit;if(null==o||0===o)return void(e=!0);const i=this.storage.characters({node:r.doc});if(i>o){const t=0,n=i-o;console.warn(`[CharacterCount] Initial content exceeded limit of ${o} characters. Content was automatically trimmed.`);const s=r.tr.deleteRange(t,n);return e=!0,s}e=!0},filterTransaction:(e,t)=>{const n=this.options.limit;if(!e.docChanged||0===n||null==n)return!0;const r=this.storage.characters({node:t.doc}),o=this.storage.characters({node:e.doc});if(o<=n)return!0;if(r>n&&o>n&&o<=r)return!0;if(r>n&&o>n&&o>r)return!1;if(!e.getMeta("paste"))return!1;const i=e.selection.$head.pos,s=i-(o-n),a=i;e.deleteRange(s,a);return!(this.storage.characters({node:e.doc})>n)}})]}});var qC=qk.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[mC(this.options)]}});qk.create({name:"focus",addOptions:()=>({className:"has-focus",mode:"all"}),addProseMirrorPlugins(){return[new Cp({key:new Ep("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:o}=t,i=[];if(!n||!r)return $g.create(e,[]);let s=0;"deepest"===this.options.mode&&e.descendants((e,t)=>{if(e.isText)return;if(!(o>=t&&o<=t+e.nodeSize-1))return!1;s+=1});let a=0;return e.descendants((e,t)=>{if(e.isText)return!1;if(!(o>=t&&o<=t+e.nodeSize-1))return!1;a+=1;if("deepest"===this.options.mode&&s-a>0||"shallowest"===this.options.mode&&a>1)return"deepest"===this.options.mode;i.push(zg.node(t,t+e.nodeSize,{class:this.options.className}))}),$g.create(e,i)}}})]}});var KC=qk.create({name:"gapCursor",addProseMirrorPlugins:()=>[new Cp({props:{decorations:_C,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&yC.valid(n)?new yC(n):null,handleClick:xC,handleKeyDown:bC,handleDOMEvents:{beforeinput:CC}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!=(t=Hv(Rv(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))?t:null}}}),WC=qk.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something â¦",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new Cp({key:new Ep("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,o=[];if(!n)return null;const i=this.editor.isEmpty;return e.descendants((e,t)=>{const n=r>=t&&r<=t+e.nodeSize,s=!e.isLeaf&&lk(e);if((n||!this.options.showOnlyCurrent)&&s){const r=[this.options.emptyNodeClass];i&&r.push(this.options.emptyEditorClass);const s=zg.node(t,t+e.nodeSize,{class:r.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});o.push(s)}return this.options.includeChildren}),$g.create(e,o)}}})]}});function ZC({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||(null==t?void 0:t.type)===e}qk.create({name:"selection",addOptions:()=>({className:"selection"}),addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Cp({key:new Ep("selection"),props:{decorations:n=>n.selection.empty||e.isFocused||!e.isEditable||ck(n.selection)||e.view.dragging?null:$g.create(n.doc,[zg.inline(n.selection.from,n.selection.to,{class:t.className})])}})]}});var UC=qk.create({name:"trailingNode",addOptions:()=>({node:void 0,notAfter:[]}),addProseMirrorPlugins(){var e;const t=new Ep(this.name),n=(null==(e=this.editor.schema.topNodeType.contentMatch.defaultType)?void 0:e.name)||this.options.node||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,e])=>e).filter(e=>(this.options.notAfter||[]).concat(n).includes(e.name));return[new Cp({key:t,appendTransaction:(e,r,o)=>{const{doc:i,tr:s,schema:a}=o,l=t.getState(o),c=i.content.size,u=a.nodes[n];if(l)return s.insert(c,u.create())},state:{init:(e,t)=>!ZC({node:t.tr.doc.lastChild,types:r}),apply:(e,t)=>{if(!e.docChanged)return t;return!ZC({node:e.doc.lastChild,types:r})}}})]}}),JC=qk.create({name:"undoRedo",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>HC(e,t),redo:()=>({state:e,dispatch:t})=>jC(e,t)}),addProseMirrorPlugins(){return[BC(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Ñ":()=>this.editor.commands.undo(),"Shift-Mod-Ñ":()=>this.editor.commands.redo()}}}),GC=qk.create({name:"starterKit",addExtensions(){var e,t,n,r;const o=[];return!1!==this.options.bold&&o.push(_b.configure(this.options.bold)),!1!==this.options.blockquote&&o.push(kb.configure(this.options.blockquote)),!1!==this.options.bulletList&&o.push(Vx.configure(this.options.bulletList)),!1!==this.options.code&&o.push(Mb.configure(this.options.code)),!1!==this.options.codeBlock&&o.push(Tb.configure(this.options.codeBlock)),!1!==this.options.document&&o.push(Ob.configure(this.options.document)),!1!==this.options.dropcursor&&o.push(qC.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&o.push(KC.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&o.push(Nb.configure(this.options.hardBreak)),!1!==this.options.heading&&o.push(Pb.configure(this.options.heading)),!1!==this.options.undoRedo&&o.push(JC.configure(this.options.undoRedo)),!1!==this.options.horizontalRule&&o.push(zb.configure(this.options.horizontalRule)),!1!==this.options.italic&&o.push(Fb.configure(this.options.italic)),!1!==this.options.listItem&&o.push(Hx.configure(this.options.listItem)),!1!==this.options.listKeymap&&o.push(Qx.configure(null==(e=this.options)?void 0:e.listKeymap)),!1!==this.options.link&&o.push($x.configure(null==(t=this.options)?void 0:t.link)),!1!==this.options.orderedList&&o.push(iC.configure(this.options.orderedList)),!1!==this.options.paragraph&&o.push(cC.configure(this.options.paragraph)),!1!==this.options.strike&&o.push(hC.configure(this.options.strike)),!1!==this.options.text&&o.push(pC.configure(this.options.text)),!1!==this.options.underline&&o.push(fC.configure(null==(n=this.options)?void 0:n.underline)),!1!==this.options.trailingNode&&o.push(UC.configure(null==(r=this.options)?void 0:r.trailingNode)),o}}),XC=WC;const YC={};function QC(e,t){"string"!=typeof t&&(t=QC.defaultChars);const n=function(e){let t=YC[e];if(t)return t;t=YC[e]=[];for(let n=0;n<128;n++){const e=String.fromCharCode(n);t.push(e)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(e){let t="";for(let r=0,o=e.length;r<o;r+=3){const i=parseInt(e.slice(r+1,r+3),16);if(i<128)t+=n[i];else{if(192==(224&i)&&r+3<o){const n=parseInt(e.slice(r+4,r+6),16);if(128==(192&n)){const e=i<<6&1984|63&n;t+=e<128?"ï¿½ï¿½":String.fromCharCode(e),r+=3;continue}}if(224==(240&i)&&r+6<o){const n=parseInt(e.slice(r+4,r+6),16),o=parseInt(e.slice(r+7,r+9),16);if(128==(192&n)&&128==(192&o)){const e=i<<12&61440|n<<6&4032|63&o;t+=e<2048||e>=55296&&e<=57343?"ï¿½ï¿½ï¿½":String.fromCharCode(e),r+=6;continue}}if(240==(248&i)&&r+9<o){const n=parseInt(e.slice(r+4,r+6),16),o=parseInt(e.slice(r+7,r+9),16),s=parseInt(e.slice(r+10,r+12),16);if(128==(192&n)&&128==(192&o)&&128==(192&s)){let e=i<<18&1835008|n<<12&258048|o<<6&4032|63&s;e<65536||e>1114111?t+="ï¿½ï¿½ï¿½ï¿½":(e-=65536,t+=String.fromCharCode(55296+(e>>10),56320+(1023&e))),r+=9;continue}}t+="ï¿½"}}return t})}QC.defaultChars=";/?:@&=+$,#",QC.componentChars="";const e_={};function t_(e,t,n){"string"!=typeof t&&(n=t,t=t_.defaultChars),void 0===n&&(n=!0);const r=function(e){let t=e_[e];if(t)return t;t=e_[e]=[];for(let n=0;n<128;n++){const e=String.fromCharCode(n);/^[0-9a-z]$/i.test(e)?t.push(e):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}(t);let o="";for(let i=0,s=e.length;i<s;i++){const t=e.charCodeAt(i);if(n&&37===t&&i+2<s&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3)))o+=e.slice(i,i+3),i+=2;else if(t<128)o+=r[t];else if(t>=55296&&t<=57343){if(t>=55296&&t<=56319&&i+1<s){const t=e.charCodeAt(i+1);if(t>=56320&&t<=57343){o+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}o+="%EF%BF%BD"}else o+=encodeURIComponent(e[i])}return o}function n_(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&-1!==e.hostname.indexOf(":")?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function r_(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}t_.defaultChars=";/?:@&=+$,-_.!~*'()#",t_.componentChars="-_.!~*'()";const o_=/^([a-z0-9.+-]+:)/i,i_=/:[0-9]*$/,s_=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,a_=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l_=["'"].concat(a_),c_=["%","/","?",";","#"].concat(l_),u_=["/","?","#"],d_=/^[+a-z0-9A-Z_-]{0,63}$/,h_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p_={javascript:!0,"javascript:":!0},f_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function m_(e,t){if(e&&e instanceof r_)return e;const n=new r_;return n.parse(e,t),n}r_.prototype.parse=function(e,t){let n,r,o,i=e;if(i=i.trim(),!t&&1===e.split("#").length){const e=s_.exec(i);if(e)return this.pathname=e[1],e[2]&&(this.search=e[2]),this}let s=o_.exec(i);if(s&&(s=s[0],n=s.toLowerCase(),this.protocol=s,i=i.substr(s.length)),(t||s||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(o="//"===i.substr(0,2),!o||s&&p_[s]||(i=i.substr(2),this.slashes=!0)),!p_[s]&&(o||s&&!f_[s])){let e,t,n=-1;for(let a=0;a<u_.length;a++)r=i.indexOf(u_[a]),-1!==r&&(-1===n||r<n)&&(n=r);t=-1===n?i.lastIndexOf("@"):i.lastIndexOf("@",n),-1!==t&&(e=i.slice(0,t),i=i.slice(t+1),this.auth=e),n=-1;for(let a=0;a<c_.length;a++)r=i.indexOf(c_[a]),-1!==r&&(-1===n||r<n)&&(n=r);-1===n&&(n=i.length),":"===i[n-1]&&n--;const o=i.slice(0,n);i=i.slice(n),this.parseHost(o),this.hostname=this.hostname||"";const s="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!s){const e=this.hostname.split(/\./);for(let t=0,n=e.length;t<n;t++){const n=e[t];if(n&&!n.match(d_)){let r="";for(let e=0,t=n.length;e<t;e++)n.charCodeAt(e)>127?r+="x":r+=n[e];if(!r.match(d_)){const r=e.slice(0,t),o=e.slice(t+1),s=n.match(h_);s&&(r.push(s[1]),o.unshift(s[2])),o.length&&(i=o.join(".")+i),this.hostname=r.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),s&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=i.indexOf("#");-1!==a&&(this.hash=i.substr(a),i=i.slice(0,a));const l=i.indexOf("?");return-1!==l&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),f_[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this},r_.prototype.parseHost=function(e){let t=i_.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const g_=Object.freeze(Object.defineProperty({__proto__:null,decode:QC,encode:t_,format:n_,parse:m_},Symbol.toStringTag,{value:"Module"})),y_=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,v_=/[\0-\x1F\x7F-\x9F]/,k_=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,b_=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,w_=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,x_=Object.freeze(Object.defineProperty({__proto__:null,Any:y_,Cc:v_,Cf:/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,P:k_,S:b_,Z:w_},Symbol.toStringTag,{value:"Module"})),C_=new Uint16Array('áµ<ÃÄ±ÊÒÕ»×ÙµÛÞ¢ßà à©àªà¶¡à¹­à¼à¼¦áá¨á¡ááááá¥\0\0\0\0\0\0á«áá¦á°á·á½¾â â°âââ»ââ ¤â¤â´â¹â¿ããºã¹ã¬ã£¾ã¨¨ã©±ã« ã¬®à EMabcfglmnoprstu\\bfmsÂÂÂÂÂÂ¦Â³Â¹ÃÃligè»ÃäPè»&ä¦cuteè»Ãäreve;äÄiyx}rcè»Ãä;är;ìðraveè»Ãäpha;äacr;äd;æ©ÄgpÂÂ¡on;äf;ìð¸plyFunction;æ¡ingè»ÃäÄcsÂ¾Ãr;ìðign;æildeè»Ãämlè»ÃäÐaceforsuÃ¥Ã»Ã¾ÄÄÄ¢Ä§ÄªÄcrÃªÃ²kslash;æÅ¶Ã¶Ã¸;æ«§ed;æy;äÆcrtÄÄÄause;æµnoullis;æ¬a;är;ìðpf;ìð¹eve;äcÃ²Ämpeq;æÜHOacdefhilorsuÅÅÅÆÆÆ¢ÆµÆ·ÆºÇÈÉ³É¸É¾cy;ä§PYè»Â©ä©ÆcpyÅÅ¢Åºute;äÄ;iÅ§Å¨ætalDifferentialD;æleys;æ­ÈaeioÆÆÆÆron;ädilè»Ãärc;änint;æ°ot;äÄdnÆ§Æ­illa;ä¸terDot;ä·Ã²Å¿i;ä§rcleÈDMPTÇÇÇÇot;æinus;ælus;æimes;æoÄcsÇ¢Ç¸kwiseContourIntegral;æ²eCurlyÄDQÈÈoubleQuote;æuote;æÈlnpuÈÈ¨ÉÉonÄ;eÈ¥È¦æ·;æ©´ÆgitÈ¯È¶Èºruent;æ¡nt;æ¯ourIntegral;æ®ÄfrÉÉ;æoduct;ænterClockwiseContourIntegral;æ³oss;æ¨¯cr;ìðpÄ;CÊÊæap;æÖDJSZacefiosÊ Ê¬Ê°Ê´Ê¸ËËË¡Ë¦Ì³ÒÄ;oÅ¹Ê¥trahd;æ¤cy;äcy;äcy;äÆgrsÊ¿ËËger;æ¡r;æ¡hv;æ«¤ÄayËËron;ä;älÄ;tËËæa;är;ìðÄafË«Ì§ÄcmË°Ì¢riticalÈADGTÌÌÌÌcute;ä´oÅ´ÌÌ;äbleAcute;ärave;ä ilde;äond;æferentialD;æÑ°Ì½\0\0\0ÍÍ\0Ðf;ìð»Æ;DEÍÍÍä¨ot;æqual;æbleÌCDLRUVÍ£Í²ÎÏÏ¢Ï¸ontourIntegraÃ¬È¹oÉ´Í¹\0\0Í»Â»ÍnArrow;æÄeoÎÎ¤ftÆARTÎÎÎ¡rrow;æightArrow;æeÃ¥ËngÄLRÎ«ÏeftÄARÎ³Î¹rrow;æ¸ightArrow;æºightArrow;æ¹ightÄATÏÏrrow;æee;æ¨pÉÏ©\0\0Ï¯rrow;æownArrow;æerticalBar;æ¥nÌABLRTaÐÐªÐ°ÑÑ¿Í¼rrowÆ;BUÐÐÐ¢æar;æ¤pArrow;æµreve;äeftËÐº\0Ñ\0ÑightVector;æ¥eeVector;æ¥ectorÄ;BÑÑæ½ar;æ¥ightÇÑ§\0Ñ±eeVector;æ¥ectorÄ;BÑºÑ»æar;æ¥eeÄ;AÒÒæ¤rrow;æ§ÄctÒÒr;ìðrok;äà NTacdfglmopqstuxÒ½ÓÓÓÓÓ¢Ó§Ó®ÓµÔ¡Ô¯Ô¶ÕÕÕ Õ¥G;äHè»Ãäcuteè»ÃäÆaiyÓÓÓron;ärcè»Ãä;ä­ot;är;ìðraveè»Ãäement;æÄapÓºÓ¾cr;ätyÉÔ\0\0ÔmallSquare;æ»erySmallSquare;æ«ÄgpÔ¦Ôªon;äf;ìð¼silon;äuÄaiÔ¼ÕlÄ;TÕÕæ©µilde;ælibrium;æÄciÕÕr;æ°m;æ©³a;ämlè»ÃäÄipÕªÕ¯sts;æonentialE;æÊcfiosÖÖÖÖ²×y;ä¤r;ìðlledÉÖ\0\0Ö£mallSquare;æ¼erySmallSquare;æªÍ°Öº\0Ö¿\0\0×f;ìð½All;æriertrf;æ±cÃ²×ØJTabcdfgorst×¨×¬×¯×ºØØØØØØ£Ù¬Ù²cy;äè»>ä¾mmaÄ;d×·×¸ä;äreve;äÆeiyØØØdil;ä¢rc;ä;äot;ä r;ìð;æpf;ìð¾eaterÌEFGLSTØµÙÙÙÙÙ¦qualÄ;LØ¾Ø¿æ¥ess;æullEqual;æ§reater;æª¢ess;æ·lantEqual;æ©¾ilde;æ³cr;ìð¢;æ«ÐAacfiosuÚÚÚÚÚÚªÚ¾ÛRDcy;äªÄctÚÚek;ä;äirc;ä¤r;ælbertSpace;æÇ°Ú¯\0Ú²f;æizontalLine;æÄctÛÛÃ²Ú©rok;ä¦mpÅÛÛownHumÃ°Ä¯qual;æÜEJOacdfgmnostuÛºÛ¾ÜÜÜÜÜÜ¡Ü¨ÝÝ¸ÞÞÞcy;älig;ä²cy;äcuteè»ÃäÄiyÜÜrcè»Ãä;äot;ä°r;æraveè»ÃäÆ;apÜ Ü¯Ü¿ÄcgÜ´Ü·r;äªinaryI;ælieÃ³ÏÇ´Ý\0Ý¢Ä;eÝÝæ¬ÄgrÝÝral;æ«section;æisibleÄCTÝ¬Ý²omma;æ£imes;æ¢ÆgptÝ¿ÞÞon;ä®f;ìða;äcr;æilde;ä¨Ç«Þ\0Þcy;älè»ÃäÊcfosuÞ¬Þ·Þ¼ßßÄiyÞ±Þµrc;ä´;är;ìðpf;ìðÇ£ß\0ßr;ìð¥rcy;äkcy;äÎHJacfosß¤ß¨ß¬ß±ß½à à cy;ä¥cy;äppa;äÄeyß¶ß»dil;ä¶;är;ìðpf;ìðcr;ìð¦ÖJTaceflmostà ¥à ©à ¬à¡à¡£à¦³à¦¸à§à§à¨·à©cy;äè»<ä¼Êcmnprà ·à ¼à¡à¡à¡ute;ä¹bda;äg;æªlacetrf;ær;æÆaeyà¡à¡à¡¡ron;ä½dil;ä»;äÄfsà¡¨à¥°tÔACDFRTUVarà¡¾à¢©à¢±à£ à£¦à£¼à¤¯à¥Îà¥ªÄnrà¢à¢gleBracket;æ¨rowÆ;BRà¢à¢à¢æar;æ¤ightArrow;æeiling;æoÇµà¢·\0à£bleBracket;æ¦nÇà£\0à£eeVector;æ¥¡ectorÄ;Bà£à£æar;æ¥loor;æightÄAVà£¯à£µrrow;æector;æ¥Äerà¤à¤eÆ;AVà¤à¤à¤æ£rrow;æ¤ector;æ¥iangleÆ;BEà¤¤à¤¥à¤©æ²ar;æ§qual;æ´pÆDTVà¤·à¥à¥ownVector;æ¥eeVector;æ¥ ectorÄ;Bà¥à¥æ¿ar;æ¥ectorÄ;Bà¥¥à¥¦æ¼ar;æ¥ightÃ¡ÎsÌEFGLSTà¥¾à¦à¦à¦à¦¢à¦­qualGreater;æullEqual;æ¦reater;æ¶ess;æª¡lantEqual;æ©½ilde;æ²r;ìðÄ;eà¦½à¦¾æftarrow;æidot;ä¿Ænpwà§à¨à¨gÈLRlrà§à§·à¨à¨eftÄARà§¦à§¬rrow;æµightArrow;æ·ightArrow;æ¶eftÄarÎ³à¨ightÃ¡Î¿ightÃ¡Ïf;ìðerÄLRà¨¢à¨¬eftArrow;æightArrow;æÆchtà¨¾à©à©Ã²à¡;æ°rok;ä;æªÐacefiosuà©à©à© à©·à©¼àªàªàªp;æ¤y;äÄdlà©¥à©¯iumSpace;ælintrf;æ³r;ìðnusPlus;æpf;ìðcÃ²à©¶;äÒJacefostuàª£àª§àª­à«à¬à¬à¶à¶à¶cy;äcute;äÆaeyàª´àª¹àª¾ron;ädil;ä;äÆgswà«à«°à¬ativeÆMTVà«à«à«¨ediumSpace;æhiÄcnà«¦à«Ã«à«eryThiÃ®à«tedÄGLà«¸à¬reaterGreateÃ²Ù³essLesÃ³à©Line;är;ìðÈBnptà¬¢à¬¨à¬·à¬ºreak;æ BreakingSpace;ä f;æÚ;CDEGHLNPRSTVà­à­à­ªà­¼à®¡à¯«à°à±à²à²¦à³àµ¡à¶æ«¬Äouà­à­¤ngruent;æ¢pCap;æ­oubleVerticalBar;æ¦Ælqxà®à®à®ement;æualÄ;Tà®à®æ ilde;ìâÌ¸ists;æreaterÎ;EFGLSTà®¶à®·à®½à¯à¯à¯à¯¥æ¯qual;æ±ullEqual;ìâ§Ì¸reater;ìâ«Ì¸ess;æ¹lantEqual;ìâ©¾Ì¸ilde;æµumpÅà¯²à¯½ownHump;ìâÌ¸qual;ìâÌ¸eÄfsà°à°§tTriangleÆ;BEà°à°à°¡æªar;ìâ§Ì¸qual;æ¬sÌ;EGLSTà°µà°¶à°¼à±à±à±æ®qual;æ°reater;æ¸ess;ìâªÌ¸lantEqual;ìâ©½Ì¸ilde;æ´estedÄGLà±¨à±¹reaterGreater;ìâª¢Ì¸essLess;ìâª¡Ì¸recedesÆ;ESà²à²à²æqual;ìâª¯Ì¸lantEqual;æ Äeià²«à²¹verseElement;æghtTriangleÆ;BEà³à³à³æ«ar;ìâ§Ì¸qual;æ­Äquà³à´uareSuÄbpà³¨à³¹setÄ;Eà³°à³³ìâÌ¸qual;æ¢ersetÄ;Eà´à´ìâÌ¸qual;æ£Æbcpà´à´¤àµsetÄ;Eà´à´ìââqual;æceedsÈ;ESTà´²à´³à´»àµæqual;ìâª°Ì¸lantEqual;æ¡ilde;ìâ¿Ì¸ersetÄ;Eàµàµìââqual;æildeÈ;EFTàµ®àµ¯àµµàµ¿æqual;æullEqual;æilde;æerticalBar;æ¤cr;ìð©ildeè»Ãä;äÜEacdfgmoprstuvà¶½à·à·à·à·à· à·§à·¼à¸à¸ à¸¢à¸²à¸¿à¹lig;äcuteè»ÃäÄiyà·à·rcè»Ãä;äblac;är;ìðraveè»ÃäÆaeià·®à·²à·¶cr;äga;ä©cron;äpf;ìðenCurlyÄDQà¸à¸oubleQuote;æuote;æ;æ©Äclà¸§à¸¬r;ìðªashè»ÃäiÅ¬à¸·à¸¼deè»Ãäes;æ¨·mlè»ÃäerÄBPà¹à¹ Äarà¹à¹r;æ¾acÄekà¹à¹;æet;æ´arenthesis;æÒacfhilorsà¹¿àºàºàºàºàºàºàº°à»¼rtialD;æy;är;ìði;ä¦;ä usMinus;ä±Äipàº¢àº­ncareplanÃ¥Úf;æÈ;eioàº¹àººà» à»¤æª»cedesÈ;ESTà»à»à»à»æºqual;æª¯lantEqual;æ¼ilde;æ¾me;æ³Ädpà»©à»®uct;æortionÄ;aÈ¥à»¹l;æÄcià¼à¼r;ìð«;ä¨ÈUfosà¼à¼à¼à¼OTè»"ä¢r;ìðpf;æcr;ìð¬ØBEacefhiorsuà¼¾à½à½à½ à½³à¾§à¾ªà¾­áá©á´á¾arr;æ¤Gè»Â®ä®Æcnrà½à½à½ute;äg;æ«rÄ;tà½à½æ l;æ¤Æaeyà½§à½¬à½±ron;ädil;ä;ä Ä;và½¸à½¹æerseÄEUà¾à¾Älqà¾à¾ement;æuilibrium;æpEquilibrium;æ¥¯rÂ»à½¹o;ä¡ghtÐACDFTUVaà¿à¿«à¿³á¢á¨ááÏÄnrà¿à¿gleBracket;æ©rowÆ;BLà¿à¿à¿¡æar;æ¥eftArrow;æeiling;æoÇµà¿¹\0ábleBracket;æ§nÇá\0áeeVector;æ¥ectorÄ;Bááæar;æ¥loor;æÄerá­áeÆ;AVáµá¶á¼æ¢rrow;æ¦ector;æ¥iangleÆ;BEáááæ³ar;æ§qual;æµpÆDTVá£á®á¸ownVector;æ¥eeVector;æ¥ectorÄ;Bááæ¾ar;æ¥ectorÄ;Bááæar;æ¥Äpuááf;ændImplies;æ¥°ightarrow;æÄchá¹á¼r;æ;æ±leDelayed;æ§´ÚHOacfhimoqstuá¤á±á·á½ááááá¡á§áµá»á¿ÄCcá©á®Hcy;ä©y;ä¨FTcy;ä¬cute;äÊ;aeiyáááááæª¼ron;ä dil;ärc;ä;ä¡r;ìðortÈDLRUáªá´á¾áownArrowÂ»ÐeftArrowÂ»à¢ightArrowÂ»à¿pArrow;ægma;ä£allCircle;æpf;ìðÉ²á­\0\0á°t;æareÈ;ISUá»á¼áá¯æ¡ntersection;æuÄbpáásetÄ;Eááæqual;æersetÄ;Eá¨á©æqual;ænion;æcr;ìð®ar;æÈbcmpááááÄ;sááæetÄ;Eááqual;æÄchá áeedsÈ;ESTá­á®á´á¿æ»qual;æª°lantEqual;æ½ilde;æ¿ThÃ¡à¾;æÆ;esááá£ærsetÄ;Eááæqual;æetÂ»áÖHRSacfhiorsá¾ááááá±á¶ááááORNè»ÃäADE;æ¢ÄHcáácy;äy;ä¦Äbuáá;ä;ä¤Æaeyá¥áªá¯ron;ä¤dil;ä¢;ä¢r;ìðÄeiá»áÇ²á\0áefore;æ´a;äÄcnáákSpace;ìââSpace;ældeÈ;EFTá«á¬á²á¼æ¼qual;æullEqual;æilde;æpf;ìðipleDot;æÄctáár;ìð¯rok;ä¦à«¡á·ááá¦\0á¬á±\0\0\0\0\0á¸á½á·á\0á¿áááÄcrá»áuteè»ÃärÄ;oááæcir;æ¥rÇ£á\0áy;äve;ä¬Äiyáá£rcè»Ãä;ä£blac;ä°r;ìðraveè»Ãäacr;äªÄdiáá©erÄBPááÄaráár;äacÄekáá;æet;æµarenthesis;æonÄ;Pá°á±ælus;æÄgpá»á¿on;ä²f;ìðÐADETadpsáá®á¸áÏ¨ááá³rrowÆ;BDáá á¤ar;æ¤ownArrow;æownArrow;æquilibrium;æ¥®eeÄ;Aááæ¥rrow;æ¥ownÃ¡Ï³erÄLRáá¨eftArrow;æightArrow;æiÄ;lá¹áºäon;ä¥ing;ä®cr;ìð°ilde;ä¨mlè»ÃäÒDbcdefosvá§á¬á°á³á¾ááááash;æ«ar;æ««y;äashÄ;lá»á¼æ©;æ«¦Äeráá;æÆbtyáááºar;æÄ;iáácalÈBLSTá¡á¥áªá´ar;æ£ine;ä¼eparator;æilde;æThinSpace;ær;ìðpf;ìðcr;ìð±dash;æªÊcefosá§á¬á±á¶á¼irc;ä´dge;ær;ìðpf;ìðcr;ìð²Èfiosáááár;ìð;äpf;ìðcr;ìð³ÒAIUacfosuá±áµá¹á½ááááá cy;ä¯cy;äcy;ä®cuteè»ÃäÄiyáárc;ä¶;ä«r;ìðpf;ìðcr;ìð´ml;ä¸ÐHacdefosáµá¹á¿áááá á¤cy;äcute;ä¹Äayááron;ä½;äot;ä»Ç²á\0áoWidtÃ¨à«a;är;æ¨pf;æ¤cr;ìðµà¯¡ááá\0á°á¶á¿\0\0\0\0ááá«áá­\0ááá²á¹\0á¾cuteè»Ã¡ä¡reve;äÌ;Ediuyááá¡á£á¨á­æ¾;ìâ¾Ì³;æ¿rcè»Ã¢ä¢teè»Â´Ì;ä°ligè»Ã¦ä¦Ä;rÂ²áº;ìðraveè»Ã ä ÄepááÄfpáásym;æµÃ¨áha;ä±ÄapácÄclá¤á§r;äg;æ¨¿É¤á°\0\0áÊ;adsváºá»á¿ááæ§nd;æ©;æ©lope;æ©;æ©Î;elmrszááááá¿ááæ ;æ¦¤eÂ»ásdÄ;aá¥á¦æ¡Ñ¡á°á²á´á¶á¸áºá¼á¾;æ¦¨;æ¦©;æ¦ª;æ¦«;æ¦¬;æ¦­;æ¦®;æ¦¯tÄ;vááæbÄ;dááæ¾;æ¦Äptááh;æ¢Â»Â¹arr;æ¼Ägpá£á§on;äf;ìðÎ;Eaeiopáá»á½áááá;æ©°cir;æ©¯;æd;æs;ä§roxÄ;eááÃ±áingè»Ã¥ä¥Æctyá¡á¦á¨r;ìð¶;äªmpÄ;eáá¯Ã±Êildeè»Ã£ä£mlè»Ã¤ä¤ÄciááoninÃ´É²nt;æ¨à Nabcdefiklnoprsuá­á±á°á¼ááá¸á½á á¦á ¹á¡áá¤½á¥á¥°ot;æ«­Äcrá¶ákÈcepsááááong;æpsilon;ä¶rime;æµimÄ;eááæ½q;æÅ¶á¢á¦ee;æ½edÄ;gá¬á­æeÂ»á­rkÄ;táá·brk;æ¶Äoyáá;ä±quo;æÊcmprtááá¡á¤á¨ausÄ;eÄÄptyv;æ¦°sÃ©ánoÃµÄÆahwá¯á±á³;ä²;æ¶een;æ¬r;ìðgÎcostuvwááá³ááááÆaiuáááÃ°Ý rc;æ¯pÂ»á±Ædptá¤á¨á­ot;æ¨lus;æ¨imes;æ¨É±á¹\0\0á¾cup;æ¨ar;æriangleÄduááown;æ½p;æ³plus;æ¨eÃ¥áÃ¥á­arow;æ¤Æakoá­á ¦á µÄcná²á £kÆlstáºÖ«á ozenge;æ§«riangleÈ;dlrá á á á æ´own;æ¾eft;æight;æ¸k;æ£Æ±á «\0á ³Æ²á ¯\0á ±;æ;æ4;æck;æÄeoá ¾á¡Ä;qá¡á¡ì=â¥uiv;ìâ¡â¥t;æÈptwxá¡á¡á¡§á¡¬f;ìðÄ;táá¡£omÂ»átie;æØDHUVbdhmptuvá¢á¢á¢ªá¢»á£á£á£¬á£¿á¤á¤á¤á¤¡ÈLRlrá¢á¢á¢á¢;æ;æ;æ;æÊ;DUduá¢¡á¢¢á¢¤á¢¦á¢¨æ;æ¦;æ©;æ¤;æ§ÈLRlrá¢³á¢µá¢·á¢¹;æ;æ;æ;æÎ;HLRhlrá£á£á£á£á£á£á£æ;æ¬;æ£;æ ;æ«;æ¢;æox;æ§ÈLRlrá£¤á£¦á£¨á£ª;æ;æ;æ;æÊ;DUduÚ½á£·á£¹á£»á£½;æ¥;æ¨;æ¬;æ´inus;ælus;æimes;æ ÈLRlrá¤á¤á¤á¤;æ;æ;æ;æÎ;HLRhlrá¤°á¤±á¤³á¤µá¤·á¤¹á¤»æ;æª;æ¡;æ;æ¼;æ¤;æÄevÄ£á¥barè»Â¦ä¦Èceioá¥á¥á¥á¥ r;ìð·mi;æmÄ;eáálÆ;bhá¥¨á¥©á¥«ä;æ§sub;æÅ¬á¥´á¥¾lÄ;eá¥¹á¥ºæ¢tÂ»á¥ºpÆ;EeÄ¯á¦á¦;æª®Ä;qÛÛà³¡á¦§\0á§¨á¨á¨á¨²\0á¨·á©\0\0áª´\0\0á«\0\0á¬¡á¬®á­á­\0á¯½\0á°Æcprá¦­á¦²á§ute;äÌ;abcdsá¦¿á§á§á§á§á§æ©nd;æ©rcup;æ©Äauá§á§p;æ©p;æ©ot;æ©;ìâ©ï¸Äeoá§¢á§¥t;æÃ®ÚÈaeiuá§°á§»á¨á¨Ç°á§µ\0á§¸s;æ©on;ädilè»Ã§ä§rc;äpsÄ;sá¨á¨æ©m;æ©ot;äÆdmná¨á¨ á¨¦ilè»Â¸Æ­ptyv;æ¦²tèÂ¢;eá¨­á¨®ä¢rÃ¤Æ²r;ìð Æceiá¨½á©á©y;äckÄ;má©á©æarkÂ»á©;ärÎ;Ecefmsá©á© á©¢á©«áª¤áªªáª®æ;æ§Æ;elá©©á©ªá©­äq;æeÉ¡á©´\0\0áªrrowÄlrá©¼áªeft;æºight;æ»ÊRSacdáªáªáªáªáªÂ»à½;æst;æirc;æash;ænint;æ¨id;æ«¯cir;æ§ubsÄ;uáª»áª¼æ£itÂ»áª¼Ë¬á«á«á«º\0á¬onÄ;eá«á«äºÄ;qÃÃÉ­á«\0\0á«¢aÄ;tá«á«ä¬;äÆ;flá«¨á«©á««æÃ®á eÄmxá«±á«¶entÂ»á«©eÃ³ÉÇ§á«¾\0á¬Ä;dá»á¬ot;æ©­nÃ´ÉÆfryá¬á¬á¬;ìðoÃ¤ÉèÂ©;sÅá¬r;æÄaoá¬¥á¬©rr;æµss;æÄcuá¬²á¬·r;ìð¸Äbpá¬¼á­Ä;eá­á­æ«;æ«Ä;eá­á­æ«;æ«dot;æ¯Îdelprvwá­ á­¬á­·á®á®¬á¯á¯¹arrÄlrá­¨á­ª;æ¤¸;æ¤µÉ°á­²\0\0á­µr;æc;æarrÄ;pá­¿á®æ¶;æ¤½Ì;bcdosá®á®á®á®¡á®¥á®¨æªrcap;æ©Äauá®á®p;æ©p;æ©ot;ær;æ©;ìâªï¸Èalrvá®µá®¿á¯á¯£rrÄ;má®¼á®½æ·;æ¤¼yÆevwá¯á¯á¯qÉ°á¯\0\0á¯reÃ£á­³uÃ£á­µee;æedge;æenè»Â¤ä¤earrowÄlrá¯®á¯³eftÂ»á®ightÂ»á®½eÃ¤á¯Äciá°á°oninÃ´Ç·nt;æ±lcty;æ­à¦AHabcdefhijlorstuwzá°¸á°»á°¿á±á±©á±µá²á²á²¬á²·á³»á³¿á´áµ»á¶á¶«á¶»á·á·rÃ²Îar;æ¥¥Èglrsá±á±á±á±ger;æ eth;æ¸Ã²á³hÄ;vá±á±æÂ»à¤Å«á±¡á±§arow;æ¤aÃ£ÌÄayá±®á±³ron;ä;ä´Æ;aoÌ²á±¼á²ÄgrÊ¿á²r;ætseq;æ©·Æglmá²á²á²è»Â°ä°ta;ä´ptyv;æ¦±Äirá²£á²¨sht;æ¥¿;ìð¡arÄlrá²³á²µÂ»à£Â»áÊaegsvá³Í¸á³á³á³ mÆ;osÌ¦á³á³ndÄ;sÌ¦á³uit;æ¦amma;äin;æ²Æ;ioá³§á³¨á³¸ä·deèÃ·;oá³§á³°ntimes;ænÃ¸á³·cy;äcÉ¯á´\0\0á´rn;æop;æÊlptuwá´á´á´¢áµáµlar;ä¤f;ìðÊ;empsÌá´­á´·á´½áµqÄ;dÍá´³ot;æinus;æ¸lus;æquare;æ¡blebarwedgÃ¥ÃºnÆadhá®áµáµ§ownarrowÃ³á²arpoonÄlráµ²áµ¶efÃ´á²´ighÃ´á²¶Å¢áµ¿á¶karoÃ·à½É¯á¶\0\0á¶rn;æop;æÆcotá¶á¶£á¶¦Äryá¶á¶¡;ìð¹;äl;æ§¶rok;äÄdrá¶°á¶´ot;æ±iÄ;fá¶ºá æ¿Äahá·á·rÃ²Ð©aÃ²à¾¦angle;æ¦¦Äciá·á·y;ägrarr;æ¿à¤Dacdefglmnopqrstuxá¸á¸á¸á¸¸Õ¸á¸¼á¹á¹¡á¹¾áº¥áº¯áº½á»¡á¼ªá¼·á½á½á½ÄDoá¸á´´oÃ´á²Äcsá¸á¸uteè»Ã©ä©ter;æ©®Èaioyá¸¢á¸§á¸±á¸¶ron;ärÄ;cá¸­á¸®æè»Ãªäªlon;æ;äot;äÄDrá¹á¹ot;æ;ìð¢Æ;rsá¹á¹á¹æªaveè»Ã¨ä¨Ä;dá¹á¹æªot;æªÈ;ilsá¹ªá¹«á¹²á¹´æªnters;æ§;æÄ;dá¹¹á¹ºæªot;æªÆapsáºáºáºcr;ätyÆ;sváºáºáºæetÂ»áºpÄ1;áºáº¤Ä³áº¡áº£;æ;ææÄgsáºªáº¬;äp;æÄgpáº´áº¸on;äf;ìðÆalsá»á»á»rÄ;sá»á»æl;æ§£us;æ©±iÆ;lvá»á»á»äµonÂ»á»;äµÈcsuvá»ªá»³á¼á¼£Äioá»¯á¸±rcÂ»á¸®É©á»¹\0\0á»»Ã­ÕantÄglá¼á¼trÂ»á¹essÂ»á¹ºÆaeiá¼á¼á¼ls;ä½st;ævÄ;DÈµá¼ D;æ©¸parsl;æ§¥ÄDaá¼¯á¼³ot;ærr;æ¥±Æcdiá¼¾á½á»¸r;æ¯oÃ´ÍÄahá½á½;ä·è»Ã°ä°Ämrá½á½lè»Ã«ä«o;æ¬Æcipá½¡á½¤á½§l;ä¡sÃ´Õ®Äeoá½¬á½´ctatioÃ®ÕnentialÃ¥Õ¹à§¡á¾\0á¾\0á¾¡á¾§\0\0á¿á¿\0á¿\0á¿¦á¿ªâ\0ââllingdotseÃ±á¹y;ämale;æÆilrá¾­á¾³á¿lig;èï¬É©á¾¹\0\0á¾½g;èï¬ig;èï¬;ìð£lig;èï¬lig;ìfjÆaltá¿á¿á¿¡t;æ­ig;èï¬ns;æ±of;äÇ°á¿®\0á¿³f;ìðÄakÖ¿á¿·Ä;vá¿¼á¿½æ;æ«artint;æ¨ÄaoââÄcsââÎ±ââ°â¸ââ\0âÎ²â¢â¥â§âªâ¬\0â®è»Â½ä½;æè»Â¼ä¼;æ;æ;æÆ³â´\0â¶;æ;æÊ´â¾â\0\0âè»Â¾ä¾;æ;æ5;æÆ¶â\0â;æ;æ8;æl;æwn;æ¢cr;ìð»à¢Eabcdefgijlnorstvââââ¥â°â´â°âµâºâ¿âââ¸Ìâ¾ââÄ;lÙâ;æªÆcmpâââute;äµmaÄ;dâá³ä³;æªreve;äÄiyâªâ®rc;ä;ä³ot;ä¡È;lqsØ¾Ùâ½âÆ;qsØ¾ÙâlanÃ´Ù¥È;cdlÙ¥âââ¥c;æª©otÄ;oââæªÄ;lâ¢â£æª;æªÄ;eâªâ­ìâï¸s;æªr;ìð¤Ä;gÙ³Ømel;æ·cy;äÈ;EajÙâââ;æª;æª¥;æª¤ÈEaesâââ©â´;æ©pÄ;pâ£â¤æªroxÂ»â¤Ä;qâ®â¯æªÄ;qâ®âim;æ§pf;ìðÄciââr;æmÆ;elÙ«ââ;æª;æªè>;cdlqr×®â âªâ®â³â¹Äciâ¥â§;æª§r;æ©ºot;æPar;æ¦uest;æ©¼ÊadelsââªâÙâÇ°â\0âproÃ¸âr;æ¥¸qÄlqØ¿âlesÃ³âiÃ­Ù«Äenâ£â­rtneqq;ìâ©ï¸ÃâªÔAabcefkosyâââ±âµâºâââ¯â¨â½rÃ²Î ÈilmrâââârsÃ°áfÂ»â¤ilÃ´Ú©Ädrâ â¤cy;äÆ;cwà£´â«â¯ir;æ¥;æ­ar;æirc;ä¥ÆalrââârtsÄ;uââæ¥itÂ»âlip;æ¦con;æ¹r;ìð¥sÄewâ£â©arow;æ¤¥arow;æ¤¦Êamoprâºâ¾âââ£rr;æ¿tht;æ»kÄlrââeftarrow;æ©ightarrow;æªf;ìðbar;æÆcltâ¯â´â¸r;ìð½asÃ¨â´rok;ä§Äbpââull;æhenÂ»á±à«¡â£\0âª\0â¸ââ\0ââ³\0\0â¸â¢â§â¢â¿\0ââªâ´cuteè»Ã­ä­Æ;iyÝ±â°âµrcè»Ã®ä®;ä¸Äcxâ¼â¿y;äµclè»Â¡ä¡ÄfrÎâ;ìð¦raveè»Ã¬ä¬È;inoÜ¾ââ©â®Äinâ¢â¦nt;æ¨t;æ­fin;æ§ta;æ©lig;ä³Æaopâ¾ââÆcgtâââr;ä«ÆelpÜââinÃ¥ÞarÃ´Ü h;ä±f;æ·ed;äµÊ;cfotÓ´â¬â±â½âare;æinÄ;tâ¸â¹æie;æ§doÃ´âÊ;celpÝââââ¡al;æºÄgrââerÃ³á£Ã£âarhk;æ¨rod;æ¨¼Ècgptâ¯â²â¶â»y;äon;ä¯f;ìða;ä¹uestè»Â¿ä¿Äciââr;ìð¾nÊ;EdsvÓ´âââ¡Ó³;æ¹ot;æµÄ;vâ¦â§æ´;æ³Ä;iÝ·â®lde;ä©Ç«â¸\0â¼cy;älè»Ã¯ä¯Ìcfmosuââââ¡â§âµÄiyâârc;äµ;ä¹r;ìð§ath;ä·pf;ìðÇ£â¬\0â±r;ìð¿rcy;äkcy;äÐacfghjosâââ¢â§â­â±âµâ»ppaÄ;vââäº;ä°Äeyââ dil;ä·;äºr;ìð¨reen;ä¸cy;äcy;äpf;ìðcr;ìðà®ABEHabcdefghjlmnoprstuvâ°ââââââ½âââââ¥â¹â½ââ²âââ¨âââ â Æartâ·âºâ¼rÃ²à§Ã²Îail;æ¤arr;æ¤Ä;gà¦â;æªar;æ¥¢à¥£â¥\0âª\0â±\0\0\0\0\0âµâº\0âââ\0â¹ute;äºmptyv;æ¦´raÃ®à¡bda;ä»gÆ;dlà¢ââ;æ¦Ã¥à¢;æªuoè»Â«ä«rÐ;bfhlpstà¢ââ¦â©â«â®â±âµÄ;fà¢â£s;æ¤s;æ¤Ã«âp;æ«l;æ¤¹im;æ¥³l;æ¢Æ;aeâ¿ââæª«il;æ¤Ä;sââæª­;ìâª­ï¸Æabrââârr;æ¤rk;æ²Äakâ¢â¬cÄekâ¨âª;ä»;äÄesâ±â³;æ¦lÄduâ¹â»;æ¦;æ¦Èaeuyââââron;ä¾Ädiââil;ä¼Ã¬à¢°Ã¢â©;ä»Ècqrsâ£â¦â­â½a;æ¤¶uoÄ;rà¸áÄduâ²â·har;æ¥§shar;æ¥h;æ²Ê;fgqsââà¦â³â¿æ¤tÊahlrtââ¤â·ââ¨rrowÄ;tà¢â¡aÃ©â¶arpoonÄduâ¯â´ownÂ»ÑpÂ»à¥¦eftarrows;æightÆahsââârrowÄ;sà£´à¢§arpoonÃ³à¾quigarroÃ·â°hreetimes;æÆ;qsâà¦âºlanÃ´à¦¬Ê;cdgsà¦¬ââââ¨c;æª¨otÄ;oââæ©¿Ä;rââæª;æªÄ;eâ¢â¥ìâï¸s;æªÊadegsâ³â¹â½ââpproÃ¸âot;æqÄgqââÃ´à¦gtÃ²âÃ´à¦iÃ­à¦²Æilrâà£¡âsht;æ¥¼;ìð©Ä;Eà¦â£;æªÅ¡â©â¶rÄduâ²â®Ä;là¥¥â³;æ¥ªlk;æcy;äÊ;achtà©âââârÃ²âorneÃ²á´ard;æ¥«ri;æºÄioââ¤dot;äustÄ;aâ¬â­æ°cheÂ»â­ÈEaesâ»â½ââ;æ¨pÄ;pââæªroxÂ»âÄ;qââæªÄ;qââ»im;æ¦Ðabnoptwzâ©â´â·ââ¯âââÄnrâ®â±g;æ¬r;æ½rÃ«à£gÆlmrâ¿ââeftÄarà§¦âightÃ¡à§²apsto;æ¼ightÃ¡à§½parrowÄlrâ¥â©efÃ´â­ight;æ¬Æaflâ¶â¹â½r;æ¦;ìðus;æ¨­imes;æ¨´Å¡ââst;æÃ¡áÆ;efââá ængeÂ»âarÄ;lâ¤â¥ä¨t;æ¦Êachmtâ³â¶â¼âârÃ²à¢¨orneÃ²á¶arÄ;dà¾â;æ¥­;æri;æ¿Ìachiqtââà©â¢â®â»quo;æ¹r;ìðmÆ;egà¦²âªâ¬;æª;æªÄbuâªâ³oÄ;rà¸â¹;ærok;äè<;cdhilqrà «ââ¹ââ â¥âªâ°Äciââ;æª¦r;æ©¹reÃ¥â²mes;æarr;æ¥¶uest;æ©»ÄPiâµâ¹ar;æ¦Æ;efâ à¤­á ærÄduâ â shar;æ¥har;æ¥¦Äenâ â ¡rtneqq;ìâ¨ï¸Ãâ ÜDacdefhilnopsuâ¡â¡â¢â¢â¢â¢ â¢¥â¢¨â£â£¢â£¤àªâ£³â¤Dot;æºÈclprâ¡â¡â¡£â¡½rè»Â¯ä¯Äetâ¡â¡;æÄ;eâ¡â¡æ seÂ»â¡Ä;sá»â¡¨toÈ;dluá»â¡³â¡·â¡»owÃ®ÒefÃ´à¤Ã°áker;æ®Äoyâ¢â¢mma;æ¨©;ä¼ash;æasuredangleÂ»á¦r;ìðªo;æ§Æcdnâ¢¯â¢´â£roè»ÂµäµÈ;acdá¤â¢½â£â£sÃ´á§ir;æ«°otè»Â·ÆµusÆ;bdâ£á¤â£æÄ;uá´¼â£;æ¨ªÅ£â£â£¡p;æ«Ã²âÃ°àªÄdpâ£©â£®els;æ§f;ìðÄctâ£¸â£½r;ìðposÂ»áÆ;lmâ¤â¤â¤ä¼timap;æ¸à°GLRVabcdefghijlmoprstuvwâ¥â¥â¥¾â¦â¦â§â§©â¨â¨â©â©âªâªâª¤âª¨â¬â¬â­â­¿â®®â°´â±§â±¼â³©Ägtâ¥â¥;ìâÌ¸Ä;vâ¥à¯ìâ«âÆeltâ¥â¥²â¥¶ftÄarâ¥¡â¥§rrow;æightarrow;æ;ìâÌ¸Ä;vâ¥»à±ìâªâightarrow;æÄDdâ¦â¦ash;æ¯ash;æ®Êbcnptâ¦£â¦§â¦¬â¦±â§laÂ»Ëute;äg;ìâ âÊ;Eiopà¶â¦¼â§â§â§;ìâ©°Ì¸d;ìâÌ¸s;äroÃ¸à¶urÄ;aâ§â§æ®lÄ;sâ§à¬¸Ç³â§\0â§£pè»Â à¬·mpÄ;eà¯¹à°Êaeouyâ§´â§¾â¨â¨â¨Ç°â§¹\0â§»;æ©on;ädil;ängÄ;dàµ¾â¨ot;ìâ©­Ì¸p;æ©;ä½ash;æÎ;Aadqsxà®â¨©â¨­â¨»â©â©â©rr;ærÄhrâ¨³â¨¶k;æ¤¤Ä;oá²á°ot;ìâÌ¸uiÃ¶à­£Äeiâ©â©ar;æ¤¨Ã­à®istÄ;sà® à®r;ìð«ÈEestà¯â©¦â©¹â©¼Æ;qsà®¼â©­à¯¡Æ;qsà®¼à¯â©´lanÃ´à¯¢iÃ­à¯ªÄ;rà®¶âªÂ»à®·ÆAapâªâªâªrÃ²â¥±rr;æ®ar;æ«²Æ;svà¾âªà¾Ä;dâª¡âª¢æ¼;æºcy;äÎAEadestâª·âªºâª¾â«â«â«¶â«¹rÃ²â¥¦;ìâ¦Ì¸rr;ær;æ¥È;fqsà°»â«â«£â«¯tÄarâ«â«rroÃ·â«ightarroÃ·âªÆ;qsà°»âªºâ«ªlanÃ´à±Ä;sà±â«´Â»à°¶iÃ­à±Ä;rà°µâ«¾iÄ;eà°à°¥iÃ¤à¶Äptâ¬â¬f;ìðèÂ¬;inâ¬â¬â¬¶ä¬nÈ;Edvà®â¬¤â¬¨â¬®;ìâ¹Ì¸ot;ìâµÌ¸Ç¡à®â¬³â¬µ;æ·;æ¶iÄ;và²¸â¬¼Ç¡à²¸â­â­;æ¾;æ½Æaorâ­â­£â­©rÈ;astà­»â­â­â­lleÃ¬à­»l;ìâ«½â¥;ìâÌ¸lint;æ¨Æ;ceà²â­°â­³uÃ¥à²¥Ä;cà²â­¸Ä;eà²â­½Ã±à²ÈAaitâ®â®â®â®§rÃ²â¦rrÆ;cwâ®â®â®æ;ìâ¤³Ì¸;ìâÌ¸ghtarrowÂ»â®riÄ;eà³à³Îchimpquâ®½â¯â¯â¬à­¸â¯¤â¯¯È;cerà´²â¯à´·â¯uÃ¥àµ;ìðortÉ­â¬\0\0â¯arÃ¡â­mÄ;eàµ®â¯Ä;qàµ´àµ³suÄbpâ¯«â¯­Ã¥à³¸Ã¥à´Æbcpâ¯¶â°â°È;Eesâ¯¿â°à´¢â°æ;ìâ«Ì¸etÄ;eà´â°qÄ;qà´£â°cÄ;eà´²â°Ã±à´¸È;Eesâ°¢â°£àµâ°§æ;ìâ«Ì¸etÄ;eàµâ°®qÄ;qàµ â°£Ègilrâ°½â°¿â±â±Ã¬à¯ldeè»Ã±ä±Ã§à±iangleÄlrâ±â±eftÄ;eà°â±Ã±à°¦ightÄ;eà³â±¥Ã±à³Ä;mâ±¬â±­ä½Æ;esâ±´â±µâ±¹ä£ro;æp;æÒDHadgilrsâ²â²â²â²â²£â²°â²¶â³â³£ash;æ­arr;æ¤p;ìââash;æ¬Äetâ²¨â²¬;ìâ¥â;ì>ânfin;æ§ÆAetâ²½â³â³rr;æ¤;ìâ¤âÄ;râ³â³ì<âie;ìâ´âÄAtâ³â³rr;æ¤rie;ìâµâim;ìâ¼âÆAanâ³°â³´â´rr;ærÄhrâ³ºâ³½k;æ¤£Ä;oá§á¥ear;æ¤§ááª\0\0\0\0\0\0\0\0\0\0\0\0\0â´­\0â´¸âµâµ âµ¥âµ²â¶á¬\0\0â¶â¶«\0â·â·\0â·â¸â¸«â¸¾â¹Äcsâ´±áªuteè»Ã³ä³Äiyâ´¼âµrÄ;cáªâµè»Ã´ä´;ä¾Êabiosáª âµâµÇâµlac;äv;æ¨¸old;æ¦¼lig;äÄcrâµ©âµ­ir;æ¦¿;ìð¬Í¯âµ¹\0\0âµ¼\0â¶n;äaveè»Ã²ä²;æ§Äbmâ¶à·´ar;æ¦µÈacitâ¶â¶â¶¥â¶¨rÃ²áªÄirâ¶â¶ r;æ¦¾oss;æ¦»nÃ¥à¹;æ§Æaeiâ¶±â¶µâ¶¹cr;äga;äÆcdnâ·â·Çron;ä¿;æ¦¶pf;ìð Æaelâ·â·Çr;æ¦·rp;æ¦¹Î;adiosvâ·ªâ·«â·®â¸â¸â¸â¸æ¨rÃ²áªÈ;efmâ··â·¸â¸â¸æ©rÄ;oâ·¾â·¿æ´fÂ»â·¿è»Âªäªè»Âºäºgof;æ¶r;æ©lope;æ©;æ©Æcloâ¸â¸¡â¸§Ã²â¸ashè»Ã¸ä¸l;æiÅ¬â¸¯â¸´deè»ÃµäµesÄ;aÇâ¸ºs;æ¨¶mlè»Ã¶ä¶bar;æ½à«¡â¹\0â¹½\0âºâº\0âº¢âº¹\0\0â»àº\0â¼\0\0â¼«â¾¼\0â¿rÈ;astÐâ¹§â¹²àºèÂ¶;lâ¹­â¹®ä¶leÃ¬ÐÉ©â¹¸\0\0â¹»m;æ«³;æ«½y;ä¿rÊcimptâºâºâºá¡¥âºnt;ä¥od;ä®il;æ°enk;æ±r;ìð­Æimoâº¨âº°âº´Ä;vâº­âº®ä;ämaÃ´à©¶ne;æÆ;tvâº¿â»â»ächforkÂ»á¿½;äÄauâ»â»nÄckâ»â»kÄ;hâ´â»;æÃ¶â´sÒ;abcdemstâ»³â»´á¤â»¹â»½â¼â¼â¼â¼ä«cir;æ¨£ir;æ¨¢Äouáµâ¼;æ¨¥;æ©²nè»Â±àºim;æ¨¦wo;æ¨§Æipuâ¼â¼ â¼¥ntint;æ¨f;ìð¡ndè»Â£ä£Ô;Eaceinosuà»â¼¿â½â½â½â¾â¾â¾â½¾â¾¶;æª³p;æª·uÃ¥à»Ä;cà»â½Ì;acensà»â½â½â½¦â½¨â½¾pproÃ¸â½urlyeÃ±à»Ã±à»Æaesâ½¯â½¶â½ºpprox;æª¹qq;æªµim;æ¨iÃ­à»meÄ;sâ¾àº®æ²ÆEasâ½¸â¾â½ºÃ°â½µÆdfpà»¬â¾â¾¯Æalsâ¾ â¾¥â¾ªlar;æ®ine;æurf;æÄ;tà»»â¾´Ã¯à»»rel;æ°Äciâ¿â¿r;ìð;äncsp;æÌfiopsuâ¿â¢â¿â¿¥â¿«â¿±r;ìð®pf;ìð¢rime;æcr;ìðÆaeoâ¿¸ããtÄeiâ¿¾ãrnionÃ³Ú°nt;æ¨stÄ;eããä¿Ã±á¼Ã´à¼àªABHabcdefhilmnoprstuxããããã ãã«ãã¢ã²ãããã¤ã©ãã®ã²ãã°ã·ÆartãããrÃ²á³Ã²Ïail;æ¤arÃ²á±¥ar;æ¥¤Îcdenqrtã¨ãµã¸ã¿ãããÄeuã­ã±;ìâ½Ì±te;äiÃ£á®mptyv;æ¦³gÈ;delà¿ããã;æ¦;æ¦¥Ã¥à¿uoè»Â»ä»rÖ;abcfhlpstwà¿ã¬ã¯ã·ã¹ã¼ã¾ããããp;æ¥µÄ;fà¿ ã´s;æ¤ ;æ¤³s;æ¤Ã«âÃ°â®l;æ¥im;æ¥´l;æ£;æÄaiããil;æ¤oÄ;nããæ¶alÃ³à¼Æabrã§ãªã®rÃ²á¥rk;æ³Äakã³ã½cÄekã¹ã»;ä½;äÄesãã;æ¦lÄduãã;æ¦;æ¦Èaeuyããã§ã©ron;äÄdiã¡ã¥il;äÃ¬à¿²Ã¢ãº;äÈclqsã´ã·ã½ãa;æ¤·dhar;æ¥©uoÄ;rÈÈh;æ³Æacgããà½lÈ;ipsà½¸ããánÃ¥á»arÃ´à¾©t;æ­Æilrã©á£ã®sht;æ¥½;ìð¯Äaoã·ãrÄduã½ã¿Â»Ñ»Ä;láã;æ¥¬Ä;vããä;ä±Ægnsãã¹ã¼htÌahlrstã¤ã°ããã¤ã®rrowÄ;tà¿ã­aÃ©ãarpoonÄduã»ã¿owÃ®ã¾pÂ»áeftÄahããrrowÃ³à¿ªarpoonÃ³Õightarrows;æquigarroÃ·ãhreetimes;æg;äingdotseÃ±á¼²ÆahmãããrÃ²à¿ªaÃ²Õ;æoustÄ;aããæ±cheÂ»ãmid;æ«®Èabptã²ã½ããÄnrã·ãºg;æ­r;æ¾rÃ«áÆaflãããr;æ¦;ìð£us;æ¨®imes;æ¨µÄapãã§rÄ;gã£ã¤ä©t;æ¦olint;æ¨arÃ²ã£Èachqã»ãá¼ãquo;æºr;ìðÄbuã»ãoÄ;rÈÈÆhirããã reÃ¥ã¸mes;æiÈ;eflãªáá ¡ã«æ¹tri;æ§luhar;æ¥¨;æàµ¡ãããã¬ã¸ã±\0ãºã¤\0\0ã¬ã°\0ã¨ããã­ã±ãã±\0ã\0\0ã³cute;äquÃ¯âºÔ;Eaceinpsyá­ã³ãµã¿ããããã¦ã©;æª´Ç°ãº\0ã¼;æª¸on;ä¡uÃ¥á¾Ä;dá³ãil;ärc;äÆEasããã;æª¶p;æªºim;æ©olint;æ¨iÃ­á;äotÆ;beã´áµãµæ;æ©¦ÎAacmstxãããããã£ã­rr;ærÄhrããÃ«â¨Ä;oà¨¶à¨´tè»Â§ä§i;ä»war;æ¤©mÄinã©Ã°nuÃ³Ã±t;æ¶rÄ;oã¶âìð°Èacoyãããã rp;æ¯Ähyããcy;ä;ärtÉ­ã\0\0ãiÃ¤á¤araÃ¬â¹¯è»Â­ä­Ägmã¨ã´maÆ;fvã±ã²ã²ä;äÐ;deglnprá«ãããããã¡ã¦ot;æ©ªÄ;qá±á°Ä;Eããæª;æª Ä;Eããæª;æªe;ælus;æ¨¤arr;æ¥²arÃ²á½Èaeitã¸ãããÄlsã½ãlsetmÃ©ãªhp;æ¨³parsl;æ§¤Ädlá£ãe;æ£Ä;eããæªªÄ;sã¢ã£æª¬;ìâª¬ï¸Æflpã®ã³ãtcy;äÄ;bã¸ã¹ä¯Ä;aã¾ã¿æ§r;æ¿f;ìð¤aÄdrãÐesÄ;uããæ itÂ»ãÆcsuã ã¹ãÄauã¥ã¯pÄ;sáã«;ìâï¸pÄ;sá´ãµ;ìâï¸uÄbpã¿ãÆ;esááãetÄ;eáãÃ±áÆ;esá¨á­ãetÄ;eá¨ãÃ±á®Æ;afá»ã¦Ö°rÅ¥ã«Ö±Â»á¼arÃ²áÈcemtã¹ã¾ããr;ìðtmÃ®Ã±iÃ¬ãarÃ¦á¾ÄarããrÄ;fãá¿æÄanãã­ightÄepã£ãªpsiloÃ®á» hÃ©âº¯sÂ»â¡Êbcmnpã»ãáããÒ;Edemnprsãããããã£ã¬ã±ã¶æ;æ«ot;æª½Ä;dáãot;æ«ult;æ«ÄEeã¨ãª;æ«;ælus;æª¿arr;æ¥¹Æeiuã½ããtÆ;enãããqÄ;qáãeqÄ;qã«ã¨m;æ«Äbpãã;æ«;æ«cÌ;acensá­ã¬ã²ã¹ã»ã¦pproÃ¸ãºurlyeÃ±á¾Ã±á³ÆaesãããpproÃ¸ãqÃ±ãg;æªÚ123;Edehlmnpsã©ã¬ã¯áã²ã´ãããããã¨ã­è»Â¹ä¹è»Â²ä²è»Â³ä³;æ«Äosã¹ã¼t;æª¾ub;æ«Ä;dá¢ãot;æ«sÄouããl;æb;æ«arr;æ¥»ult;æ«ÄEeã¤ã¦;æ«;ælus;æ«Æeiuã´ããtÆ;enáã¼ãqÄ;qá¢ã²eqÄ;qã§ã¤m;æ«Äbpãã;æ«;æ«ÆAanãã ã­rr;ærÄhrã¦ã¨Ã«â®Ä;oà¨«à¨©war;æ¤ªligè»Ãäà¯¡ããã áã³ã¹\0ã¾ã\0\0\0\0\0ãã\0ãã¬\0\0\0ãÉ²ã\0\0ãget;æ;ärÃ«à¹Æaeyã¦ã«ã°ron;ä¥dil;ä£;älrec;ær;ìð±Èeikoãããµã¼Ç²ã\0ãeÄ4fááaÆ;svãããä¸ym;äÄcnã¢ã²kÄasã¨ã®pproÃ¸áimÂ»á¬sÃ°áÄasãºã®Ã°árnè»Ã¾ä¾Ç¬Ìãâ§esèÃ;bdãããäÄ;aá¤ãr;æ¨±;æ¨°Æepsã¡ã£ãÃ¡â©È;bcfÒã¬ã°ã´ot;æ¶ir;æ«±Ä;oã¹ã¼ìð¥rk;æ«Ã¡ã¢rime;æ´Æaipããã¤dÃ¥áÎadempstã¡ããããããngleÊ;dlqrã°ã±ã¶ããæµownÂ»á¶»eftÄ;eâ ã¾Ã±à¤®;æightÄ;eãªãÃ±áot;æ¬inus;æ¨ºlus;æ¨¹b;æ§ime;æ¨»ezium;æ¢Æchtã²ã½ãÄryã·ã»;ìð;äcy;ärok;ä§ÄioããxÃ´á·headÄlrãã eftarroÃ·à¡ightarrowÂ»à½à¤AHabcdfghlmoprstuwãããã¤ã°ã¼ã ã ã £ã ´ã¡ã¡ã¡«ã¢©ã£ã£ã£ªã£¶rÃ²Ï­ar;æ¥£Äcrãã¢uteè»ÃºäºÃ²árÇ£ãª\0ã­y;äve;ä­Äiyãµãºrcè»Ã»ä»;äÆabhã ã ã rÃ²á­lac;ä±aÃ²áÄirã ã sht;æ¥¾;ìð²raveè»Ã¹ä¹Å¡ã §ã ±rÄlrã ¬ã ®Â»à¥Â»álk;æÄctã ¹ã¡É¯ã ¿\0\0ã¡rnÄ;eã¡ã¡ærÂ»ã¡op;æri;æ¸Äalã¡ã¡cr;ä«è»Â¨ÍÄgpã¡¢ã¡¦on;ä³f;ìð¦Ìadhlsuáã¡¸ã¡½á²ã¢ã¢ ownÃ¡á³arpoonÄlrã¢ã¢efÃ´ã ­ighÃ´ã ¯iÆ;hlã¢ã¢ã¢äÂ»áºonÂ»ã¢parrows;æÆcitã¢°ã£ã£É¯ã¢¶\0\0ã£rnÄ;eã¢¼ã¢½ærÂ»ã¢½op;æng;ä¯ri;æ¹cr;ìðÆdirã£ã£ã£¢ot;æ°lde;ä©iÄ;fã°ã£¨Â»á Äamã£¯ã£²rÃ²ã¢¨lè»Ã¼ä¼angle;æ¦§ÞABDacdeflnoprszã¤ã¤ã¤©ã¤­ã¦µã¦¸ã¦½ã§ã§¤ã§¨ã§³ã§¹ã§½ã¨ã¨ rÃ²Ï·arÄ;vã¤¦ã¤§æ«¨;æ«©asÃ¨Ï¡Änrã¤²ã¤·grt;æ¦Îeknprstã£ã¥ã¥ã¥ã¥ã¥¤ã¦appÃ¡âothinÃ§áºÆhirã«â»ã¥opÃ´â¾µÄ;há·ã¥¢Ã¯ãÄiuã¥©ã¥­gmÃ¡ã³Äbpã¥²ã¦setneqÄ;qã¥½ã¦ìâï¸;ìâ«ï¸setneqÄ;qã¦ã¦ìâï¸;ìâ«ï¸Ährã¦ã¦etÃ¡ãiangleÄlrã¦ªã¦¯eftÂ»à¤¥ightÂ»áy;ä²ashÂ»á¶Æelrã§ã§ã§Æ;beâ·ªã§ã§ar;æ»q;ælip;æ®Äbtã§á¨aÃ²á©r;ìð³trÃ©ã¦®suÄbpã§¯ã§±Â»à´Â»àµpf;ìð§roÃ°à»»trÃ©ã¦´Äcuã¨ã¨r;ìðÄbpã¨ã¨nÄEeã¦ã¨Â»ã¥¾nÄEeã¦ã¨Â»ã¦igzag;æ¦Îcefoprsã¨¶ã¨»ã©ã©ã©ã©¡ã©ªirc;äµÄdiã©ã©Äbgã©ã©ar;æ©eÄ;qáºã©;æerp;ær;ìð´pf;ìð¨Ä;eá¹ã©¦atÃ¨á¹cr;ìðà«£áãª\0ãª\0ãªãª\0\0ãªãª¨ãª«ãª¯\0\0ã«ã«\0ã«áátrÃ©ár;ìðµÄAaãªãªrÃ²ÏrÃ²à§¶;ä¾ÄAaãª¡ãª¤rÃ²Î¸rÃ²à§«aÃ°âis;æ»Ædptá¤ãªµãª¾Äflãªºá©;ìð©imÃ¥á²ÄAaã«ã«rÃ²ÏrÃ²à¨Äcqã«á¸r;ìðÄptáã«rÃ©áÐacefiosuã«°ã«½ã¬ã¬ã¬ã¬ã¬ã¬¡cÄuyã«¶ã«»teè»Ã½ä½;äÄiyã¬ã¬rc;ä·;änè»Â¥ä¥r;ìð¶cy;äpf;ìðªcr;ìðÄcmã¬¦ã¬©y;älè»Ã¿ä¿Ôacdefhioswã­ã­ã­ã­ã­¤ã­©ã­­ã­´ã­ºã®cute;äºÄayã­ã­ron;ä¾;ä·ot;ä¼Äetã­ã­¡trÃ¦áa;ä¶r;ìð·cy;ä¶grarr;æpf;ìð«cr;ìðÄjnã®ã®;æj;æ'.split("").map(e=>e.charCodeAt(0))),__=new Uint16Array("Èaglq\tÉ­\0\0p;ä¦os;ä§t;ä¾t;ä¼uot;ä¢".split("").map(e=>e.charCodeAt(0)));var S_;const E_=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),M_=null!==(S_=String.fromCodePoint)&&void 0!==S_?S_:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),t+=String.fromCharCode(e),t};var A_,D_;(D_=A_||(A_={}))[D_.NUM=35]="NUM",D_[D_.SEMI=59]="SEMI",D_[D_.EQUALS=61]="EQUALS",D_[D_.ZERO=48]="ZERO",D_[D_.NINE=57]="NINE",D_[D_.LOWER_A=97]="LOWER_A",D_[D_.LOWER_F=102]="LOWER_F",D_[D_.LOWER_X=120]="LOWER_X",D_[D_.LOWER_Z=122]="LOWER_Z",D_[D_.UPPER_A=65]="UPPER_A",D_[D_.UPPER_F=70]="UPPER_F",D_[D_.UPPER_Z=90]="UPPER_Z";var T_,O_,N_,P_,z_,I_;function L_(e){return e>=A_.ZERO&&e<=A_.NINE}function $_(e){return e>=A_.UPPER_A&&e<=A_.UPPER_F||e>=A_.LOWER_A&&e<=A_.LOWER_F}function R_(e){return e===A_.EQUALS||function(e){return e>=A_.UPPER_A&&e<=A_.UPPER_Z||e>=A_.LOWER_A&&e<=A_.LOWER_Z||L_(e)}(e)}(O_=T_||(T_={}))[O_.VALUE_LENGTH=49152]="VALUE_LENGTH",O_[O_.BRANCH_LENGTH=16256]="BRANCH_LENGTH",O_[O_.JUMP_TABLE=127]="JUMP_TABLE",(P_=N_||(N_={}))[P_.EntityStart=0]="EntityStart",P_[P_.NumericStart=1]="NumericStart",P_[P_.NumericDecimal=2]="NumericDecimal",P_[P_.NumericHex=3]="NumericHex",P_[P_.NamedEntity=4]="NamedEntity",(I_=z_||(z_={}))[I_.Legacy=0]="Legacy",I_[I_.Strict=1]="Strict",I_[I_.Attribute=2]="Attribute";class F_{constructor(e,t,n){this.decodeTree=e,this.emitCodePoint=t,this.errors=n,this.state=N_.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=z_.Strict}startEntity(e){this.decodeMode=e,this.state=N_.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case N_.EntityStart:return e.charCodeAt(t)===A_.NUM?(this.state=N_.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=N_.NamedEntity,this.stateNamedEntity(e,t));case N_.NumericStart:return this.stateNumericStart(e,t);case N_.NumericDecimal:return this.stateNumericDecimal(e,t);case N_.NumericHex:return this.stateNumericHex(e,t);case N_.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(32|e.charCodeAt(t))===A_.LOWER_X?(this.state=N_.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=N_.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,n,r){if(t!==n){const o=n-t;this.result=this.result*Math.pow(r,o)+parseInt(e.substr(t,o),r),this.consumed+=o}}stateNumericHex(e,t){const n=t;for(;t<e.length;){const r=e.charCodeAt(t);if(!L_(r)&&!$_(r))return this.addToNumericResult(e,n,t,16),this.emitNumericEntity(r,3);t+=1}return this.addToNumericResult(e,n,t,16),-1}stateNumericDecimal(e,t){const n=t;for(;t<e.length;){const r=e.charCodeAt(t);if(!L_(r))return this.addToNumericResult(e,n,t,10),this.emitNumericEntity(r,2);t+=1}return this.addToNumericResult(e,n,t,10),-1}emitNumericEntity(e,t){var n;if(this.consumed<=t)return null===(n=this.errors)||void 0===n||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===A_.SEMI)this.consumed+=1;else if(this.decodeMode===z_.Strict)return 0;return this.emitCodePoint(function(e){var t;return e>=55296&&e<=57343||e>1114111?65533:null!==(t=E_.get(e))&&void 0!==t?t:e}(this.result),this.consumed),this.errors&&(e!==A_.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:n}=this;let r=n[this.treeIndex],o=(r&T_.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const i=e.charCodeAt(t);if(this.treeIndex=V_(n,r,this.treeIndex+Math.max(1,o),i),this.treeIndex<0)return 0===this.result||this.decodeMode===z_.Attribute&&(0===o||R_(i))?0:this.emitNotTerminatedNamedEntity();if(r=n[this.treeIndex],o=(r&T_.VALUE_LENGTH)>>14,0!==o){if(i===A_.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==z_.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:n}=this,r=(n[t]&T_.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,r,this.consumed),null===(e=this.errors)||void 0===e||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,n){const{decodeTree:r}=this;return this.emitCodePoint(1===t?r[e]&~T_.VALUE_LENGTH:r[e+1],n),3===t&&this.emitCodePoint(r[e+2],n),n}end(){var e;switch(this.state){case N_.NamedEntity:return 0===this.result||this.decodeMode===z_.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case N_.NumericDecimal:return this.emitNumericEntity(0,2);case N_.NumericHex:return this.emitNumericEntity(0,3);case N_.NumericStart:return null===(e=this.errors)||void 0===e||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case N_.EntityStart:return 0}}}function B_(e){let t="";const n=new F_(e,e=>t+=M_(e));return function(e,r){let o=0,i=0;for(;(i=e.indexOf("&",i))>=0;){t+=e.slice(o,i),n.startEntity(r);const s=n.write(e,i+1);if(s<0){o=i+n.end();break}o=i+s,i=0===s?o+1:o}const s=t+e.slice(o);return t="",s}}function V_(e,t,n,r){const o=(t&T_.BRANCH_LENGTH)>>7,i=t&T_.JUMP_TABLE;if(0===o)return 0!==i&&r===i?n:-1;if(i){const t=r-i;return t<0||t>=o?-1:e[n+t]-1}let s=n,a=s+o-1;for(;s<=a;){const t=s+a>>>1,n=e[t];if(n<r)s=t+1;else{if(!(n>r))return e[t+o];a=t-1}}return-1}const H_=B_(C_);function j_(e,t=z_.Legacy){return H_(e,t)}function q_(e){return"[object String]"===function(e){return Object.prototype.toString.call(e)}(e)}B_(__);const K_=Object.prototype.hasOwnProperty;function W_(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t){if("object"!=typeof t)throw new TypeError(t+"must be object");Object.keys(t).forEach(function(n){e[n]=t[n]})}}),e}function Z_(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function U_(e){return!(e>=55296&&e<=57343)&&(!(e>=64976&&e<=65007)&&(!!(65535&~e&&65534!=(65535&e))&&(!(e>=0&&e<=8)&&(11!==e&&(!(e>=14&&e<=31)&&(!(e>=127&&e<=159)&&!(e>1114111)))))))}function J_(e){if(e>65535){const t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const G_=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,X_=new RegExp(G_.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),Y_=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function Q_(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(X_,function(e,t,n){return t||function(e,t){if(35===t.charCodeAt(0)&&Y_.test(t)){const n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return U_(n)?J_(n):e}const n=j_(e);return n!==e?n:e}(e,n)})}const eS=/[&<>"]/,tS=/[&<>"]/g,nS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function rS(e){return nS[e]}function oS(e){return eS.test(e)?e.replace(tS,rS):e}const iS=/[.?*+^$[\]\\(){}|-]/g;function sS(e){switch(e){case 9:case 32:return!0}return!1}function aS(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function lS(e){return k_.test(e)||b_.test(e)}function cS(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function uS(e){return e=e.trim().replace(/\s+/g," "),"á¹¾"==="áº".toLowerCase()&&(e=e.replace(/áº/g,"Ã")),e.toLowerCase().toUpperCase()}const dS={mdurl:g_,ucmicro:x_},hS=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:Z_,assign:W_,escapeHtml:oS,escapeRE:function(e){return e.replace(iS,"\\$&")},fromCodePoint:J_,has:function(e,t){return K_.call(e,t)},isMdAsciiPunct:cS,isPunctChar:lS,isSpace:sS,isString:q_,isValidEntityCode:U_,isWhiteSpace:aS,lib:dS,normalizeReference:uS,unescapeAll:Q_,unescapeMd:function(e){return e.indexOf("\\")<0?e:e.replace(G_,"$1")}},Symbol.toStringTag,{value:"Module"}));const pS=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:function(e,t,n){let r,o=t;const i={ok:!1,pos:0,str:""};if(60===e.charCodeAt(o)){for(o++;o<n;){if(r=e.charCodeAt(o),10===r)return i;if(60===r)return i;if(62===r)return i.pos=o+1,i.str=Q_(e.slice(t+1,o)),i.ok=!0,i;92===r&&o+1<n?o+=2:o++}return i}let s=0;for(;o<n&&(r=e.charCodeAt(o),32!==r)&&!(r<32||127===r);)if(92===r&&o+1<n){if(32===e.charCodeAt(o+1))break;o+=2}else{if(40===r&&(s++,s>32))return i;if(41===r){if(0===s)break;s--}o++}return t===o||0!==s||(i.str=Q_(e.slice(t,o)),i.pos=o,i.ok=!0),i},parseLinkLabel:function(e,t,n){let r,o,i,s;const a=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<a;){if(i=e.src.charCodeAt(e.pos),93===i&&(r--,0===r)){o=!0;break}if(s=e.pos,e.md.inline.skipToken(e),91===i)if(s===e.pos-1)r++;else if(n)return e.pos=l,-1}let c=-1;return o&&(c=e.pos),e.pos=l,c},parseLinkTitle:function(e,t,n,r){let o,i=t;const s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(i>=n)return s;let r=e.charCodeAt(i);if(34!==r&&39!==r&&40!==r)return s;t++,i++,40===r&&(r=41),s.marker=r}for(;i<n;){if(o=e.charCodeAt(i),o===s.marker)return s.pos=i+1,s.str+=Q_(e.slice(t,i)),s.ok=!0,s;if(40===o&&41===s.marker)return s;92===o&&i+1<n&&i++,i++}return s.can_continue=!0,s.str+=Q_(e.slice(t,i)),s}},Symbol.toStringTag,{value:"Module"})),fS={};function mS(){this.rules=W_({},fS)}function gS(){this.__rules__=[],this.__cache__=null}function yS(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}function vS(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}fS.code_inline=function(e,t,n,r,o){const i=e[t];return"<code"+o.renderAttrs(i)+">"+oS(i.content)+"</code>"},fS.code_block=function(e,t,n,r,o){const i=e[t];return"<pre"+o.renderAttrs(i)+"><code>"+oS(e[t].content)+"</code></pre>\n"},fS.fence=function(e,t,n,r,o){const i=e[t],s=i.info?Q_(i.info).trim():"";let a,l="",c="";if(s){const e=s.split(/(\s+)/g);l=e[0],c=e.slice(2).join("")}if(a=n.highlight&&n.highlight(i.content,l,c)||oS(i.content),0===a.indexOf("<pre"))return a+"\n";if(s){const e=i.attrIndex("class"),t=i.attrs?i.attrs.slice():[];e<0?t.push(["class",n.langPrefix+l]):(t[e]=t[e].slice(),t[e][1]+=" "+n.langPrefix+l);const r={attrs:t};return`<pre><code${o.renderAttrs(r)}>${a}</code></pre>\n`}return`<pre><code${o.renderAttrs(i)}>${a}</code></pre>\n`},fS.image=function(e,t,n,r,o){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=o.renderInlineAsText(i.children,n,r),o.renderToken(e,t,n)},fS.hardbreak=function(e,t,n){return n.xhtmlOut?"<br />\n":"<br>\n"},fS.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},fS.text=function(e,t){return oS(e[t].content)},fS.html_block=function(e,t){return e[t].content},fS.html_inline=function(e,t){return e[t].content},mS.prototype.renderAttrs=function(e){let t,n,r;if(!e.attrs)return"";for(r="",t=0,n=e.attrs.length;t<n;t++)r+=" "+oS(e.attrs[t][0])+'="'+oS(e.attrs[t][1])+'"';return r},mS.prototype.renderToken=function(e,t,n){const r=e[t];let o="";if(r.hidden)return"";r.block&&-1!==r.nesting&&t&&e[t-1].hidden&&(o+="\n"),o+=(-1===r.nesting?"</":"<")+r.tag,o+=this.renderAttrs(r),0===r.nesting&&n.xhtmlOut&&(o+=" /");let i=!1;if(r.block&&(i=!0,1===r.nesting&&t+1<e.length)){const n=e[t+1];("inline"===n.type||n.hidden||-1===n.nesting&&n.tag===r.tag)&&(i=!1)}return o+=i?">\n":">",o},mS.prototype.renderInline=function(e,t,n){let r="";const o=this.rules;for(let i=0,s=e.length;i<s;i++){const s=e[i].type;void 0!==o[s]?r+=o[s](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r},mS.prototype.renderInlineAsText=function(e,t,n){let r="";for(let o=0,i=e.length;o<i;o++)switch(e[o].type){case"text":case"html_inline":case"html_block":r+=e[o].content;break;case"image":r+=this.renderInlineAsText(e[o].children,t,n);break;case"softbreak":case"hardbreak":r+="\n"}return r},mS.prototype.render=function(e,t,n){let r="";const o=this.rules;for(let i=0,s=e.length;i<s;i++){const s=e[i].type;"inline"===s?r+=this.renderInline(e[i].children,t,n):void 0!==o[s]?r+=o[s](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r},gS.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1},gS.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(e){e.enabled&&e.alt.forEach(function(e){t.indexOf(e)<0&&t.push(e)})}),e.__cache__={},t.forEach(function(t){e.__cache__[t]=[],e.__rules__.forEach(function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))})})},gS.prototype.at=function(e,t,n){const r=this.__find__(e),o=n||{};if(-1===r)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=o.alt||[],this.__cache__=null},gS.prototype.before=function(e,t,n,r){const o=this.__find__(e),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+e);this.__rules__.splice(o,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},gS.prototype.after=function(e,t,n,r){const o=this.__find__(e),i=r||{};if(-1===o)throw new Error("Parser rule not found: "+e);this.__rules__.splice(o+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},gS.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null},gS.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(e){const r=this.__find__(e);if(r<0){if(t)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[r].enabled=!0,n.push(e)},this),this.__cache__=null,n},gS.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(e){e.enabled=!1}),this.enable(e,t)},gS.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(e){const r=this.__find__(e);if(r<0){if(t)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[r].enabled=!1,n.push(e)},this),this.__cache__=null,n},gS.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},yS.prototype.attrIndex=function(e){if(!this.attrs)return-1;const t=this.attrs;for(let n=0,r=t.length;n<r;n++)if(t[n][0]===e)return n;return-1},yS.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]},yS.prototype.attrSet=function(e,t){const n=this.attrIndex(e),r=[e,t];n<0?this.attrPush(r):this.attrs[n]=r},yS.prototype.attrGet=function(e){const t=this.attrIndex(e);let n=null;return t>=0&&(n=this.attrs[t][1]),n},yS.prototype.attrJoin=function(e,t){const n=this.attrIndex(e);n<0?this.attrPush([e,t]):this.attrs[n][1]=this.attrs[n][1]+" "+t},vS.prototype.Token=yS;const kS=/\r\n?|\n/g,bS=/\0/g;function wS(e){return/^<a[>\s]/i.test(e)}function xS(e){return/^<\/a\s*>/i.test(e)}const CS=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,_S=/\((c|tm|r)\)/i,SS=/\((c|tm|r)\)/gi,ES={c:"Â©",r:"Â®",tm:"â¢"};function MS(e,t){return ES[t.toLowerCase()]}function AS(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];"text"!==r.type||t||(r.content=r.content.replace(SS,MS)),"link_open"===r.type&&"auto"===r.info&&t--,"link_close"===r.type&&"auto"===r.info&&t++}}function DS(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];"text"!==r.type||t||CS.test(r.content)&&(r.content=r.content.replace(/\+-/g,"Â±").replace(/\.{2,}/g,"â¦").replace(/([?!])â¦/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1â").replace(/(^|\s)--(?=\s|$)/gm,"$1â").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1â")),"link_open"===r.type&&"auto"===r.info&&t--,"link_close"===r.type&&"auto"===r.info&&t++}}const TS=/['"]/,OS=/['"]/g;function NS(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function PS(e,t){let n;const r=[];for(let o=0;o<e.length;o++){const i=e[o],s=e[o].level;for(n=r.length-1;n>=0&&!(r[n].level<=s);n--);if(r.length=n+1,"text"!==i.type)continue;let a=i.content,l=0,c=a.length;e:for(;l<c;){OS.lastIndex=l;const u=OS.exec(a);if(!u)break;let d=!0,h=!0;l=u.index+1;const p="'"===u[0];let f=32;if(u.index-1>=0)f=a.charCodeAt(u.index-1);else for(n=o-1;n>=0&&("softbreak"!==e[n].type&&"hardbreak"!==e[n].type);n--)if(e[n].content){f=e[n].content.charCodeAt(e[n].content.length-1);break}let m=32;if(l<c)m=a.charCodeAt(l);else for(n=o+1;n<e.length&&("softbreak"!==e[n].type&&"hardbreak"!==e[n].type);n++)if(e[n].content){m=e[n].content.charCodeAt(0);break}const g=cS(f)||lS(String.fromCharCode(f)),y=cS(m)||lS(String.fromCharCode(m)),v=aS(f),k=aS(m);if(k?d=!1:y&&(v||g||(d=!1)),v?h=!1:g&&(k||y||(h=!1)),34===m&&'"'===u[0]&&f>=48&&f<=57&&(h=d=!1),d&&h&&(d=g,h=y),d||h){if(h)for(n=r.length-1;n>=0;n--){let d=r[n];if(r[n].level<s)break;if(d.single===p&&r[n].level===s){let s,h;d=r[n],p?(s=t.md.options.quotes[2],h=t.md.options.quotes[3]):(s=t.md.options.quotes[0],h=t.md.options.quotes[1]),i.content=NS(i.content,u.index,h),e[d.token].content=NS(e[d.token].content,d.pos,s),l+=h.length-1,d.token===o&&(l+=s.length-1),a=i.content,c=a.length,r.length=n;continue e}}d?r.push({token:o,pos:u.index,single:p,level:s}):h&&p&&(i.content=NS(i.content,u.index,"â"))}else p&&(i.content=NS(i.content,u.index,"â"))}}}const zS=[["normalize",function(e){let t;t=e.src.replace(kS,"\n"),t=t.replace(bS,"ï¿½"),e.src=t}],["block",function(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}],["inline",function(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const r=t[n];"inline"===r.type&&e.md.inline.parse(r.content,e.md,e.env,r.children)}}],["linkify",function(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if("inline"!==t[n].type||!e.md.linkify.pretest(t[n].content))continue;let r=t[n].children,o=0;for(let i=r.length-1;i>=0;i--){const s=r[i];if("link_close"!==s.type){if("html_inline"===s.type&&(wS(s.content)&&o>0&&o--,xS(s.content)&&o++),!(o>0)&&"text"===s.type&&e.md.linkify.test(s.content)){const o=s.content;let a=e.md.linkify.match(o);const l=[];let c=s.level,u=0;a.length>0&&0===a[0].index&&i>0&&"text_special"===r[i-1].type&&(a=a.slice(1));for(let t=0;t<a.length;t++){const n=a[t].url,r=e.md.normalizeLink(n);if(!e.md.validateLink(r))continue;let i=a[t].text;i=a[t].schema?"mailto:"!==a[t].schema||/^mailto:/i.test(i)?e.md.normalizeLinkText(i):e.md.normalizeLinkText("mailto:"+i).replace(/^mailto:/,""):e.md.normalizeLinkText("http://"+i).replace(/^http:\/\//,"");const s=a[t].index;if(s>u){const t=new e.Token("text","",0);t.content=o.slice(u,s),t.level=c,l.push(t)}const d=new e.Token("link_open","a",1);d.attrs=[["href",r]],d.level=c++,d.markup="linkify",d.info="auto",l.push(d);const h=new e.Token("text","",0);h.content=i,h.level=c,l.push(h);const p=new e.Token("link_close","a",-1);p.level=--c,p.markup="linkify",p.info="auto",l.push(p),u=a[t].lastIndex}if(u<o.length){const t=new e.Token("text","",0);t.content=o.slice(u),t.level=c,l.push(t)}t[n].children=r=Z_(r,i,l)}}else for(i--;r[i].level!==s.level&&"link_open"!==r[i].type;)i--}}}],["replacements",function(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)"inline"===e.tokens[t].type&&(_S.test(e.tokens[t].content)&&AS(e.tokens[t].children),CS.test(e.tokens[t].content)&&DS(e.tokens[t].children))}],["smartquotes",function(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)"inline"===e.tokens[t].type&&TS.test(e.tokens[t].content)&&PS(e.tokens[t].children,e)}],["text_join",function(e){let t,n;const r=e.tokens,o=r.length;for(let i=0;i<o;i++){if("inline"!==r[i].type)continue;const e=r[i].children,o=e.length;for(t=0;t<o;t++)"text_special"===e[t].type&&(e[t].type="text");for(t=n=0;t<o;t++)"text"===e[t].type&&t+1<o&&"text"===e[t+1].type?e[t+1].content=e[t].content+e[t+1].content:(t!==n&&(e[n]=e[t]),n++);t!==n&&(e.length=n)}}]];function IS(){this.ruler=new gS;for(let e=0;e<zS.length;e++)this.ruler.push(zS[e][0],zS[e][1])}function LS(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const o=this.src;for(let i=0,s=0,a=0,l=0,c=o.length,u=!1;s<c;s++){const e=o.charCodeAt(s);if(!u){if(sS(e)){a++,9===e?l+=4-l%4:l++;continue}u=!0}10!==e&&s!==c-1||(10!==e&&s++,this.bMarks.push(i),this.eMarks.push(s),this.tShift.push(a),this.sCount.push(l),this.bsCount.push(0),u=!1,a=0,l=0,i=s+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}IS.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)},IS.prototype.State=vS,LS.prototype.push=function(e,t,n){const r=new yS(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r},LS.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},LS.prototype.skipEmptyLines=function(e){for(let t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},LS.prototype.skipSpaces=function(e){for(let t=this.src.length;e<t;e++){if(!sS(this.src.charCodeAt(e)))break}return e},LS.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!sS(this.src.charCodeAt(--e)))return e+1;return e},LS.prototype.skipChars=function(e,t){for(let n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},LS.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},LS.prototype.getLines=function(e,t,n,r){if(e>=t)return"";const o=new Array(t-e);for(let i=0,s=e;s<t;s++,i++){let e=0;const a=this.bMarks[s];let l,c=a;for(l=s+1<t||r?this.eMarks[s]+1:this.eMarks[s];c<l&&e<n;){const t=this.src.charCodeAt(c);if(sS(t))9===t?e+=4-(e+this.bsCount[s])%4:e++;else{if(!(c-a<this.tShift[s]))break;e++}c++}o[i]=e>n?new Array(e-n+1).join(" ")+this.src.slice(c,l):this.src.slice(c,l)}return o.join("")},LS.prototype.Token=yS;function $S(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function RS(e){const t=[],n=e.length;let r=0,o=e.charCodeAt(r),i=!1,s=0,a="";for(;r<n;)124===o&&(i?(a+=e.substring(s,r-1),s=r):(t.push(a+e.substring(s,r)),a="",s=r+1)),i=92===o,r++,o=e.charCodeAt(r);return t.push(a+e.substring(s)),t}function FS(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const o=e.src.charCodeAt(r++);if(42!==o&&45!==o&&43!==o)return-1;if(r<n){if(!sS(e.src.charCodeAt(r)))return-1}return r}function BS(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let o=n;if(o+1>=r)return-1;let i=e.src.charCodeAt(o++);if(i<48||i>57)return-1;for(;;){if(o>=r)return-1;if(i=e.src.charCodeAt(o++),!(i>=48&&i<=57)){if(41===i||46===i)break;return-1}if(o-n>=10)return-1}return o<r&&(i=e.src.charCodeAt(o),!sS(i))?-1:o}const VS="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",HS="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",jS=new RegExp("^(?:"+VS+"|"+HS+"|\x3c!---?>|\x3c!--(?:[^-]|-[^-]|--[^>])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Za-z][^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),qS=new RegExp("^(?:"+VS+"|"+HS+")"),KS=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"].join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(qS.source+"\\s*$"),/^$/,!1]];const WS=[["table",function(e,t,n,r){if(t+2>n)return!1;let o=t+1;if(e.sCount[o]<e.blkIndent)return!1;if(e.sCount[o]-e.blkIndent>=4)return!1;let i=e.bMarks[o]+e.tShift[o];if(i>=e.eMarks[o])return!1;const s=e.src.charCodeAt(i++);if(124!==s&&45!==s&&58!==s)return!1;if(i>=e.eMarks[o])return!1;const a=e.src.charCodeAt(i++);if(124!==a&&45!==a&&58!==a&&!sS(a))return!1;if(45===s&&sS(a))return!1;for(;i<e.eMarks[o];){const t=e.src.charCodeAt(i);if(124!==t&&45!==t&&58!==t&&!sS(t))return!1;i++}let l=$S(e,t+1),c=l.split("|");const u=[];for(let y=0;y<c.length;y++){const e=c[y].trim();if(!e){if(0===y||y===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(e))return!1;58===e.charCodeAt(e.length-1)?u.push(58===e.charCodeAt(0)?"center":"right"):58===e.charCodeAt(0)?u.push("left"):u.push("")}if(l=$S(e,t).trim(),-1===l.indexOf("|"))return!1;if(e.sCount[t]-e.blkIndent>=4)return!1;c=RS(l),c.length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop();const d=c.length;if(0===d||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const p=e.md.block.ruler.getRules("blockquote"),f=[t,0];e.push("table_open","table",1).map=f,e.push("thead_open","thead",1).map=[t,t+1],e.push("tr_open","tr",1).map=[t,t+1];for(let y=0;y<c.length;y++){const t=e.push("th_open","th",1);u[y]&&(t.attrs=[["style","text-align:"+u[y]]]);const n=e.push("inline","",0);n.content=c[y].trim(),n.children=[],e.push("th_close","th",-1)}let m;e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let g=0;for(o=t+2;o<n&&!(e.sCount[o]<e.blkIndent);o++){let r=!1;for(let t=0,i=p.length;t<i;t++)if(p[t](e,o,n,!0)){r=!0;break}if(r)break;if(l=$S(e,o).trim(),!l)break;if(e.sCount[o]-e.blkIndent>=4)break;if(c=RS(l),c.length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop(),g+=d-c.length,g>65536)break;if(o===t+2){e.push("tbody_open","tbody",1).map=m=[t+2,0]}e.push("tr_open","tr",1).map=[o,o+1];for(let t=0;t<d;t++){const n=e.push("td_open","td",1);u[t]&&(n.attrs=[["style","text-align:"+u[t]]]);const r=e.push("inline","",0);r.content=c[t]?c[t].trim():"",r.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return m&&(e.push("tbody_close","tbody",-1),m[1]=o),e.push("table_close","table",-1),f[1]=o,e.parentType=h,e.line=o,!0},["paragraph","reference"]],["code",function(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,o=r;for(;r<n;)if(e.isEmpty(r))r++;else{if(!(e.sCount[r]-e.blkIndent>=4))break;r++,o=r}e.line=o;const i=e.push("code_block","code",0);return i.content=e.getLines(t,o,4+e.blkIndent,!1)+"\n",i.map=[t,e.line],!0}],["fence",function(e,t,n,r){let o=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(o+3>i)return!1;const s=e.src.charCodeAt(o);if(126!==s&&96!==s)return!1;let a=o;o=e.skipChars(o,s);let l=o-a;if(l<3)return!1;const c=e.src.slice(a,o),u=e.src.slice(o,i);if(96===s&&u.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;(d++,!(d>=n))&&(o=a=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],!(o<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(o)===s&&!(e.sCount[d]-e.blkIndent>=4||(o=e.skipChars(o,s),o-a<l||(o=e.skipSpaces(o),o<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const p=e.push("fence","code",0);return p.info=u,p.content=e.getLines(t+1,d,l,!0),p.markup=c,p.map=[t,e.line],!0},["paragraph","reference","blockquote","list"]],["blockquote",function(e,t,n,r){let o=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const s=e.lineMax;if(e.sCount[t]-e.blkIndent>=4)return!1;if(62!==e.src.charCodeAt(o))return!1;if(r)return!0;const a=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let p,f=!1;for(p=t;p<n;p++){const t=e.sCount[p]<e.blkIndent;if(o=e.bMarks[p]+e.tShift[p],i=e.eMarks[p],o>=i)break;if(62===e.src.charCodeAt(o++)&&!t){let t,n,r=e.sCount[p]+1;32===e.src.charCodeAt(o)?(o++,r++,n=!1,t=!0):9===e.src.charCodeAt(o)?(t=!0,(e.bsCount[p]+r)%4==3?(o++,r++,n=!1):n=!0):t=!1;let s=r;for(a.push(e.bMarks[p]),e.bMarks[p]=o;o<i;){const t=e.src.charCodeAt(o);if(!sS(t))break;9===t?s+=4-(s+e.bsCount[p]+(n?1:0))%4:s++,o++}f=o>=i,l.push(e.bsCount[p]),e.bsCount[p]=e.sCount[p]+1+(t?1:0),c.push(e.sCount[p]),e.sCount[p]=s-r,u.push(e.tShift[p]),e.tShift[p]=o-e.bMarks[p];continue}if(f)break;let r=!1;for(let o=0,i=d.length;o<i;o++)if(d[o](e,p,n,!0)){r=!0;break}if(r){e.lineMax=p,0!==e.blkIndent&&(a.push(e.bMarks[p]),l.push(e.bsCount[p]),u.push(e.tShift[p]),c.push(e.sCount[p]),e.sCount[p]-=e.blkIndent);break}a.push(e.bMarks[p]),l.push(e.bsCount[p]),u.push(e.tShift[p]),c.push(e.sCount[p]),e.sCount[p]=-1}const m=e.blkIndent;e.blkIndent=0;const g=e.push("blockquote_open","blockquote",1);g.markup=">";const y=[t,0];g.map=y,e.md.block.tokenize(e,t,p),e.push("blockquote_close","blockquote",-1).markup=">",e.lineMax=s,e.parentType=h,y[1]=e.line;for(let v=0;v<u.length;v++)e.bMarks[v+t]=a[v],e.tShift[v+t]=u[v],e.sCount[v+t]=c[v],e.bsCount[v+t]=l[v];return e.blkIndent=m,!0},["paragraph","reference","blockquote","list"]],["hr",function(e,t,n,r){const o=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(i++);if(42!==s&&45!==s&&95!==s)return!1;let a=1;for(;i<o;){const t=e.src.charCodeAt(i++);if(t!==s&&!sS(t))return!1;t===s&&a++}if(a<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(a+1).join(String.fromCharCode(s)),!0},["paragraph","reference","blockquote","list"]],["list",function(e,t,n,r){let o,i,s,a,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4)return!1;if(e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u,d,h,p=!1;if(r&&"paragraph"===e.parentType&&e.sCount[l]>=e.blkIndent&&(p=!0),(h=BS(e,l))>=0){if(u=!0,s=e.bMarks[l]+e.tShift[l],d=Number(e.src.slice(s,h-1)),p&&1!==d)return!1}else{if(!((h=FS(e,l))>=0))return!1;u=!1}if(p&&e.skipSpaces(h)>=e.eMarks[l])return!1;if(r)return!0;const f=e.src.charCodeAt(h-1),m=e.tokens.length;u?(a=e.push("ordered_list_open","ol",1),1!==d&&(a.attrs=[["start",d]])):a=e.push("bullet_list_open","ul",1);const g=[l,0];a.map=g,a.markup=String.fromCharCode(f);let y=!1;const v=e.md.block.ruler.getRules("list"),k=e.parentType;for(e.parentType="list";l<n;){i=h,o=e.eMarks[l];const t=e.sCount[l]+h-(e.bMarks[l]+e.tShift[l]);let r=t;for(;i<o;){const t=e.src.charCodeAt(i);if(9===t)r+=4-(r+e.bsCount[l])%4;else{if(32!==t)break;r++}i++}const d=i;let p;p=d>=o?1:r-t,p>4&&(p=1);const m=t+p;a=e.push("list_item_open","li",1),a.markup=String.fromCharCode(f);const g=[l,0];a.map=g,u&&(a.info=e.src.slice(s,h-1));const k=e.tight,b=e.tShift[l],w=e.sCount[l],x=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=m,e.tight=!0,e.tShift[l]=d-e.bMarks[l],e.sCount[l]=r,d>=o&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),e.tight&&!y||(c=!1),y=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=x,e.tShift[l]=b,e.sCount[l]=w,e.tight=k,a=e.push("list_item_close","li",-1),a.markup=String.fromCharCode(f),l=e.line,g[1]=l,l>=n)break;if(e.sCount[l]<e.blkIndent)break;if(e.sCount[l]-e.blkIndent>=4)break;let C=!1;for(let o=0,i=v.length;o<i;o++)if(v[o](e,l,n,!0)){C=!0;break}if(C)break;if(u){if(h=BS(e,l),h<0)break;s=e.bMarks[l]+e.tShift[l]}else if(h=FS(e,l),h<0)break;if(f!==e.src.charCodeAt(h-1))break}return a=u?e.push("ordered_list_close","ol",-1):e.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(f),g[1]=l,e.line=l,e.parentType=k,c&&function(e,t){const n=e.level+2;for(let r=t+2,o=e.tokens.length-2;r<o;r++)e.tokens[r].level===n&&"paragraph_open"===e.tokens[r].type&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}(e,m),!0},["paragraph","reference","blockquote"]],["reference",function(e,t,n,r){let o=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],s=t+1;if(e.sCount[t]-e.blkIndent>=4)return!1;if(91!==e.src.charCodeAt(o))return!1;function a(t){const n=e.lineMax;if(t>=n||e.isEmpty(t))return null;let r=!1;if(e.sCount[t]-e.blkIndent>3&&(r=!0),e.sCount[t]<0&&(r=!0),!r){const r=e.md.block.ruler.getRules("reference"),o=e.parentType;e.parentType="reference";let i=!1;for(let s=0,a=r.length;s<a;s++)if(r[s](e,t,n,!0)){i=!0;break}if(e.parentType=o,i)return null}const o=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];return e.src.slice(o,i+1)}let l=e.src.slice(o,i+1);i=l.length;let c=-1;for(o=1;o<i;o++){const e=l.charCodeAt(o);if(91===e)return!1;if(93===e){c=o;break}if(10===e){const e=a(s);null!==e&&(l+=e,i=l.length,s++)}else if(92===e&&(o++,o<i&&10===l.charCodeAt(o))){const e=a(s);null!==e&&(l+=e,i=l.length,s++)}}if(c<0||58!==l.charCodeAt(c+1))return!1;for(o=c+2;o<i;o++){const e=l.charCodeAt(o);if(10===e){const e=a(s);null!==e&&(l+=e,i=l.length,s++)}else if(!sS(e))break}const u=e.md.helpers.parseLinkDestination(l,o,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;o=u.pos;const h=o,p=s,f=o;for(;o<i;o++){const e=l.charCodeAt(o);if(10===e){const e=a(s);null!==e&&(l+=e,i=l.length,s++)}else if(!sS(e))break}let m,g=e.md.helpers.parseLinkTitle(l,o,i);for(;g.can_continue;){const t=a(s);if(null===t)break;l+=t,o=i,i=l.length,s++,g=e.md.helpers.parseLinkTitle(l,o,i,g)}for(o<i&&f!==o&&g.ok?(m=g.str,o=g.pos):(m="",o=h,s=p);o<i;){if(!sS(l.charCodeAt(o)))break;o++}if(o<i&&10!==l.charCodeAt(o)&&m)for(m="",o=h,s=p;o<i;){if(!sS(l.charCodeAt(o)))break;o++}if(o<i&&10!==l.charCodeAt(o))return!1;const y=uS(l.slice(1,c));return!!y&&(r||(void 0===e.env.references&&(e.env.references={}),void 0===e.env.references[y]&&(e.env.references[y]={title:m,href:d}),e.line=s),!0)}],["html_block",function(e,t,n,r){let o=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(!e.md.options.html)return!1;if(60!==e.src.charCodeAt(o))return!1;let s=e.src.slice(o,i),a=0;for(;a<KS.length&&!KS[a][0].test(s);a++);if(a===KS.length)return!1;if(r)return KS[a][2];let l=t+1;if(!KS[a][1].test(s))for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(o=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],s=e.src.slice(o,i),KS[a][1].test(s)){0!==s.length&&l++;break}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0},["paragraph","reference","blockquote"]],["heading",function(e,t,n,r){let o=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let s=e.src.charCodeAt(o);if(35!==s||o>=i)return!1;let a=1;for(s=e.src.charCodeAt(++o);35===s&&o<i&&a<=6;)a++,s=e.src.charCodeAt(++o);if(a>6||o<i&&!sS(s))return!1;if(r)return!0;i=e.skipSpacesBack(i,o);const l=e.skipCharsBack(i,35,o);l>o&&sS(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(a),1);c.markup="########".slice(0,a),c.map=[t,e.line];const u=e.push("inline","",0);return u.content=e.src.slice(o,i).trim(),u.map=[t,e.line],u.children=[],e.push("heading_close","h"+String(a),-1).markup="########".slice(0,a),!0},["paragraph","reference","blockquote"]],["lheading",function(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const o=e.parentType;e.parentType="paragraph";let i,s=0,a=t+1;for(;a<n&&!e.isEmpty(a);a++){if(e.sCount[a]-e.blkIndent>3)continue;if(e.sCount[a]>=e.blkIndent){let t=e.bMarks[a]+e.tShift[a];const n=e.eMarks[a];if(t<n&&(i=e.src.charCodeAt(t),(45===i||61===i)&&(t=e.skipChars(t,i),t=e.skipSpaces(t),t>=n))){s=61===i?1:2;break}}if(e.sCount[a]<0)continue;let t=!1;for(let o=0,i=r.length;o<i;o++)if(r[o](e,a,n,!0)){t=!0;break}if(t)break}if(!s)return!1;const l=e.getLines(t,a,e.blkIndent,!1).trim();e.line=a+1;const c=e.push("heading_open","h"+String(s),1);c.markup=String.fromCharCode(i),c.map=[t,e.line];const u=e.push("inline","",0);return u.content=l,u.map=[t,e.line-1],u.children=[],e.push("heading_close","h"+String(s),-1).markup=String.fromCharCode(i),e.parentType=o,!0}],["paragraph",function(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),o=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3)continue;if(e.sCount[i]<0)continue;let t=!1;for(let o=0,s=r.length;o<s;o++)if(r[o](e,i,n,!0)){t=!0;break}if(t)break}const s=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i,e.push("paragraph_open","p",1).map=[t,e.line];const a=e.push("inline","",0);return a.content=s,a.map=[t,e.line],a.children=[],e.push("paragraph_close","p",-1),e.parentType=o,!0}]];function ZS(){this.ruler=new gS;for(let e=0;e<WS.length;e++)this.ruler.push(WS[e][0],WS[e][1],{alt:(WS[e][2]||[]).slice()})}function US(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}function JS(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}ZS.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),o=r.length,i=e.md.options.maxNesting;let s=t,a=!1;for(;s<n&&(e.line=s=e.skipEmptyLines(s),!(s>=n))&&!(e.sCount[s]<e.blkIndent);){if(e.level>=i){e.line=n;break}const t=e.line;let l=!1;for(let i=0;i<o;i++)if(l=r[i](e,s,n,!1),l){if(t>=e.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");e.tight=!a,e.isEmpty(e.line-1)&&(a=!0),s=e.line,s<n&&e.isEmpty(s)&&(a=!0,s++,e.line=s)}},ZS.prototype.parse=function(e,t,n,r){if(!e)return;const o=new this.State(e,t,n,r);this.tokenize(o,o.line,o.lineMax)},ZS.prototype.State=LS,US.prototype.pushPending=function(){const e=new yS("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e},US.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new yS(e,t,n);let o=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(o),r},US.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),o=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const s=i-e,a=i<n?this.src.charCodeAt(i):32,l=cS(o)||lS(String.fromCharCode(o)),c=cS(a)||lS(String.fromCharCode(a)),u=aS(o),d=aS(a),h=!d&&(!c||u||l),p=!u&&(!l||d||c);return{can_open:h&&(t||!p||l),can_close:p&&(t||!h||c),length:s}},US.prototype.Token=yS;const GS=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;const XS=[];for(let os=0;os<256;os++)XS.push(0);function YS(e,t){let n;const r=[],o=t.length;for(let i=0;i<o;i++){const o=t[i];if(126!==o.marker)continue;if(-1===o.end)continue;const s=t[o.end];n=e.tokens[o.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[s.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="","text"===e.tokens[s.token-1].type&&"~"===e.tokens[s.token-1].content&&r.push(s.token-1)}for(;r.length;){const t=r.pop();let o=t+1;for(;o<e.tokens.length&&"s_close"===e.tokens[o].type;)o++;o--,t!==o&&(n=e.tokens[o],e.tokens[o]=e.tokens[t],e.tokens[t]=n)}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){XS[e.charCodeAt(0)]=1});const QS={tokenize:function(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t)return!1;if(126!==r)return!1;const o=e.scanDelims(e.pos,!0);let i=o.length;const s=String.fromCharCode(r);if(i<2)return!1;let a;i%2&&(a=e.push("text","",0),a.content=s,i--);for(let l=0;l<i;l+=2)a=e.push("text","",0),a.content=s+s,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return e.pos+=o.length,!0},postProcess:function(e){const t=e.tokens_meta,n=e.tokens_meta.length;YS(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&YS(e,t[r].delimiters)}};function eE(e,t){for(let n=t.length-1;n>=0;n--){const r=t[n];if(95!==r.marker&&42!==r.marker)continue;if(-1===r.end)continue;const o=t[r.end],i=n>0&&t[n-1].end===r.end+1&&t[n-1].marker===r.marker&&t[n-1].token===r.token-1&&t[r.end+1].token===o.token+1,s=String.fromCharCode(r.marker),a=e.tokens[r.token];a.type=i?"strong_open":"em_open",a.tag=i?"strong":"em",a.nesting=1,a.markup=i?s+s:s,a.content="";const l=e.tokens[o.token];l.type=i?"strong_close":"em_close",l.tag=i?"strong":"em",l.nesting=-1,l.markup=i?s+s:s,l.content="",i&&(e.tokens[t[n-1].token].content="",e.tokens[t[r.end+1].token].content="",n--)}}const tE={tokenize:function(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t)return!1;if(95!==r&&42!==r)return!1;const o=e.scanDelims(e.pos,42===r);for(let i=0;i<o.length;i++){e.push("text","",0).content=String.fromCharCode(r),e.delimiters.push({marker:r,length:o.length,token:e.tokens.length-1,end:-1,open:o.can_open,close:o.can_close})}return e.pos+=o.length,!0},postProcess:function(e){const t=e.tokens_meta,n=e.tokens_meta.length;eE(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&eE(e,t[r].delimiters)}};const nE=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,rE=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;const oE=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,iE=/^&([a-z][a-z0-9]{1,31});/i;function sE(e){const t={},n=e.length;if(!n)return;let r=0,o=-2;const i=[];for(let s=0;s<n;s++){const n=e[s];if(i.push(0),e[r].marker===n.marker&&o===n.token-1||(r=s),o=n.token,n.length=n.length||0,!n.close)continue;t.hasOwnProperty(n.marker)||(t[n.marker]=[-1,-1,-1,-1,-1,-1]);const a=t[n.marker][(n.open?3:0)+n.length%3];let l=r-i[r]-1,c=l;for(;l>a;l-=i[l]+1){const t=e[l];if(t.marker===n.marker&&(t.open&&t.end<0)){let r=!1;if((t.close||n.open)&&(t.length+n.length)%3==0&&(t.length%3==0&&n.length%3==0||(r=!0)),!r){const r=l>0&&!e[l-1].open?i[l-1]+1:0;i[s]=s-l+r,i[l]=r,n.open=!1,t.end=s,t.close=!1,c=-1,o=-2;break}}}-1!==c&&(t[n.marker][(n.open?3:0)+(n.length||0)%3]=c)}}const aE=[["text",function(e,t){let n=e.pos;for(;n<e.posMax&&!JS(e.src.charCodeAt(n));)n++;return n!==e.pos&&(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}],["linkify",function(e,t){if(!e.md.options.linkify)return!1;if(e.linkLevel>0)return!1;const n=e.pos;if(n+3>e.posMax)return!1;if(58!==e.src.charCodeAt(n))return!1;if(47!==e.src.charCodeAt(n+1))return!1;if(47!==e.src.charCodeAt(n+2))return!1;const r=e.pending.match(GS);if(!r)return!1;const o=r[1],i=e.md.linkify.matchAtStart(e.src.slice(n-o.length));if(!i)return!1;let s=i.url;if(s.length<=o.length)return!1;s=s.replace(/\*+$/,"");const a=e.md.normalizeLink(s);if(!e.md.validateLink(a))return!1;if(!t){e.pending=e.pending.slice(0,-o.length);const t=e.push("link_open","a",1);t.attrs=[["href",a]],t.markup="linkify",t.info="auto";e.push("text","",0).content=e.md.normalizeLinkText(s);const n=e.push("link_close","a",-1);n.markup="linkify",n.info="auto"}return e.pos+=s.length-o.length,!0}],["newline",function(e,t){let n=e.pos;if(10!==e.src.charCodeAt(n))return!1;const r=e.pending.length-1,o=e.posMax;if(!t)if(r>=0&&32===e.pending.charCodeAt(r))if(r>=1&&32===e.pending.charCodeAt(r-1)){let t=r-1;for(;t>=1&&32===e.pending.charCodeAt(t-1);)t--;e.pending=e.pending.slice(0,t),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<o&&sS(e.src.charCodeAt(n));)n++;return e.pos=n,!0}],["escape",function(e,t){let n=e.pos;const r=e.posMax;if(92!==e.src.charCodeAt(n))return!1;if(n++,n>=r)return!1;let o=e.src.charCodeAt(n);if(10===o){for(t||e.push("hardbreak","br",0),n++;n<r&&(o=e.src.charCodeAt(n),sS(o));)n++;return e.pos=n,!0}let i=e.src[n];if(o>=55296&&o<=56319&&n+1<r){const t=e.src.charCodeAt(n+1);t>=56320&&t<=57343&&(i+=e.src[n+1],n++)}const s="\\"+i;if(!t){const t=e.push("text_special","",0);o<256&&0!==XS[o]?t.content=i:t.content=s,t.markup=s,t.info="escape"}return e.pos=n+1,!0}],["backticks",function(e,t){let n=e.pos;if(96!==e.src.charCodeAt(n))return!1;const r=n;n++;const o=e.posMax;for(;n<o&&96===e.src.charCodeAt(n);)n++;const i=e.src.slice(r,n),s=i.length;if(e.backticksScanned&&(e.backticks[s]||0)<=r)return t||(e.pending+=i),e.pos+=s,!0;let a,l=n;for(;-1!==(a=e.src.indexOf("`",l));){for(l=a+1;l<o&&96===e.src.charCodeAt(l);)l++;const r=l-a;if(r===s){if(!t){const t=e.push("code_inline","code",0);t.markup=i,t.content=e.src.slice(n,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[r]=a}return e.backticksScanned=!0,t||(e.pending+=i),e.pos+=s,!0}],["strikethrough",QS.tokenize],["emphasis",tE.tokenize],["link",function(e,t){let n,r,o,i,s="",a="",l=e.pos,c=!0;if(91!==e.src.charCodeAt(e.pos))return!1;const u=e.pos,d=e.posMax,h=e.pos+1,p=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(p<0)return!1;let f=p+1;if(f<d&&40===e.src.charCodeAt(f)){for(c=!1,f++;f<d&&(n=e.src.charCodeAt(f),sS(n)||10===n);f++);if(f>=d)return!1;if(l=f,o=e.md.helpers.parseLinkDestination(e.src,f,e.posMax),o.ok){for(s=e.md.normalizeLink(o.str),e.md.validateLink(s)?f=o.pos:s="",l=f;f<d&&(n=e.src.charCodeAt(f),sS(n)||10===n);f++);if(o=e.md.helpers.parseLinkTitle(e.src,f,e.posMax),f<d&&l!==f&&o.ok)for(a=o.str,f=o.pos;f<d&&(n=e.src.charCodeAt(f),sS(n)||10===n);f++);}(f>=d||41!==e.src.charCodeAt(f))&&(c=!0),f++}if(c){if(void 0===e.env.references)return!1;if(f<d&&91===e.src.charCodeAt(f)?(l=f+1,f=e.md.helpers.parseLinkLabel(e,f),f>=0?r=e.src.slice(l,f++):f=p+1):f=p+1,r||(r=e.src.slice(h,p)),i=e.env.references[uS(r)],!i)return e.pos=u,!1;s=i.href,a=i.title}if(!t){e.pos=h,e.posMax=p;const t=[["href",s]];e.push("link_open","a",1).attrs=t,a&&t.push(["title",a]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=f,e.posMax=d,!0}],["image",function(e,t){let n,r,o,i,s,a,l,c,u="";const d=e.pos,h=e.posMax;if(33!==e.src.charCodeAt(e.pos))return!1;if(91!==e.src.charCodeAt(e.pos+1))return!1;const p=e.pos+2,f=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(f<0)return!1;if(i=f+1,i<h&&40===e.src.charCodeAt(i)){for(i++;i<h&&(n=e.src.charCodeAt(i),sS(n)||10===n);i++);if(i>=h)return!1;for(c=i,a=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),a.ok&&(u=e.md.normalizeLink(a.str),e.md.validateLink(u)?i=a.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),sS(n)||10===n);i++);if(a=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&a.ok)for(l=a.str,i=a.pos;i<h&&(n=e.src.charCodeAt(i),sS(n)||10===n);i++);else l="";if(i>=h||41!==e.src.charCodeAt(i))return e.pos=d,!1;i++}else{if(void 0===e.env.references)return!1;if(i<h&&91===e.src.charCodeAt(i)?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?o=e.src.slice(c,i++):i=f+1):i=f+1,o||(o=e.src.slice(p,f)),s=e.env.references[uS(o)],!s)return e.pos=d,!1;u=s.href,l=s.title}if(!t){r=e.src.slice(p,f);const t=[];e.md.inline.parse(r,e.md,e.env,t);const n=e.push("image","img",0),o=[["src",u],["alt",""]];n.attrs=o,n.children=t,n.content=r,l&&o.push(["title",l])}return e.pos=i,e.posMax=h,!0}],["autolink",function(e,t){let n=e.pos;if(60!==e.src.charCodeAt(n))return!1;const r=e.pos,o=e.posMax;for(;;){if(++n>=o)return!1;const t=e.src.charCodeAt(n);if(60===t)return!1;if(62===t)break}const i=e.src.slice(r+1,n);if(rE.test(i)){const n=e.md.normalizeLink(i);if(!e.md.validateLink(n))return!1;if(!t){const t=e.push("link_open","a",1);t.attrs=[["href",n]],t.markup="autolink",t.info="auto";e.push("text","",0).content=e.md.normalizeLinkText(i);const r=e.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return e.pos+=i.length+2,!0}if(nE.test(i)){const n=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(n))return!1;if(!t){const t=e.push("link_open","a",1);t.attrs=[["href",n]],t.markup="autolink",t.info="auto";e.push("text","",0).content=e.md.normalizeLinkText(i);const r=e.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return e.pos+=i.length+2,!0}return!1}],["html_inline",function(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(60!==e.src.charCodeAt(r)||r+2>=n)return!1;const o=e.src.charCodeAt(r+1);if(33!==o&&63!==o&&47!==o&&!function(e){const t=32|e;return t>=97&&t<=122}(o))return!1;const i=e.src.slice(r).match(jS);if(!i)return!1;if(!t){const t=e.push("html_inline","",0);t.content=i[0],s=t.content,/^<a[>\s]/i.test(s)&&e.linkLevel++,function(e){return/^<\/a\s*>/i.test(e)}(t.content)&&e.linkLevel--}var s;return e.pos+=i[0].length,!0}],["entity",function(e,t){const n=e.pos,r=e.posMax;if(38!==e.src.charCodeAt(n))return!1;if(n+1>=r)return!1;if(35===e.src.charCodeAt(n+1)){const r=e.src.slice(n).match(oE);if(r){if(!t){const t="x"===r[1][0].toLowerCase()?parseInt(r[1].slice(1),16):parseInt(r[1],10),n=e.push("text_special","",0);n.content=U_(t)?J_(t):J_(65533),n.markup=r[0],n.info="entity"}return e.pos+=r[0].length,!0}}else{const r=e.src.slice(n).match(iE);if(r){const n=j_(r[0]);if(n!==r[0]){if(!t){const t=e.push("text_special","",0);t.content=n,t.markup=r[0],t.info="entity"}return e.pos+=r[0].length,!0}}}return!1}]],lE=[["balance_pairs",function(e){const t=e.tokens_meta,n=e.tokens_meta.length;sE(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&sE(t[r].delimiters)}],["strikethrough",QS.postProcess],["emphasis",tE.postProcess],["fragments_join",function(e){let t,n,r=0;const o=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)o[t].nesting<0&&r--,o[t].level=r,o[t].nesting>0&&r++,"text"===o[t].type&&t+1<i&&"text"===o[t+1].type?o[t+1].content=o[t].content+o[t+1].content:(t!==n&&(o[n]=o[t]),n++);t!==n&&(o.length=n)}]];function cE(){this.ruler=new gS;for(let e=0;e<aE.length;e++)this.ruler.push(aE[e][0],aE[e][1]);this.ruler2=new gS;for(let e=0;e<lE.length;e++)this.ruler2.push(lE[e][0],lE[e][1])}function uE(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){t&&Object.keys(t).forEach(function(n){e[n]=t[n]})}),e}function dE(e){return Object.prototype.toString.call(e)}function hE(e){return"[object Function]"===dE(e)}function pE(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}cE.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,o=e.md.options.maxNesting,i=e.cache;if(void 0!==i[t])return void(e.pos=i[t]);let s=!1;if(e.level<o){for(let a=0;a<r;a++)if(e.level++,s=n[a](e,!0),e.level--,s){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;s||e.pos++,i[t]=e.pos},cE.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,o=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let s=!1;if(e.level<o)for(let r=0;r<n;r++)if(s=t[r](e,!1),s){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}if(s){if(e.pos>=r)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},cE.prototype.parse=function(e,t,n,r){const o=new this.State(e,t,n,r);this.tokenize(o);const i=this.ruler2.getRules(""),s=i.length;for(let a=0;a<s;a++)i[a](o)},cE.prototype.State=US;const fE={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};const mE={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&":"===e[t-3]||t>=3&&"/"===e[t-3]?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},gE="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|ÑÑ".split("|");function yE(e){const t=e.re=function(e){const t={};e=e||{},t.src_Any=y_.source,t.src_Cc=v_.source,t.src_Z=w_.source,t.src_P=k_.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><ï½]";return t.src_pseudo_letter="(?:(?![><ï½]|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|[><ï½]|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+"|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy='(^|[><ï½]|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|ï½]|"+t.src_ZPCc+"))((?![$+<=>^`|ï½])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|ï½]|"+t.src_ZPCc+"))((?![$+<=>^`|ï½])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}(e.__opts__),n=e.__tlds__.slice();function r(e){return e.replace("%TLDS%",t.src_tlds)}e.onCompile(),e.__tlds_replaced__||n.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),n.push(t.src_xn),t.src_tlds=n.join("|"),t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const o=[];function i(e,t){throw new Error('(LinkifyIt) Invalid schema "'+e+'": '+t)}e.__compiled__={},Object.keys(e.__schemas__).forEach(function(t){const n=e.__schemas__[t];if(null===n)return;const r={validate:null,link:null};if(e.__compiled__[t]=r,"[object Object]"===dE(n))return!function(e){return"[object RegExp]"===dE(e)}(n.validate)?hE(n.validate)?r.validate=n.validate:i(t,n):r.validate=function(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}(n.validate),void(hE(n.normalize)?r.normalize=n.normalize:n.normalize?i(t,n):r.normalize=function(e,t){t.normalize(e)});!function(e){return"[object String]"===dE(e)}(n)?i(t,n):o.push(t)}),o.forEach(function(t){e.__compiled__[e.__schemas__[t]]&&(e.__compiled__[t].validate=e.__compiled__[e.__schemas__[t]].validate,e.__compiled__[t].normalize=e.__compiled__[e.__schemas__[t]].normalize)}),e.__compiled__[""]={validate:null,normalize:function(e,t){t.normalize(e)}};const s=Object.keys(e.__compiled__).filter(function(t){return t.length>0&&e.__compiled__[t]}).map(pE).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><ï½]|"+t.src_ZPCc+"))("+s+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><ï½]|"+t.src_ZPCc+"))("+s+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),function(e){e.__index__=-1,e.__text_cache__=""}(e)}function vE(e,t){const n=e.__index__,r=e.__last_index__,o=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=o,this.text=o,this.url=o}function kE(e,t){const n=new vE(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function bE(e,t){if(!(this instanceof bE))return new bE(e,t);var n;t||(n=e,Object.keys(n||{}).reduce(function(e,t){return e||fE.hasOwnProperty(t)},!1)&&(t=e,e={})),this.__opts__=uE({},fE,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=uE({},mE,e),this.__compiled__={},this.__tlds__=gE,this.__tlds_replaced__=!1,this.re={},yE(this)}bE.prototype.add=function(e,t){return this.__schemas__[e]=t,yE(this),this},bE.prototype.set=function(e){return this.__opts__=uE(this.__opts__,e),this},bE.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let t,n,r,o,i,s,a,l,c;if(this.re.schema_test.test(e))for(a=this.re.schema_search,a.lastIndex=0;null!==(t=a.exec(e));)if(o=this.testSchemaAt(e,t[2],a.lastIndex),o){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+o;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(i=n.index+n[1].length,(this.__index__<0||i<this.__index__)&&(this.__schema__="",this.__index__=i,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&null!==(r=e.match(this.re.email_fuzzy))&&(i=r.index+r[1].length,s=r.index+r[0].length,(this.__index__<0||i<this.__index__||i===this.__index__&&s>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=i,this.__last_index__=s))),this.__index__>=0},bE.prototype.pretest=function(e){return this.re.pretest.test(e)},bE.prototype.testSchemaAt=function(e,t,n){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,n,this):0},bE.prototype.match=function(e){const t=[];let n=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(kE(this,n)),n=this.__last_index__);let r=n?e.slice(n):e;for(;this.test(r);)t.push(kE(this,n)),r=r.slice(this.__last_index__),n+=this.__last_index__;return t.length?t:null},bE.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const t=this.re.schema_at_start.exec(e);if(!t)return null;const n=this.testSchemaAt(e,t[2],t[0].length);return n?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+n,kE(this,0)):null},bE.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(e,t,n){return e!==n[t-1]}).reverse(),yE(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,yE(this),this)},bE.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),"mailto:"!==e.schema||/^mailto:/i.test(e.url)||(e.url="mailto:"+e.url)},bE.prototype.onCompile=function(){};const wE=2147483647,xE=36,CE=/^xn--/,_E=/[^\0-\x7F]/,SE=/[\x2E\u3002\uFF0E\uFF61]/g,EE={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ME=Math.floor,AE=String.fromCharCode;function DE(e){throw new RangeError(EE[e])}function TE(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]);const o=function(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}((e=e.replace(SE,".")).split("."),t).join(".");return r+o}function OE(e){const t=[];let n=0;const r=e.length;for(;n<r;){const o=e.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){const r=e.charCodeAt(n++);56320==(64512&r)?t.push(((1023&o)<<10)+(1023&r)+65536):(t.push(o),n--)}else t.push(o)}return t}const NE=function(e){return e>=48&&e<58?e-48+26:e>=65&&e<91?e-65:e>=97&&e<123?e-97:xE},PE=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},zE=function(e,t,n){let r=0;for(e=n?ME(e/700):e>>1,e+=ME(e/t);e>455;r+=xE)e=ME(e/35);return ME(r+36*e/(e+38))},IE=function(e){const t=[],n=e.length;let r=0,o=128,i=72,s=e.lastIndexOf("-");s<0&&(s=0);for(let a=0;a<s;++a)e.charCodeAt(a)>=128&&DE("not-basic"),t.push(e.charCodeAt(a));for(let a=s>0?s+1:0;a<n;){const s=r;for(let t=1,o=xE;;o+=xE){a>=n&&DE("invalid-input");const s=NE(e.charCodeAt(a++));s>=xE&&DE("invalid-input"),s>ME((wE-r)/t)&&DE("overflow"),r+=s*t;const l=o<=i?1:o>=i+26?26:o-i;if(s<l)break;const c=xE-l;t>ME(wE/c)&&DE("overflow"),t*=c}const l=t.length+1;i=zE(r-s,l,0==s),ME(r/l)>wE-o&&DE("overflow"),o+=ME(r/l),r%=l,t.splice(r++,0,o)}return String.fromCodePoint(...t)},LE=function(e){const t=[],n=(e=OE(e)).length;let r=128,o=0,i=72;for(const l of e)l<128&&t.push(AE(l));const s=t.length;let a=s;for(s&&t.push("-");a<n;){let n=wE;for(const t of e)t>=r&&t<n&&(n=t);const l=a+1;n-r>ME((wE-o)/l)&&DE("overflow"),o+=(n-r)*l,r=n;for(const c of e)if(c<r&&++o>wE&&DE("overflow"),c===r){let e=o;for(let n=xE;;n+=xE){const r=n<=i?1:n>=i+26?26:n-i;if(e<r)break;const o=e-r,s=xE-r;t.push(AE(PE(r+o%s,0))),e=ME(o/s)}t.push(AE(PE(e,0))),i=zE(o,l,a===s),o=0,++a}++o,++r}return t.join("")},$E=function(e){return TE(e,function(e){return _E.test(e)?"xn--"+LE(e):e})},RE=function(e){return TE(e,function(e){return CE.test(e)?IE(e.slice(4).toLowerCase()):e})},FE={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"ââââ",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},zero:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"ââââ",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"ââââ",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}}},BE=/^(vbscript|javascript|file|data):/,VE=/^data:image\/(gif|png|jpeg|webp);/;function HE(e){const t=e.trim().toLowerCase();return!BE.test(t)||VE.test(t)}const jE=["http:","https:","mailto:"];function qE(e){const t=m_(e,!0);if(t.hostname&&(!t.protocol||jE.indexOf(t.protocol)>=0))try{t.hostname=$E(t.hostname)}catch(n){}return t_(n_(t))}function KE(e){const t=m_(e,!0);if(t.hostname&&(!t.protocol||jE.indexOf(t.protocol)>=0))try{t.hostname=RE(t.hostname)}catch(n){}return QC(n_(t),QC.defaultChars+"%")}function WE(e,t){if(!(this instanceof WE))return new WE(e,t);t||q_(e)||(t=e||{},e="default"),this.inline=new cE,this.block=new ZS,this.core=new IS,this.renderer=new mS,this.linkify=new bE,this.validateLink=HE,this.normalizeLink=qE,this.normalizeLinkText=KE,this.utils=hS,this.helpers=W_({},pS),this.options={},this.configure(e),t&&this.set(t)}WE.prototype.set=function(e){return W_(this.options,e),this},WE.prototype.configure=function(e){const t=this;if(q_(e)){const t=e;if(!(e=FE[t]))throw new Error('Wrong `markdown-it` preset "'+t+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this},WE.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(t){n=n.concat(this[t].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(e){return n.indexOf(e)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this},WE.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(t){n=n.concat(this[t].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(e){return n.indexOf(e)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this},WE.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this},WE.prototype.parse=function(e,t){if("string"!=typeof e)throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens},WE.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},WE.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens},WE.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const ZE=new Jd({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",0]},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["div",["hr"]]},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:e=>["h"+e.attrs.level,0]},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>({params:e.getAttribute("data-params")||""})}],toDOM:e=>["pre",e.attrs.params?{"data-params":e.attrs.params}:{},["code",0]]},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?+e.getAttribute("start"):1,tight:e.hasAttribute("data-tight")})}],toDOM:e=>["ol",{start:1==e.attrs.order?null:e.attrs.order,"data-tight":e.attrs.tight?"true":null},0]},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:e=>({tight:e.hasAttribute("data-tight")})}],toDOM:e=>["ul",{"data-tight":e.attrs.tight?"true":null},0]},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM:()=>["li",0]},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt")})}],toDOM:e=>["img",e.attrs]},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:e=>"em"==e.type.name}],toDOM:()=>["em"]},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>"strong"==e.type.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>["strong"]},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title")})}],toDOM:e=>["a",e.attrs]},code:{code:!0,parseDOM:[{tag:"code"}],toDOM:()=>["code"]}}});class UE{constructor(e,t){this.schema=e,this.tokenHandlers=t,this.stack=[{type:e.topNodeType,attrs:null,content:[],marks:ud.none}]}top(){return this.stack[this.stack.length-1]}push(e){this.stack.length&&this.top().content.push(e)}addText(e){if(!e)return;let t,n=this.top(),r=n.content,o=r[r.length-1],i=this.schema.text(e,n.marks);o&&(t=function(e,t){if(e.isText&&t.isText&&ud.sameSet(e.marks,t.marks))return e.withText(e.text+t.text)}(o,i))?r[r.length-1]=t:r.push(i)}openMark(e){let t=this.top();t.marks=e.addToSet(t.marks)}closeMark(e){let t=this.top();t.marks=e.removeFromSet(t.marks)}parseTokens(e){for(let t=0;t<e.length;t++){let n=e[t],r=this.tokenHandlers[n.type];if(!r)throw new Error("Token type `"+n.type+"` not supported by Markdown parser");r(this,n,e,t)}}addNode(e,t,n){let r=this.top(),o=e.createAndFill(t,n,r?r.marks:[]);return o?(this.push(o),o):null}openNode(e,t){this.stack.push({type:e,attrs:t,content:[],marks:ud.none})}closeNode(){let e=this.stack.pop();return this.addNode(e.type,e.attrs,e.content)}}function JE(e,t,n,r){return e.getAttrs?e.getAttrs(t,n,r):e.attrs instanceof Function?e.attrs(t):e.attrs}function GE(e,t){return e.noCloseToken||"code_inline"==t||"code_block"==t||"fence"==t}function XE(e){return"\n"==e[e.length-1]?e.slice(0,e.length-1):e}function YE(){}function QE(e,t){for(;++t<e.length;)if("list_item_open"!=e[t].type)return e[t].hidden;return!1}new class{constructor(e,t,n){this.schema=e,this.tokenizer=t,this.tokens=n,this.tokenHandlers=function(e,t){let n=Object.create(null);for(let r in t){let o=t[r];if(o.block){let t=e.nodeType(o.block);GE(o,r)?n[r]=(e,n,r,i)=>{e.openNode(t,JE(o,n,r,i)),e.addText(XE(n.content)),e.closeNode()}:(n[r+"_open"]=(e,n,r,i)=>e.openNode(t,JE(o,n,r,i)),n[r+"_close"]=e=>e.closeNode())}else if(o.node){let t=e.nodeType(o.node);n[r]=(e,n,r,i)=>e.addNode(t,JE(o,n,r,i))}else if(o.mark){let t=e.marks[o.mark];GE(o,r)?n[r]=(e,n,r,i)=>{e.openMark(t.create(JE(o,n,r,i))),e.addText(XE(n.content)),e.closeMark(t)}:(n[r+"_open"]=(e,n,r,i)=>e.openMark(t.create(JE(o,n,r,i))),n[r+"_close"]=e=>e.closeMark(t))}else{if(!o.ignore)throw new RangeError("Unrecognized parsing spec "+JSON.stringify(o));GE(o,r)?n[r]=YE:(n[r+"_open"]=YE,n[r+"_close"]=YE)}}return n.text=(e,t)=>e.addText(t.content),n.inline=(e,t)=>e.parseTokens(t.children),n.softbreak=n.softbreak||(e=>e.addText(" ")),n}(e,n)}parse(e,t={}){let n,r=new UE(this.schema,this.tokenHandlers);r.parseTokens(this.tokenizer.parse(e,t));do{n=r.closeNode()}while(r.stack.length);return n||this.schema.topNodeType.createAndFill()}}(ZE,WE("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:(e,t,n)=>({tight:QE(t,n)})},ordered_list:{block:"ordered_list",getAttrs:(e,t,n)=>({order:+e.attrGet("start")||1,tight:QE(t,n)})},heading:{block:"heading",getAttrs:e=>({level:+e.tag.slice(1)})},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:e=>({params:e.info||""}),noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:e=>({src:e.attrGet("src"),title:e.attrGet("title")||null,alt:e.children[0]&&e.children[0].content||null})},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:e=>({href:e.attrGet("href"),title:e.attrGet("title")||null})},code_inline:{mark:"code",noCloseToken:!0}});const eM={open:"",close:"",mixable:!0};const tM=new class{constructor(e,t,n={}){this.nodes=e,this.marks=t,this.options=n}serialize(e,t={}){t=Object.assign({},this.options,t);let n=new rM(this.nodes,this.marks,t);return n.renderContent(e),n.out}}({blockquote(e,t){e.wrapBlock("> ",null,t,()=>e.renderContent(t))},code_block(e,t){const n=t.textContent.match(/`{3,}/gm),r=n?n.sort().slice(-1)[0]+"`":"```";e.write(r+(t.attrs.params||"")+"\n"),e.text(t.textContent,!1),e.write("\n"),e.write(r),e.closeBlock(t)},heading(e,t){e.write(e.repeat("#",t.attrs.level)+" "),e.renderInline(t,!1),e.closeBlock(t)},horizontal_rule(e,t){e.write(t.attrs.markup||"---"),e.closeBlock(t)},bullet_list(e,t){e.renderList(t,"  ",()=>(t.attrs.bullet||"*")+" ")},ordered_list(e,t){let n=t.attrs.order||1,r=String(n+t.childCount-1).length,o=e.repeat(" ",r+2);e.renderList(t,o,t=>{let o=String(n+t);return e.repeat(" ",r-o.length)+o+". "})},list_item(e,t){e.renderContent(t)},paragraph(e,t){e.renderInline(t),e.closeBlock(t)},image(e,t){e.write("!["+e.esc(t.attrs.alt||"")+"]("+t.attrs.src.replace(/[\(\)]/g,"\\$&")+(t.attrs.title?' "'+t.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break(e,t,n,r){for(let o=r+1;o<n.childCount;o++)if(n.child(o).type!=t.type)return void e.write("\\\n")},text(e,t){e.text(t.text,!e.inAutolink)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open:(e,t,n,r)=>(e.inAutolink=function(e,t,n){if(e.attrs.title||!/^\w+:/.test(e.attrs.href))return!1;let r=t.child(n);return!(!r.isText||r.text!=e.attrs.href||r.marks[r.marks.length-1]!=e)&&(n==t.childCount-1||!e.isInSet(t.child(n+1).marks))}(t,n,r),e.inAutolink?"<":"["),close(e,t,n,r){let{inAutolink:o}=e;return e.inAutolink=void 0,o?">":"]("+t.attrs.href.replace(/[\(\)"]/g,"\\$&")+(t.attrs.title?` "${t.attrs.title.replace(/"/g,'\\"')}"`:"")+")"},mixable:!0},code:{open:(e,t,n,r)=>nM(n.child(r),-1),close:(e,t,n,r)=>nM(n.child(r-1),1),escape:!1}});function nM(e,t){let n,r=/`+/g,o=0;if(e.isText)for(;n=r.exec(e.text);)o=Math.max(o,n[0].length);let i=o>0&&t>0?" `":"`";for(let s=0;s<o;s++)i+="`";return o>0&&t<0&&(i+=" "),i}let rM=class{constructor(e,t,n){this.nodes=e,this.marks=t,this.options=n,this.delim="",this.out="",this.closed=null,this.inAutolink=void 0,this.atBlockStart=!1,this.inTightList=!1,void 0===this.options.tightLists&&(this.options.tightLists=!1),void 0===this.options.hardBreakNodeName&&(this.options.hardBreakNodeName="hard_break")}flushClose(e=2){if(this.closed){if(this.atBlank()||(this.out+="\n"),e>1){let t=this.delim,n=/\s+$/.exec(t);n&&(t=t.slice(0,t.length-n[0].length));for(let r=1;r<e;r++)this.out+=t+"\n"}this.closed=null}}getMark(e){let t=this.marks[e];if(!t){if(!1!==this.options.strict)throw new Error(`Mark type \`${e}\` not supported by Markdown renderer`);t=eM}return t}wrapBlock(e,t,n,r){let o=this.delim;this.write(null!=t?t:e),this.delim+=e,r(),this.delim=o,this.closeBlock(n)}atBlank(){return/(^|\n)$/.test(this.out)}ensureNewLine(){this.atBlank()||(this.out+="\n")}write(e){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),e&&(this.out+=e)}closeBlock(e){this.closed=e}text(e,t=!0){let n=e.split("\n");for(let r=0;r<n.length;r++)this.write(),!t&&"["==n[r][0]&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=t?this.esc(n[r],this.atBlockStart):n[r],r!=n.length-1&&(this.out+="\n")}render(e,t,n){if(this.nodes[e.type.name])this.nodes[e.type.name](this,e,t,n);else{if(!1!==this.options.strict)throw new Error("Token type `"+e.type.name+"` not supported by Markdown renderer");e.type.isLeaf||(e.type.inlineContent?this.renderInline(e):this.renderContent(e),e.isBlock&&this.closeBlock(e))}}renderContent(e){e.forEach((t,n,r)=>this.render(t,e,r))}renderInline(e,t=!0){this.atBlockStart=t;let n=[],r="",o=(t,o,i)=>{let s=t?t.marks:[];t&&t.type.name===this.options.hardBreakNodeName&&(s=s.filter(t=>{if(i+1==e.childCount)return!1;let n=e.child(i+1);return t.isInSet(n.marks)&&(!n.isText||/\S/.test(n.text))}));let a=r;if(r="",t&&t.isText&&s.some(e=>{let t=this.getMark(e.type.name);return t&&t.expelEnclosingWhitespace&&!e.isInSet(n)})){let[e,r,o]=/^(\s*)(.*)$/m.exec(t.text);r&&(a+=r,(t=o?t.withText(o):null)||(s=n))}if(t&&t.isText&&s.some(t=>{let n=this.getMark(t.type.name);return n&&n.expelEnclosingWhitespace&&(i==e.childCount-1||!t.isInSet(e.child(i+1).marks))})){let[e,o,i]=/^(.*?)(\s*)$/m.exec(t.text);i&&(r=i,(t=o?t.withText(o):null)||(s=n))}let l=s.length?s[s.length-1]:null,c=l&&!1===this.getMark(l.type.name).escape,u=s.length-(c?1:0);e:for(let e=0;e<u;e++){let t=s[e];if(!this.getMark(t.type.name).mixable)break;for(let r=0;r<n.length;r++){let o=n[r];if(!this.getMark(o.type.name).mixable)break;if(t.eq(o)){e>r?s=s.slice(0,r).concat(t).concat(s.slice(r,e)).concat(s.slice(e+1,u)):r>e&&(s=s.slice(0,e).concat(s.slice(e+1,r)).concat(t).concat(s.slice(r,u)));continue e}}}let d=0;for(;d<Math.min(n.length,u)&&s[d].eq(n[d]);)++d;for(;d<n.length;)this.text(this.markString(n.pop(),!1,e,i),!1);if(a&&this.text(a),t){for(;n.length<u;){let t=s[n.length];n.push(t),this.text(this.markString(t,!0,e,i),!1),this.atBlockStart=!1}c&&t.isText?this.text(this.markString(l,!0,e,i)+t.text+this.markString(l,!1,e,i+1),!1):this.render(t,e,i),this.atBlockStart=!1}(null==t?void 0:t.isText)&&t.nodeSize>0&&(this.atBlockStart=!1)};e.forEach(o),o(null,0,e.childCount),this.atBlockStart=!1}renderList(e,t,n){this.closed&&this.closed.type==e.type?this.flushClose(3):this.inTightList&&this.flushClose(1);let r=void 0!==e.attrs.tight?e.attrs.tight:this.options.tightLists,o=this.inTightList;this.inTightList=r,e.forEach((o,i,s)=>{s&&r&&this.flushClose(1),this.wrapBlock(t,n(s),e,()=>this.render(o,e,s))}),this.inTightList=o}esc(e,t=!1){return e=e.replace(/[`*\\~\[\]_]/g,(t,n)=>"_"==t&&n>0&&n+1<e.length&&e[n-1].match(/\w/)&&e[n+1].match(/\w/)?t:"\\"+t),t&&(e=e.replace(/^(\+[ ]|[\-*>])/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(e=e.replace(this.options.escapeExtraCharacters,"\\$&")),e}quote(e){let t=-1==e.indexOf('"')?'""':-1==e.indexOf("'")?"''":"()";return t[0]+e+t[1]}repeat(e,t){let n="";for(let r=0;r<t;r++)n+=e;return n}markString(e,t,n,r){let o=this.getMark(e.type.name),i=t?o.open:o.close;return"string"==typeof i?i:i(this,e,n,r)}getEnclosingWhitespace(e){return{leading:(e.match(/^(\s+)/)||[void 0])[0],trailing:(e.match(/(\s+)$/)||[void 0])[0]}}};function oM(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var iM,sM;var aM=function(){if(sM)return iM;sM=1;var e=!0,t=!1,n=!1;function r(e,t,n){var r=e.attrIndex(t),o=[t,n];r<0?e.attrPush(o):e.attrs[r]=o}function o(e,t){for(var n=e[t].level-1,r=t-1;r>=0;r--)if(e[r].level===n)return r;return-1}function i(e,t){return"inline"===e[t].type&&function(e){return"paragraph_open"===e.type}(e[t-1])&&function(e){return"list_item_open"===e.type}(e[t-2])&&function(e){return 0===e.content.indexOf("[ ] ")||0===e.content.indexOf("[x] ")||0===e.content.indexOf("[X] ")}(e[t])}function s(r,o){if(r.children.unshift(function(t,n){var r=new n("html_inline","",0),o=e?' disabled="" ':"";0===t.content.indexOf("[ ] ")?r.content='<input class="task-list-item-checkbox"'+o+'type="checkbox">':0!==t.content.indexOf("[x] ")&&0!==t.content.indexOf("[X] ")||(r.content='<input class="task-list-item-checkbox" checked=""'+o+'type="checkbox">');return r}(r,o)),r.children[1].content=r.children[1].content.slice(3),r.content=r.content.slice(3),t)if(n){r.children.pop();var i="task-item-"+Math.ceil(1e7*Math.random()-1e3);r.children[0].content=r.children[0].content.slice(0,-1)+' id="'+i+'">',r.children.push(function(e,t,n){var r=new n("html_inline","",0);return r.content='<label class="task-list-item-label" for="'+t+'">'+e+"</label>",r.attrs=[{for:t}],r}(r.content,i,o))}else r.children.unshift(function(e){var t=new e("html_inline","",0);return t.content="<label>",t}(o)),r.children.push(function(e){var t=new e("html_inline","",0);return t.content="</label>",t}(o))}return iM=function(a,l){l&&(e=!l.enabled,t=!!l.label,n=!!l.labelAfter),a.core.ruler.after("inline","github-task-lists",function(t){for(var n=t.tokens,a=2;a<n.length;a++)i(n,a)&&(s(n[a],t.Token),r(n[a-2],"class","task-list-item"+(e?"":" enabled")),r(n[o(n,a-2)],"class","contains-task-list"))})},iM}();const lM=oM(aM);var cM=Object.defineProperty,uM=(e,t,n)=>(((e,t,n)=>{t in e?cM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const dM=qk.create({name:"markdownTightLists",addOptions:()=>({tight:!0,tightClass:"tight",listTypes:["bulletList","orderedList"]}),addGlobalAttributes(){return[{types:this.options.listTypes,attributes:{tight:{default:this.options.tight,parseHTML:e=>"true"===e.getAttribute("data-tight")||!e.querySelector("p"),renderHTML:e=>({class:e.tight?this.options.tightClass:null,"data-tight":e.tight?"true":null})}}}]},addCommands(){var e=this;return{toggleTight:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return n=>{let{editor:r,commands:o}=n;return e.options.listTypes.some(e=>function(e){if(!r.isActive(e))return!1;const n=r.getAttributes(e);return o.updateAttributes(e,{tight:null!=t?t:!(null!=n&&n.tight)})}(e))}}}}}),hM=WE();function pM(e,t){hM.inline.State.prototype.scanDelims.call({src:e,posMax:e.length});return new hM.inline.State(e,null,null,[]).scanDelims(t,!0)}function fM(e,t,n,r){let o=e.substring(0,n)+e.substring(n+t.length);return o=o.substring(0,n+r)+t+o.substring(n+r),o}function mM(e,t,n,r){let o={text:e,from:n,to:r};return o=function(e,t,n,r){let o=n,i=e;for(;o<r&&!pM(i,o).can_open;)i=fM(i,t,o,1),o++;return{text:i,from:o,to:r}}(o.text,t,o.from,o.to),o=function(e,t,n,r){let o=r,i=e;for(;o>n&&!pM(i,o).can_close;)i=fM(i,t,o,-1),o--;return{text:i,from:n,to:o}}(o.text,t,o.from,o.to),o.to-o.from<t.length+1&&(o.text=o.text.substring(0,o.from)+o.text.substring(o.to+t.length)),o.text}class gM extends rM{constructor(e,t,n){super(e,t,null!=n?n:{}),uM(this,"inTable",!1),this.inlines=[]}render(e,t,n){super.render(e,t,n);const r=this.inlines[this.inlines.length-1];if(null!=r&&r.start&&null!=r&&r.end){const{delimiter:e,start:t,end:n}=this.normalizeInline(r);this.out=mM(this.out,e,t,n),this.inlines.pop()}}markString(e,t,n,r){const o=this.marks[e.type.name];if(o.expelEnclosingWhitespace)if(t)this.inlines.push({start:this.out.length,delimiter:o.open});else{const e=this.inlines.pop();this.inlines.push({...e,end:this.out.length})}return super.markString(e,t,n,r)}normalizeInline(e){let{start:t,end:n}=e;for(;this.out.charAt(t).match(/\s/);)t++;return{...e,start:t}}}const yM=$k.create({name:"markdownHTMLMark",addStorage:()=>({markdown:{serialize:{open(e,t){var n,r;return this.editor.storage.markdown.options.html?null!==(n=null===(r=vM(t))||void 0===r?void 0:r[0])&&void 0!==n?n:"":(console.warn(`Tiptap Markdown: "${t.type.name}" mark is only available in html mode`),"")},close(e,t){var n,r;return this.editor.storage.markdown.options.html&&null!==(n=null===(r=vM(t))||void 0===r?void 0:r[1])&&void 0!==n?n:""}},parse:{}}})});function vM(e){const t=e.type.schema,n=t.text(" ",[e]),r=Bv(sd.from(n),t).match(/^(<.*?>) (<\/.*?>)$/);return r?[r[1],r[2]]:null}function kM(e){const t=`<body>${e}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}const bM=mb.create({name:"markdownHTMLNode",addStorage:()=>({markdown:{serialize(e,t,n){this.editor.storage.markdown.options.html?e.write(function(e,t){const n=e.type.schema,r=Bv(sd.from(e),n);if(e.isBlock&&(t instanceof sd||t.type.name===n.topNodeType.name))return function(e){const t=kM(e),n=t.firstElementChild;return n.innerHTML=n.innerHTML.trim()?`\n${n.innerHTML}\n`:"\n",n.outerHTML}(r);return r}(t,n)):(console.warn(`Tiptap Markdown: "${t.type.name}" node is only available in html mode`),e.write(`[${t.type.name}]`)),t.isBlock&&e.closeBlock(t)},parse:{}}})});const wM=mb.create({name:"blockquote"}).extend({addStorage:()=>({markdown:{serialize:tM.nodes.blockquote,parse:{}}})}),xM=mb.create({name:"bulletList"}).extend({addStorage:()=>({markdown:{serialize(e,t){return e.renderList(t,"  ",()=>(this.editor.storage.markdown.options.bulletListMarker||"-")+" ")},parse:{}}})}),CM=mb.create({name:"codeBlock"}).extend({addStorage:()=>({markdown:{serialize(e,t){e.write("```"+(t.attrs.language||"")+"\n"),e.text(t.textContent,!1),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},parse:{setup(e){var t;e.set({langPrefix:null!==(t=this.options.languageClassPrefix)&&void 0!==t?t:"language-"})},updateDOM(e){e.innerHTML=e.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}})}),_M=mb.create({name:"hardBreak"}).extend({addStorage:()=>({markdown:{serialize(e,t,n,r){for(let o=r+1;o<n.childCount;o++)if(n.child(o).type!=t.type)return void e.write(e.inTable?bM.storage.markdown.serialize.call(this,e,t,n):"\\\n")},parse:{}}})}),SM=mb.create({name:"heading"}).extend({addStorage:()=>({markdown:{serialize:tM.nodes.heading,parse:{}}})}),EM=mb.create({name:"horizontalRule"}).extend({addStorage:()=>({markdown:{serialize:tM.nodes.horizontal_rule,parse:{}}})}),MM=mb.create({name:"image"}).extend({addStorage:()=>({markdown:{serialize:tM.nodes.image,parse:{}}})}),AM=mb.create({name:"listItem"}).extend({addStorage:()=>({markdown:{serialize:tM.nodes.list_item,parse:{}}})});const DM=mb.create({name:"orderedList"}).extend({addStorage:()=>({markdown:{serialize(e,t,n,r){const o=t.attrs.start||1,i=String(o+t.childCount-1).length,s=e.repeat(" ",i+2),a=function(e,t,n){let r=0;for(;n-r>0&&t.child(n-r-1).type.name===e.type.name;r++);return r}(t,n,r),l=a%2?") ":". ";e.renderList(t,s,t=>{const n=String(o+t);return e.repeat(" ",i-n.length)+n+l})},parse:{}}})}),TM=mb.create({name:"paragraph"}).extend({addStorage:()=>({markdown:{serialize:tM.nodes.paragraph,parse:{}}})});function OM(e){var t,n;return null!==(t=null==e||null===(n=e.content)||void 0===n?void 0:n.content)&&void 0!==t?t:[]}const NM=mb.create({name:"table"}).extend({addStorage:()=>({markdown:{serialize(e,t,n){!function(e){const t=OM(e),n=t[0],r=t.slice(1);if(OM(n).some(e=>"tableHeader"!==e.type.name||PM(e)||e.childCount>1))return!1;if(r.some(e=>OM(e).some(e=>"tableHeader"===e.type.name||PM(e)||e.childCount>1)))return!1;return!0}(t)?bM.storage.markdown.serialize.call(this,e,t,n):(e.inTable=!0,t.forEach((t,n,r)=>{if(e.write("| "),t.forEach((t,n,r)=>{r&&e.write(" | ");const o=t.firstChild;o.textContent.trim()&&e.renderInline(o)}),e.write(" |"),e.ensureNewLine(),!r){const n=Array.from({length:t.childCount}).map(()=>"---").join(" | ");e.write(`| ${n} |`),e.ensureNewLine()}}),e.closeBlock(t),e.inTable=!1)},parse:{}}})});function PM(e){return e.attrs.colspan>1||e.attrs.rowspan>1}const zM=mb.create({name:"taskItem"}).extend({addStorage:()=>({markdown:{serialize(e,t){const n=t.attrs.checked?"[x]":"[ ]";e.write(`${n} `),e.renderContent(t)},parse:{updateDOM(e){[...e.querySelectorAll(".task-list-item")].forEach(e=>{const t=e.querySelector("input");e.setAttribute("data-type","taskItem"),t&&(e.setAttribute("data-checked",t.checked),t.remove())})}}}})}),IM=mb.create({name:"taskList"}).extend({addStorage:()=>({markdown:{serialize:xM.storage.markdown.serialize,parse:{setup(e){e.use(lM)},updateDOM(e){[...e.querySelectorAll(".contains-task-list")].forEach(e=>{e.setAttribute("data-type","taskList")})}}}})}),LM=mb.create({name:"text"}).extend({addStorage:()=>({markdown:{serialize(e,t){var n;e.text(null==(n=t.text)?void 0:n.replace(/</g,"&lt;").replace(/>/g,"&gt;"))},parse:{}}})}),$M=$k.create({name:"bold"}).extend({addStorage:()=>({markdown:{serialize:tM.marks.strong,parse:{}}})}),RM=$k.create({name:"code"}).extend({addStorage:()=>({markdown:{serialize:tM.marks.code,parse:{}}})}),FM=$k.create({name:"italic"}).extend({addStorage:()=>({markdown:{serialize:tM.marks.em,parse:{}}})}),BM=$k.create({name:"link"}).extend({addStorage:()=>({markdown:{serialize:tM.marks.link,parse:{}}})}),VM=$k.create({name:"strike"}).extend({addStorage:()=>({markdown:{serialize:{open:"~~",close:"~~",expelEnclosingWhitespace:!0},parse:{}}})}),HM=[wM,xM,CM,_M,SM,EM,bM,MM,AM,DM,TM,NM,zM,IM,LM,$M,RM,yM,FM,BM,VM];function jM(e){var t,n;const r=null===(t=e.storage)||void 0===t?void 0:t.markdown,o=null===(n=HM.find(t=>t.name===e.name))||void 0===n?void 0:n.storage.markdown;return r||o?{...o,...r}:null}class qM{constructor(e){uM(this,"editor",null),this.editor=e}serialize(e){const t=new gM(this.nodes,this.marks,{hardBreakNodeName:_M.name});return t.renderContent(e),t.out}get nodes(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.nodes).map(e=>[e,this.serializeNode(bM)])),...Object.fromEntries(null!==(e=this.editor.extensionManager.extensions.filter(e=>"node"===e.type&&this.serializeNode(e)).map(e=>[e.name,this.serializeNode(e)]))&&void 0!==e?e:[])}}get marks(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.marks).map(e=>[e,this.serializeMark(yM)])),...Object.fromEntries(null!==(e=this.editor.extensionManager.extensions.filter(e=>"mark"===e.type&&this.serializeMark(e)).map(e=>[e.name,this.serializeMark(e)]))&&void 0!==e?e:[])}}serializeNode(e){var t;return null===(t=jM(e))||void 0===t||null===(t=t.serialize)||void 0===t?void 0:t.bind({editor:this.editor,options:e.options})}serializeMark(e){var t;const n=null===(t=jM(e))||void 0===t?void 0:t.serialize;return n?{...n,open:"function"==typeof n.open?n.open.bind({editor:this.editor,options:e.options}):n.open,close:"function"==typeof n.close?n.close.bind({editor:this.editor,options:e.options}):n.close}:null}}class KM{constructor(e,t){uM(this,"editor",null),uM(this,"md",null);let{html:n,linkify:r,breaks:o}=t;this.editor=e,this.md=this.withPatchedRenderer(WE({html:n,linkify:r,breaks:o}))}parse(e){let{inline:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){this.editor.extensionManager.extensions.forEach(e=>{var t;return null===(t=jM(e))||void 0===t||null===(t=t.parse)||void 0===t||null===(t=t.setup)||void 0===t?void 0:t.call({editor:this.editor,options:e.options},this.md)});const n=kM(this.md.render(e));return this.editor.extensionManager.extensions.forEach(e=>{var t;return null===(t=jM(e))||void 0===t||null===(t=t.parse)||void 0===t||null===(t=t.updateDOM)||void 0===t?void 0:t.call({editor:this.editor,options:e.options},n)}),this.normalizeDOM(n,{inline:t,content:e}),n.innerHTML}return e}normalizeDOM(e,t){let{inline:n,content:r}=t;return this.normalizeBlocks(e),e.querySelectorAll("*").forEach(e=>{var t;(null===(t=e.nextSibling)||void 0===t?void 0:t.nodeType)!==Node.TEXT_NODE||e.closest("pre")||(e.nextSibling.textContent=e.nextSibling.textContent.replace(/^\n/,""))}),n&&this.normalizeInline(e,r),e}normalizeBlocks(e){const t=Object.values(this.editor.schema.nodes).filter(e=>e.isBlock).map(e=>{var t;return null===(t=e.spec.parseDOM)||void 0===t?void 0:t.map(e=>e.tag)}).flat().filter(Boolean).join(",");t&&[...e.querySelectorAll(t)].forEach(e=>{e.parentElement.matches("p")&&function(e){const t=e.parentElement,n=t.cloneNode();for(;t.firstChild&&t.firstChild!==e;)n.appendChild(t.firstChild);n.childNodes.length>0&&t.parentElement.insertBefore(n,t),t.parentElement.insertBefore(e,t),0===t.childNodes.length&&t.remove()}(e)})}normalizeInline(e,t){var n;if(null!==(n=e.firstElementChild)&&void 0!==n&&n.matches("p")){var r,o,i,s;const n=e.firstElementChild,{nextElementSibling:a}=n,l=null!==(r=null===(o=t.match(/^\s+/))||void 0===o?void 0:o[0])&&void 0!==r?r:"",c=a?"":null!==(i=null===(s=t.match(/\s+$/))||void 0===s?void 0:s[0])&&void 0!==i?i:"";if(t.match(/^\n\n/))return void(n.innerHTML=`${n.innerHTML}${c}`);!function(e){const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}(n),e.innerHTML=`${l}${e.innerHTML}${c}`}}withPatchedRenderer(e){const t=e=>function(){const t=e(...arguments);return"\n"===t?t:"\n"===t[t.length-1]?t.slice(0,-1):t};return e.renderer.rules.hardbreak=t(e.renderer.rules.hardbreak),e.renderer.rules.softbreak=t(e.renderer.rules.softbreak),e.renderer.rules.fence=t(e.renderer.rules.fence),e.renderer.rules.code_block=t(e.renderer.rules.code_block),e.renderer.renderToken=t(e.renderer.renderToken.bind(e.renderer)),e}}const WM=qk.create({name:"markdownClipboard",addOptions:()=>({transformPastedText:!1,transformCopiedText:!1}),addProseMirrorPlugins(){return[new Cp({key:new Ep("markdownClipboard"),props:{clipboardTextParser:(e,t,n)=>{if(n||!this.options.transformPastedText)return null;const r=this.editor.storage.markdown.parser.parse(e,{inline:!0});return Xd.fromSchema(this.editor.schema).parseSlice(kM(r),{preserveWhitespace:!0,context:t})},clipboardTextSerializer:e=>this.options.transformCopiedText?this.editor.storage.markdown.serializer.serialize(e.content):null}})]}}),ZM=qk.create({name:"markdown",priority:50,addOptions:()=>({html:!0,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!1,breaks:!1,transformPastedText:!1,transformCopiedText:!1}),addCommands(){const e=jk.Commands.config.addCommands();return{setContent:(t,n)=>r=>e.setContent(r.editor.storage.markdown.parser.parse(t),n)(r),insertContentAt:(t,n,r)=>o=>e.insertContentAt(t,o.editor.storage.markdown.parser.parse(n,{inline:!0}),r)(o)}},onBeforeCreate(){this.editor.storage.markdown={options:{...this.options},parser:new KM(this.editor,this.options),serializer:new qM(this.editor),getMarkdown:()=>this.editor.storage.markdown.serializer.serialize(this.editor.state.doc)},this.editor.options.initialContent=this.editor.options.content,this.editor.options.content=this.editor.storage.markdown.parser.parse(this.editor.options.content)},onCreate(){this.editor.options.content=this.editor.options.initialContent,delete this.editor.options.initialContent},addStorage:()=>({}),addExtensions(){return[dM.configure({tight:this.options.tightLists,tightClass:this.options.tightListClass}),WM.configure({transformPastedText:this.options.transformPastedText,transformCopiedText:this.options.transformCopiedText})]}});var UM=cn('<div class="tiptap-container svelte-1d9sbdt"></div>');function JM(e,t){X(t,!0);let n,r=yr(t,"content",15,""),o=yr(t,"placeholder",3,"Start typing..."),i=yr(t,"onUpdate",3,e=>{}),s=yr(t,"autofocus",3,!0),a=yr(t,"class",3,""),l=null;xn(()=>{l=new nb({element:n,extensions:[GC.configure({heading:{levels:[1,2,3]},codeBlock:{HTMLAttributes:{class:"code-block"}}}),XC.configure({placeholder:o()}),ZM.configure({html:!0,transformPastedText:!0,transformCopiedText:!0})],content:r(),autofocus:!!s()&&"end",editorProps:{attributes:{class:`tiptap-editor nodrag nopan ${a()}`}},onUpdate:({editor:e})=>{const t=e.storage.markdown.getMarkdown();r(t),i()(t)}})}),Cn(()=>{l?.destroy()}),Qe(()=>{l&&r()!==l.storage.markdown.getMarkdown()&&l.commands.setContent(r())});var c=UM();or(c,e=>n=e,()=>n),pn(e,c),Y()}var GM=cn('<div class="editor-wrapper svelte-3o70fg"><!></div>'),XM=cn('<div class="content svelte-3o70fg"><!></div>'),YM=cn('<div role="button" tabindex="0"><!> <!> <!></div>');function QM(e,t){X(t,!0);let n=Oe(!1),r=Oe($e(t.data.text||""));function o(e){var n,o;Pe(r,e,!0),n=t.id,o={text:e,label:e},Xu.update(e=>e.map(e=>e.id===n?{...e,data:{...e.data,...o}}:e))}var i=YM();let s;nn("click",Be,function(e){e.target.closest(".text-node")||Pe(n,!1)}),i.__dblclick=function(){Pe(n,!0),Pe(r,t.data.text||"",!0)},i.__keydown=function(e){"Escape"===e.key&&Pe(n,!1)};var a=Ke(i);cc(a,{type:"target",get position(){return Ea.Top}});var l=Ze(a,2),c=e=>{var t=GM();JM(Ke(t),{onUpdate:o,placeholder:"Type / for commands, **bold**, *italic*, # heading...",autofocus:!0,get content(){return Kt(r)},set content(e){Pe(r,e,!0)}}),pn(e,t)},u=e=>{var n=XM();Tn(Ke(n),()=>{return((e=t.data.text)?e.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/__(.*?)__/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\n/g,"<br/>"):"")||'<span class="placeholder">Double-click to edit</span>';var e}),pn(e,n)};_n(l,e=>{Kt(n)?e(c):e(u,!1)}),cc(Ze(l,2),{type:"source",get position(){return Ea.Bottom}}),it(()=>{s=Fn(i,1,"text-node svelte-3o70fg",null,s,{selected:t.selected,editing:Kt(n)}),Vn(i,`width: ${(t.data.width||250)??""}px; min-height: ${(t.data.height||60)??""}px;`)}),pn(e,i),Y()}rn(["dblclick","keydown"]);var eA=cn('<div class="file-content loading-state svelte-27jwhv"><span class="loading-spinner svelte-27jwhv">â³</span> Loading...</div>'),tA=cn('<div class="file-content error-state svelte-27jwhv"><span class="error-icon">â ï¸</span> </div>'),nA=cn('<div class="editor-wrapper svelte-27jwhv"><!></div>'),rA=cn('<span class="placeholder svelte-27jwhv">Double-click to edit</span>'),oA=cn('<div class="file-content svelte-27jwhv"><!></div>'),iA=cn('<div role="button" tabindex="0"><!> <div class="file-header svelte-27jwhv"><span class="file-icon svelte-27jwhv">ð</span> <span class="file-name svelte-27jwhv"> </span></div> <!> <!></div>');function sA(e,t){X(t,!0);let n=Oe(!1),r=Oe(!1),o=Oe(""),i=Oe("");async function s(e){if(Pe(i,e,!0),t.data.file)try{await async function(e,t,n){return new Promise((r,o)=>{const i=t=>{const n=t.data;"fileContentSaved"===n.type&&n.nodeId===e?(window.removeEventListener("message",i),r()):"fileContentError"===n.type&&n.nodeId===e&&(window.removeEventListener("message",i),o(new Error(n.error)))};window.addEventListener("message",i),Gu.postMessage({type:"saveFile",filePath:t,content:n,nodeId:e}),setTimeout(()=>{window.removeEventListener("message",i),o(new Error("File save timeout"))},1e4)})}(t.id,t.data.file,e)}catch(n){console.error("File save error:",n),Pe(o,"Failed to save file")}}$e(t.data.file||""),Qe(()=>{t.data.file&&!Kt(n)&&async function(){if(!t.data.file)return;Pe(r,!0),Pe(o,"");try{const e=await async function(e,t){return new Promise((n,r)=>{const o=t=>{const i=t.data;"fileContentLoaded"===i.type&&i.nodeId===e?(window.removeEventListener("message",o),n(i.content)):"fileContentError"===i.type&&i.nodeId===e&&(window.removeEventListener("message",o),r(new Error(i.error)))};window.addEventListener("message",o),Gu.postMessage({type:"loadFile",filePath:t,nodeId:e}),setTimeout(()=>{window.removeEventListener("message",o),r(new Error("File load timeout"))},1e4)})}(t.id,t.data.file);e&&Pe(i,e,!0)}catch(e){Pe(o,`Failed to load: ${t.data.file}`),console.error("File load error:",e)}finally{Pe(r,!1)}}()});var a=iA();let l;nn("click",Be,function(e){e.target.closest(".file-node")||Pe(n,!1)}),a.__dblclick=function(){t.data.file&&Pe(n,!0)},a.__keydown=function(e){"Escape"===e.key&&Pe(n,!1)};var c=Ke(a);cc(c,{type:"target",get position(){return Ea.Top}});var u=Ze(c,2),d=Ze(Ke(u),2),h=Ke(d),p=Ze(u,2),f=e=>{pn(e,eA())},m=e=>{var t=hn(),r=We(t),a=e=>{var t=tA(),n=Ze(Ke(t));it(()=>kn(n,` ${Kt(o)??""}`)),pn(e,t)},l=e=>{var t=hn(),r=We(t),o=e=>{var t=nA();JM(Ke(t),{onUpdate:s,placeholder:"Edit file content...",autofocus:!0,get content(){return Kt(i)},set content(e){Pe(i,e,!0)}}),pn(e,t)},a=e=>{var t=oA(),n=Ke(t),r=e=>{var t=hn();Tn(We(t),()=>{return(e=Kt(i))?e.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/__(.*?)__/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\n/g,"<br/>"):"";var e}),pn(e,t)},o=e=>{pn(e,rA())};_n(n,e=>{Kt(i)?e(r):e(o,!1)}),pn(e,t)};_n(r,e=>{Kt(n)?e(o):e(a,!1)},!0),pn(e,t)};_n(r,e=>{Kt(o)?e(a):e(l,!1)},!0),pn(e,t)};_n(p,e=>{Kt(r)?e(f):e(m,!1)}),cc(Ze(p,2),{type:"source",get position(){return Ea.Bottom}}),it(()=>{l=Fn(a,1,"file-node svelte-27jwhv",null,l,{selected:t.selected,editing:Kt(n),loading:Kt(r)}),Vn(a,`width: ${(t.data.width||300)??""}px; min-height: ${(t.data.height||80)??""}px;`),Jn(d,"title",t.data.file),kn(h,t.data.file||"No file")}),pn(e,a),Y()}rn(["dblclick","keydown"]);var aA=cn('<div class="info-panel svelte-1lnvel0"><h3 class="svelte-1lnvel0">Infinite Canvas + Tiptap</h3> <p class="svelte-1lnvel0"><strong>Create:</strong> Double-click canvas</p> <p class="svelte-1lnvel0"><strong>Edit:</strong> Double-click node</p> <p class="svelte-1lnvel0"><strong>Markdown:</strong> **bold**, *italic*, # heading</p> <p class="svelte-1lnvel0"><strong>Connect:</strong> Drag from circle</p> <p class="svelte-1lnvel0"><strong>Delete:</strong> Select + Delete key</p></div>'),lA=cn("<!> <!> <!> <!>",1),cA=cn('<div class="canvas-container svelte-1lnvel0"><!></div>');new function(e,t){X(t,!1);const[n,r]=function(){const e={};return[e,function(){Ye(()=>{for(var t in e)e[t].unsubscribe();s(e,dr,{enumerable:!1,value:!0})})}]}(),o={text:QM,file:sA};ir();var i=cA();nn("keydown",Be,function(e){if(("Delete"===e.key||"Backspace"===e.key)&&"TEXTAREA"!==document.activeElement?.tagName){const e=hr(Xu,"$nodes",n).filter(e=>e.selected).map(e=>e.id);e.length>0&&(t=e,Xu.update(e=>e.filter(e=>!t.includes(e.id))),Yu.update(e=>e.filter(e=>!t.includes(e.source)&&!t.includes(e.target))),console.log("ðï¸ Deleted nodes:",t))}var t}),Su(Ke(i),{get nodes(){return Xu},get edges(){return Yu},get nodeTypes(){return o},get connectionLineType(){return xa.SmoothStep},fitView:!0,onpaneclick:function(e){const{event:t}=e.detail;if(2===t.detail){const e=t.target.closest(".svelte-flow");if(e){const n=e.getBoundingClientRect();!function(e,t){const n={id:`node-${Date.now()}`,type:"text",position:{x:e,y:t},data:{label:"New note",text:"New note",width:250,height:60}};Xu.update(e=>[...e,n]),console.log("â Created node:",n.id)}(t.clientX-n.left-125,t.clientY-n.top-30)}}},onconnect:function(e){const t=e.detail;Yu.update(e=>[...e,{id:`edge-${Date.now()}`,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle}])},children:(e,t)=>{var n=lA(),r=We(n);Hu(r,{variant:"dots",gap:16});var o=Ze(r,2);$u(o,{showInteractive:!1});var i=Ze(o,2);Ju(i,{}),ku(Ze(i,2),{position:"top-left",children:(e,t)=>{pn(e,aA())},$$slots:{default:!0}}),pn(e,n)},$$slots:{default:!0}}),pn(e,i),Y(),r()}({target:document.getElementById("app")});
//# sourceMappingURL=bundle.js.map
